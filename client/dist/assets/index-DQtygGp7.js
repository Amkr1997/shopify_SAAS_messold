import{r as t,j as e,R as Ze}from"./react-CkuKL7a9.js";import{c as Zr}from"./react-dom-CtYNSMMY.js";import{N as qr,L as hs,B as Jr}from"./react-router-dom-Denq2AzZ.js";import{a as ve}from"./axios-CCb-kr4I.js";import{c as Xr}from"./clsx-B-dksMZM.js";import{t as en}from"./tailwind-merge-Dnoi3Axr.js";import{S as sn,R as wa,V as Ca,a as Sa,A as Aa,C as ka,b as Pt,T as Ma,D as Ta,P as tn,c as an,d as Ia,e as rn,f as nn,g as on,h as Fa,i as ln,j as cn,k as $a,l as dn,m as mn,n as Pa,o as un,p as La,q as hn,r as xn,s as Ea,I as fn,t as Lt,O as ht,u as xt,v as Ra,w as ft,x as gt,y as Oa,z as Da,B as za,E as Ga,F as _a,G as Ba,H as Va,J as Ua,K as gn,L as Ha,M as Ya,N as pn,Q as Wa,U as jn,W as Ka,X as vn,Y as Qa,Z as Za,_ as bn,$ as yn,a0 as qa,a1 as Nn,a2 as wn,a3 as Ja,a4 as Xa,a5 as Cn,a6 as er,a7 as sr,a8 as tr,a9 as ar,aa as rr,ab as Sn,ac as nr,ad as or,ae as An,af as kn}from"./@radix-ui-DGYJKrVg.js";import{c as Hs}from"./class-variance-authority-Bb4qSo10.js";import{F as Mn,a as Tn,b as Et}from"./react-icons-CxdGe4K0.js";import{u as z,a as Se,s as Ae,P as In}from"./react-redux-BFum93nM.js";import{c as $s,a as Fn}from"./@reduxjs-CoJy1jWf.js";import{c as fs,b as pt,e as ge,f as $n,g as He}from"./react-router-DI8MYCuW.js";import{U as lr,M as Ys,L as Pn,E as Ln,a as En,C as Rn,T as ir,b as Ps,c as xs,S as On,d as Tt,e as is,B as Rt,f as Ot,g as Dt,h as Rs,F as Dn,R as zt,i as zn,j as Gn,k as cr,l as _n,m as fe,n as dr,o as Bn,p as Ws,G as mr,P as Vn,q as Un,r as ta,X as rs,s as ot,t as pe,u as je,v as Hn,w as ur,I as Yn,x as hr,y as ks,z as aa,A as Gt,D as Wn,H as Kn,J as Qn,K as Zn,N as Ss,O as xr,Q as jt,V as qn,W as Jn,Y as _t,Z as Xn,_ as ra,$ as na,a0 as Ms,a1 as Ts,a2 as eo,a3 as so,a4 as fr,a5 as gr,a6 as Bt,a7 as to,a8 as vt,a9 as ao,aa as ro,ab as no,ac as pr,ad as tt,ae as oa,af as oo,ag as lo,ah as io,ai as co,aj as Vt,ak as Ut,al as Ks,am as mo,an as at,ao as uo,ap as ho,aq as xo,ar as fo,as as go,at as po,au as jo}from"./lucide-react-Dp_fMfTB.js";import{c as vo}from"./reselect-NCCDNIWx.js";import{D as bo}from"./react-day-picker-B5gfsXbf.js";import{C as H,s as vs,a as yo,F as No,G as la,H as ia,t as wo,I as Co,e as ca}from"./date-fns-vhOq_R3I.js";import{R as lt,B as It,X as it,Y as ct,T as Ft,a as dt,C as da,L as ma,A as So,b as Ao}from"./recharts-BAWZ_O5f.js";import{x as As}from"./xlsx-js-style-D9kuvFD2.js";import{p as ko,a as Mo,d as To,P as Io}from"./redux-persist-CMICPraH.js";import{c as Fo}from"./redux-DITMfSWq.js";import{A as $o}from"./driver.js-D-7DVtGF.js";import"./eventemitter3-CJ9KO17d.js";import"./scheduler-CzFDRTuY.js";import"./@remix-run-BSEpXHBb.js";import"./aria-hidden-DQ5UC2Eg.js";import"./react-remove-scroll-C5ifrSBn.js";import"./tslib-CDuPK5Eb.js";import"./react-remove-scroll-bar-CPmXGeA2.js";import"./react-style-singleton-DfON9R_v.js";import"./get-nonce-C-Z93AgS.js";import"./use-sidecar-DyqfL0R5.js";import"./use-callback-ref-wNvar0eO.js";import"./@floating-ui-C6Fk-jMm.js";import"./use-sync-external-store-xms5UOqV.js";import"./immer-DqxjFn0G.js";import"./redux-thunk-ClJT1hhx.js";import"./lodash-D-MFwOE9.js";import"./react-is-DcfIKM1A.js";import"./react-smooth-z42qxpQa.js";import"./prop-types-DNLruqPx.js";import"./fast-equals-C7I1S-bJ.js";import"./tiny-invariant-BaFNuDhB.js";import"./d3-shape-DjFPhhqo.js";import"./d3-path-CimkQT29.js";import"./victory-vendor-6_AdwBXU.js";import"./d3-scale-BYIooUZQ.js";import"./internmap-BkD7Hj8s.js";import"./d3-array-g_qRI3rN.js";import"./d3-time-format-BKO53YJi.js";import"./d3-time-QpEiTrED.js";import"./d3-interpolate-CvRPKVI0.js";import"./d3-color-9lF95FHy.js";import"./d3-format-CzD4bSOQ.js";import"./recharts-scale-DiOBu8nk.js";import"./decimal.js-light-B5-9uEc-.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))n(l);new MutationObserver(l=>{for(const o of l)if(o.type==="childList")for(const m of o.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&n(m)}).observe(document,{childList:!0,subtree:!0});function a(l){const o={};return l.integrity&&(o.integrity=l.integrity),l.referrerPolicy&&(o.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?o.credentials="include":l.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(l){if(l.ep)return;l.ep=!0;const o=a(l);fetch(l.href,o)}})();const jr=t.createContext(void 0),Po=({children:s})=>{const[r,a]=t.useState(()=>{const m=localStorage.getItem("user");return m?JSON.parse(m):null}),[n,l]=t.useState(()=>r?!r.hasSeenLandingSlides&&(!r.brands||r.brands.length===0):!1);t.useEffect(()=>{r?localStorage.setItem("user",JSON.stringify(r)):localStorage.removeItem("user")},[r]),t.useEffect(()=>{r&&!r.hasSeenLandingSlides&&(!r.brands||r.brands.length===0)&&l(!0)},[r]);const o=m=>{m&&!m.hasSeenLandingSlides&&(!m.brands||m.brands.length===0)&&l(!0),a(m)};return e.jsx(jr.Provider,{value:{user:r,setUser:o,showLandingPopup:n,setShowLandingPopup:l},children:s})},Os=()=>{const s=t.useContext(jr);if(s===void 0)throw new Error("useUser must be used within a UserProvider");return s};function ae(...s){return en(Xr(s))}const De=t.forwardRef(({className:s,type:r,...a},n)=>e.jsx("input",{type:r,className:ae("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",s),ref:n,...a}));De.displayName="Input";const $t=Hs("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),D=t.forwardRef(({className:s,variant:r,size:a,asChild:n=!1,...l},o)=>{const m=n?sn:"button";return e.jsx(m,{className:ae($t({variant:r,size:a,className:s})),ref:o,...l})});D.displayName="Button";const Lo=Hs("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),us=t.forwardRef(({className:s,...r},a)=>e.jsx(wa,{ref:a,className:ae(Lo(),s),...r}));us.displayName=wa.displayName;const Eo=1,Ro=1e6;let St=0;function Oo(){return St=(St+1)%Number.MAX_SAFE_INTEGER,St.toString()}const At=new Map,ua=s=>{if(At.has(s))return;const r=setTimeout(()=>{At.delete(s),Gs({type:"REMOVE_TOAST",toastId:s})},Ro);At.set(s,r)},Do=(s,r)=>{switch(r.type){case"ADD_TOAST":return{...s,toasts:[r.toast,...s.toasts].slice(0,Eo)};case"UPDATE_TOAST":return{...s,toasts:s.toasts.map(a=>a.id===r.toast.id?{...a,...r.toast}:a)};case"DISMISS_TOAST":{const{toastId:a}=r;return a?ua(a):s.toasts.forEach(n=>{ua(n.id)}),{...s,toasts:s.toasts.map(n=>n.id===a||a===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return r.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(a=>a.id!==r.toastId)}}},rt=[];let nt={toasts:[]};function Gs(s){nt=Do(nt,s),rt.forEach(r=>{r(nt)})}function zo({...s}){const r=Oo(),a=l=>Gs({type:"UPDATE_TOAST",toast:{...l,id:r}}),n=()=>Gs({type:"DISMISS_TOAST",toastId:r});return Gs({type:"ADD_TOAST",toast:{...s,id:r,open:!0,onOpenChange:l=>{l||n()}}}),{id:r,dismiss:n,update:a}}function bt(){const[s,r]=t.useState(nt);return t.useEffect(()=>(rt.push(r),()=>{const a=rt.indexOf(r);a>-1&&rt.splice(a,1)}),[s]),{...s,toast:zo,dismiss:a=>Gs({type:"DISMISS_TOAST",toastId:a})}}const Go={user:null},vr=$s({name:"user",initialState:Go,reducers:{setUser:(s,r)=>{s.user=r.payload},clearUser:s=>{s.user=null}}}),{setUser:mt,clearUser:_o}=vr.actions,Bo=vr.reducer;function Vo(){const[s,r]=t.useState(!0),[a,n]=t.useState(""),[l,o]=t.useState(""),[m,h]=t.useState(""),[d,c]=t.useState(!1),{toast:p}=bt(),C=fs(),[x,S]=t.useState({username:"",email:"",password:""}),A=z(g=>g.user.user),y=Se();t.useEffect(()=>{A&&C("/dashboard")},[A,C]);const b=()=>r(!s),$=()=>{const g={username:"",email:"",password:""};let F=!0;return!s&&!a.trim()&&(g.username="Username is required",F=!1),l.trim()?/\S+@\S+\.\S+/.test(l)||(g.email="Email is invalid",F=!1):(g.email="Email is required",F=!1),m?m.length<8&&(g.password="Password must be at least 8 characters",F=!1):(g.password="Password is required",F=!1),S(g),F},v=async g=>{if(g.preventDefault(),!!$())try{let F;const M="https://parallels.messold.com";if(s){if(F=await ve.post(`${M}/api/auth/login/normal`,{email:l,password:m},{withCredentials:!0}),F.data.success){const N={...F.data.user,hasSeenLandingSlides:F.data.user.brands&&F.data.user.brands.length>0};y(mt(N)),p({title:"Login successful!",description:"Welcome! Redirecting to your dashboard.",variant:"default"}),C("/dashboard")}}else F=await ve.post(`${M}/api/auth/signup`,{username:a,email:l,password:m},{withCredentials:!0}),F.data.success&&(p({title:"Registration successful!",description:"Please log in with your new account.",variant:"default"}),r(!0))}catch(F){ve.isAxiosError(F)&&F.response?p({title:"Error",description:F.response.data.message||"An error occurred",variant:"destructive"}):p({title:"Unexpected Error",description:"An unexpected error occurred",variant:"destructive"})}},w=async()=>{try{const F=await ve.get("https://parallels.messold.com/api/auth/google?context=userLogin"),{authUrl:M}=F.data;window.location.href=M}catch(g){console.error("Error getting Google Auth URL:",g)}};return e.jsxs("div",{className:"flex h-screen",children:[e.jsx("div",{className:"hidden md:flex md:w-1/2 bg-cover bg-center",style:{backgroundImage:"url('https://images.unsplash.com/photo-1460925895917-afdab827c52f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2015&q=80')"},children:e.jsx("div",{className:"flex items-center justify-center w-full h-full bg-black bg-opacity-40",children:e.jsxs("div",{className:"text-white text-center p-8",children:[e.jsx("h3",{className:"text-4xl font-bold mb-6",children:"Unified Marketing Analytics"}),e.jsx("p",{className:"text-xl",children:"View your Shopify, Facebook, and Google Ads data all in one place."})]})})}),e.jsx("div",{className:"w-full md:w-1/2 flex items-center justify-center bg-gradient-to-br from-blue-50 to-white p-8",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsx("h2",{className:"text-3xl font-bold mb-3",children:s?"Welcome Back":"Create an Account"}),e.jsx("p",{className:"mb-8",children:s?"Sign in to access your marketing dashboard":"Join us to view all your marketing data in one place"}),e.jsxs("form",{onSubmit:v,className:"space-y-6",children:[!s&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(us,{htmlFor:"username",children:"Username"}),e.jsxs("div",{className:"relative",children:[e.jsx(lr,{className:"absolute left-3 top-3 h-5 w-5"}),e.jsx(De,{id:"username",type:"text",value:a,onChange:g=>n(g.target.value),placeholder:"Enter your username",required:!s,className:"pl-10 border-blue-300 focus:border-blue-500 focus:ring-blue-500"})]}),x.username&&e.jsx("p",{className:"text-red-500 text-sm",children:x.username})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(us,{htmlFor:"email",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ys,{className:"absolute left-3 top-3 h-5 w-5"}),e.jsx(De,{id:"email",type:"email",value:l,onChange:g=>o(g.target.value),placeholder:"Enter your email",required:!0,className:"pl-10 border-blue-300 focus:border-blue-500 focus:ring-blue-500"})]}),x.email&&e.jsx("p",{className:"text-red-500 text-sm",children:x.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(us,{htmlFor:"password",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Pn,{className:"absolute left-3 top-3 h-5 w-5"}),e.jsx(De,{id:"password",type:d?"text":"password",value:m,onChange:g=>h(g.target.value),placeholder:"Enter your password",required:!0,className:"pl-10 border-blue-300 focus:border-blue-500 focus:ring-blue-500"}),e.jsx("button",{type:"button",onClick:()=>c(!d),className:"absolute right-3 top-3 ",children:d?e.jsx(Ln,{className:"h-5 w-5"}):e.jsx(En,{className:"h-5 w-5"})})]}),x.password&&e.jsx("p",{className:"text-red-500 text-sm",children:x.password})]}),e.jsx(D,{type:"submit",className:"w-full text-white",children:s?"Sign In":"Sign Up"})]}),e.jsx("div",{className:"mt-6",children:e.jsxs(D,{variant:"outline",className:"w-full flex items-center justify-center space-x-2",onClick:w,children:[e.jsx(Mn,{className:"h-5 w-5"}),e.jsx("span",{children:"Continue with Google"})]})}),e.jsxs("p",{className:"mt-6 text-center text-sm",children:[s?"Don't have an account? ":"Already have an account? ",e.jsx("button",{onClick:b,className:"font-semibold hover:underline",children:s?"Sign Up":"Sign In"})]})]})})]})}const Uo=tn,br=t.forwardRef(({className:s,...r},a)=>e.jsx(Ca,{ref:a,className:ae("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",s),...r}));br.displayName=Ca.displayName;const Ho=Hs("group pointer-events-auto relative flex w-full items-center justify-between space-x-2 overflow-hidden rounded-md border p-4 pr-6 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),yr=t.forwardRef(({className:s,variant:r,...a},n)=>e.jsx(Sa,{ref:n,className:ae(Ho({variant:r}),s),...a}));yr.displayName=Sa.displayName;const Yo=t.forwardRef(({className:s,...r},a)=>e.jsx(Aa,{ref:a,className:ae("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium transition-colors hover:bg-secondary focus:outline-none focus:ring-1 focus:ring-ring disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s),...r}));Yo.displayName=Aa.displayName;const Nr=t.forwardRef(({className:s,...r},a)=>e.jsx(ka,{ref:a,className:ae("absolute right-1 top-1 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-1 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...r,children:e.jsx(Pt,{className:"h-4 w-4"})}));Nr.displayName=ka.displayName;const wr=t.forwardRef(({className:s,...r},a)=>e.jsx(Ma,{ref:a,className:ae("text-sm font-semibold [&+div]:text-xs",s),...r}));wr.displayName=Ma.displayName;const Cr=t.forwardRef(({className:s,...r},a)=>e.jsx(Ta,{ref:a,className:ae("text-sm opacity-90",s),...r}));Cr.displayName=Ta.displayName;function Wo(){const{toasts:s}=bt();return e.jsxs(Uo,{children:[s.map(function({id:r,title:a,description:n,action:l,...o}){return e.jsxs(yr,{...o,children:[e.jsxs("div",{className:"grid gap-1",children:[a&&e.jsx(wr,{children:a}),n&&e.jsx(Cr,{children:n})]}),l,e.jsx(Nr,{})]},r)}),e.jsx(br,{})]})}const Ko={selectedBrandId:null,brands:[]},Sr=$s({name:"brand",initialState:Ko,reducers:{setSelectedBrandId:(s,r)=>{s.selectedBrandId=r.payload},setBrands:(s,r)=>{s.brands=r.payload},resetBrand:s=>{s.selectedBrandId=null,s.brands=[]}}}),{setSelectedBrandId:Js,setBrands:Qo,resetBrand:Zo}=Sr.actions,qo=Sr.reducer,Ds=rn,os=nn,ls=on,as=t.forwardRef(({className:s,sideOffset:r=4,...a},n)=>e.jsx(an,{children:e.jsx(Ia,{ref:n,sideOffset:r,className:ae("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...a})}));as.displayName=Ia.displayName;const Ht="/assets/messold-icon-jcccRy_s.png",Ar=t.forwardRef(({className:s,children:r,...a},n)=>e.jsxs(Fa,{ref:n,className:ae("relative overflow-hidden",s),...a,children:[e.jsx(ln,{className:"h-full w-full rounded-[inherit]",children:r}),e.jsx(kr,{}),e.jsx(cn,{})]}));Ar.displayName=Fa.displayName;const kr=t.forwardRef(({className:s,orientation:r="vertical",...a},n)=>e.jsx($a,{ref:n,orientation:r,className:ae("flex touch-none select-none transition-colors",r==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",r==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...a,children:e.jsx(dn,{className:"relative flex-1 rounded-full bg-border"})}));kr.displayName=$a.displayName;function ts(){var $;const[s,r]=t.useState(!0),a=pt(),n=fs(),l=t.useRef(null),o="https://parallels.messold.com",m=Se(),h=z(v=>v.brand.selectedBrandId),d=z(v=>v.brand.brands),c=z(v=>v.user.user),p=t.useCallback(async()=>{try{if(!(c!=null&&c.brands)||c.brands.length===0){console.warn("No brand IDs found in user context.");return}const v=await ve.post(`${o}/api/brands/filter`,{brandIds:c.brands},{withCredentials:!0});m(Qo(v.data)),!h&&v.data.length>0&&m(Js(v.data[0]._id))}catch(v){console.error("Error fetching brands:",v)}},[c==null?void 0:c.brands]);t.useEffect(()=>{p()},[p]);const C=()=>r(v=>!v),x=async()=>{try{(await ve.post(`${o}/api/auth/logout`,{},{withCredentials:!0})).status===200&&(m(_o()),m(Zo()),n("/"))}catch(v){console.error("Error logging out:",v)}};t.useEffect(()=>{const v=a.pathname.split("/");v[2]&&Js(v[2])},[a.pathname,Js]);const S=[{name:"Business Overview",path:"/dashboard",icon:e.jsx(Rt,{size:20})},{name:"Marketing Insights Tracker",path:`/ad-metrics/${h}`,icon:e.jsx(Ot,{size:20})},{name:"E-Commerce Insights",path:`/ecommerce-reports/${h}`,icon:e.jsx(Dt,{size:20})},{name:"AdMetrics Hub",path:`/analytics-dashboard/${h}`,icon:e.jsx(Rs,{size:20})},{name:"Ad Reports",path:"#",icon:e.jsx(Dn,{size:20}),subItems:[{name:"Meta Reports",path:`/meta-reports/${h}`},{name:"Google Reports",path:`/google-reports/${h}`}]},{name:"Conversion Radar",path:"/#",icon:e.jsx(zt,{size:20}),subItems:[{name:"Audience & Traffic Sources",path:`/conversion-reports/${h}/demographics`},{name:"Camapign and Website Performance",path:`/conversion-reports/${h}/performance`}]}],A=c!=null&&c.isAdmin?[...S,{name:"Segment Scope",path:`/segment-dashboard/${h}`,icon:e.jsx(Rn,{size:20})},{name:"Brands Targets",path:"/performance-metrics",icon:e.jsx(ir,{size:20})}]:S,y=v=>{if(!h)return!0;const w=d.find(g=>g._id===h);return(v.name==="Analytics Dashboard"||v.name==="Campaign Metrics")&&!(w!=null&&w.fbAdAccounts)&&!(w!=null&&w.googleAdAccount)},b=(v,w=!0)=>v.map((g,F)=>{const M=g.path&&g.path!=="/#";return w?e.jsx(xa,{icon:g.icon,text:g.name,isExpanded:s,isSelected:M&&a.pathname.startsWith(g.path),tooltipContent:`${g.name}${y(g)?" (No Analytics data available)":""}`,onClick:()=>{!y(g)&&M&&n(g.path)},disabled:y(g),openIcon:g.subItems?e.jsx(Tt,{}):void 0,closeIcon:g.subItems?e.jsx(is,{}):void 0,autoOpenOnSelect:!0,children:g.subItems&&b(g.subItems,!1)},F):e.jsx(ha,{path:g.path,text:g.name,onClick:()=>{M&&n(g.path)},isSelected:M&&a.pathname===g.path,children:g.subItems&&b(g.subItems,!1)},F)});return e.jsx(Ds,{children:e.jsxs("div",{ref:l,className:`bg-[rgb(4,16,33)] text-white transition-all duration-500 ease-in-out flex flex-col ${s?"w-64":"w-16"}`,style:{height:"100vh"},children:[e.jsxs("div",{className:"flex justify-between items-center p-4 relative",children:[e.jsxs("div",{className:"flex items-center cursor-pointer",onClick:()=>n("/dashboard"),children:[e.jsx("img",{src:Ht,alt:"Messold Logo",className:"h-8 w-8"}),s?e.jsx("span",{className:"text-sm ml-2",children:"Messold"}):null]}),e.jsx("span",{className:"transition-all duration-300 ease-in-out bg-[rgb(4,16,33)] rounded-full flex items-center justify-center",style:{width:"25px",height:"25px",position:"absolute",right:"-10px",top:"50%",transform:"translateY(-50%)",zIndex:50},onClick:C,children:s?e.jsx(Ps,{size:15}):e.jsx(xs,{size:15})})]}),e.jsx("div",{className:`flex-1 overflow-y-auto ${s?"h-[calc(100vh-64px)]":"h-[calc(100vh-16px)]"}`,children:e.jsx(Ar,{className:"h-full",children:e.jsxs("nav",{className:"mt-3",children:[e.jsx(xa,{icon:e.jsx(On,{size:24}),text:h?(($=d.find(v=>v._id===h))==null?void 0:$.name.replace(/_/g," "))||"Unknown Brand":"Your Brands",isExpanded:s,openIcon:e.jsx(Tt,{}),closeIcon:e.jsx(is,{}),isSelected:!!h,tooltipContent:"Your Brands",autoOpenOnSelect:!1,children:d.map(v=>e.jsx(ha,{path:"/dashboard",text:v.name.replace(/_/g," "),onClick:()=>{m(Js(v._id)),n("/dashboard")},isSelected:h===v._id},v._id))}),b(A)]})})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx(Jo,{isExpanded:s,user:c}),e.jsx(Xo,{handleLogout:x,isExpanded:s})]})]})})}function ha({path:s,text:r,onClick:a,disabled:n=!1,isSelected:l=!1,children:o}){const[m,h]=t.useState(!1),d=Ze.Children.count(o)>0,c=()=>{d&&h(y=>!y)},p=Ze.Children.toArray(o).some(y=>{var b;return(b=y==null?void 0:y.props)==null?void 0:b.isSelected}),C=l||p;t.useEffect(()=>{C&&h(!0)},[C]);const x=`flex items-center text-xs w-full p-2.5 transition-colors duration-200 
      ${C?"text-white font-semibold relative bg-gray-800":"text-gray-100"} 
      ${n?"cursor-not-allowed text-gray-400":"hover:bg-gray-700"}`,S=e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("span",{children:r}),d&&e.jsx("span",{className:"ml-2",children:m?e.jsx(Tt,{}):e.jsx(is,{})})]}),C&&e.jsx("div",{className:"absolute left-0 top-0 w-1 h-full bg-white"})]}),A=n?e.jsx("div",{className:x,children:S}):e.jsx(qr,{to:s,className:x,onClick:y=>{(s==="/#"||!s)&&y.preventDefault(),d&&c(),a&&a()},children:S});return e.jsxs("div",{children:[A,m&&d&&e.jsxs("div",{className:"relative pl-4",children:[e.jsx("div",{className:"absolute top-0 left-4 w-1 h-full bg-gray-500"}),o]})]})}function xa({icon:s,text:r,isExpanded:a,openIcon:n,closeIcon:l,children:o,isSelected:m,tooltipContent:h,onClick:d,disabled:c,autoOpenOnSelect:p=!0}){const[C,x]=t.useState(!1),S=Ze.Children.count(o)>0,A=()=>{S&&x(v=>!v)},y=Ze.Children.toArray(o).some(v=>{var w,g;return(w=v==null?void 0:v.props)!=null&&w.isSelected?!0:(g=v==null?void 0:v.props)!=null&&g.children?Ze.Children.toArray(v.props.children).some(F=>{var M;return(M=F==null?void 0:F.props)==null?void 0:M.isSelected}):!1}),b=m||y;t.useEffect(()=>{p&&b&&x(!0)},[b,p]);const $=e.jsxs("div",{onClick:()=>{S&&A(),!c&&d&&d()},className:`flex items-center px-4 py-2 mb-2 text-gray-300 hover:bg-gray-700 hover:text-white transition-colors duration-200 cursor-pointer ${b?"text-white font-semibold relative":"text-gray-100"} ${c?"cursor-not-allowed opacity-50":""}`,children:[e.jsx("span",{className:"mr-2",children:s}),a&&e.jsx("span",{className:"text-xs",children:r}),a&&e.jsx("span",{className:"ml-auto",children:C?n:l})]});return e.jsxs("div",{children:[a?$:e.jsxs(os,{children:[e.jsx(ls,{asChild:!0,children:$}),e.jsxs(as,{side:"right",children:[e.jsx("p",{className:Ze.Children.count(o)>0?"mb-4":"",children:h}),Ze.Children.map(o,v=>e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute top-0 w-1 h-full bg-gray-500"}),v]}))]})]}),C&&a&&e.jsxs("div",{className:"relative pl-8",children:[e.jsx("div",{className:"absolute top-0 w-1 h-full bg-gray-500"}),Ze.Children.map(o,v=>e.jsx("div",{children:v}))]})]})}function Jo({isExpanded:s,user:r}){const a=fs(),n=e.jsxs("div",{onClick:()=>a("/profile"),className:"flex items-center gap-4 px-4 py-2 mb-2 text-gray-300 hover:bg-gray-700 hover:text-white transition-colors duration-200 cursor-pointer",children:[e.jsx("span",{className:"text-gray-300 hover:text-white",children:e.jsx(zn,{size:24})}),s&&e.jsx("span",{className:"text-sm mr-2",children:(r==null?void 0:r.username)||"user"})]});return e.jsx("div",{children:s?n:e.jsxs(os,{children:[e.jsx(ls,{asChild:!0,children:n}),e.jsx(as,{side:"right",children:e.jsx("p",{children:(r==null?void 0:r.username)||"user"})})]})})}function Xo({handleLogout:s,isExpanded:r}){const a=e.jsxs("div",{onClick:s,className:"flex items-center gap-4 px-4 py-2 mb-2 text-gray-300 hover:bg-gray-700 hover:text-white transition-colors duration-200 cursor-pointer",children:[e.jsx("span",{className:"text-gray-300 hover:text-white",children:e.jsx(Gn,{size:24})}),r&&e.jsx("span",{className:"hidden sm:inline",children:"Logout"})]});return e.jsx("div",{children:r?a:e.jsxs(os,{children:[e.jsx(ls,{asChild:!0,children:a}),e.jsx(as,{side:"right",children:e.jsx("p",{children:"Logout"})})]})})}const le=t.forwardRef(({className:s,...r},a)=>e.jsx("div",{ref:a,className:ae("rounded-xl border bg-card text-card-foreground shadow",s),...r}));le.displayName="Card";const ws=t.forwardRef(({className:s,...r},a)=>e.jsx("div",{ref:a,className:ae("flex flex-col space-y-1.5 p-3",s),...r}));ws.displayName="CardHeader";const _s=t.forwardRef(({className:s,...r},a)=>e.jsx("h3",{ref:a,className:ae("font-semibold leading-none tracking-tight",s),...r}));_s.displayName="CardTitle";const el=t.forwardRef(({className:s,...r},a)=>e.jsx("p",{ref:a,className:ae("text-sm text-muted-foreground",s),...r}));el.displayName="CardDescription";const ce=t.forwardRef(({className:s,...r},a)=>e.jsx("div",{ref:a,className:ae("p-4 pt-3",s),...r}));ce.displayName="CardContent";const sl=t.forwardRef(({className:s,...r},a)=>e.jsx("div",{ref:a,className:ae("flex items-center p-6 pt-0",s),...r}));sl.displayName="CardFooter";function Oe({className:s,...r}){return e.jsx("div",{className:ae("animate-pulse rounded-md bg-primary/10",s),...r})}const Qe=({width:s="1.25rem",height:r="1.25rem"})=>e.jsx("svg",{style:{height:r,width:s},fill:"#1877F2",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),Xe=({width:s="1.25rem",height:r="1.25rem"})=>e.jsxs("svg",{viewBox:"0 0 24 24",style:{height:r,width:s},children:[e.jsx("path",{d:"M13.5437 4.24116L13.5441 4.24138C13.904 4.43971 14.2179 4.70303 14.4689 5.01529C14.7198 5.3275 14.903 5.68264 15.009 6.0601L15.4904 5.92486L15.009 6.0601C15.115 6.43752 15.1422 6.83078 15.0891 7.21776C15.0361 7.60457 14.9038 7.97861 14.6989 8.31855C14.6988 8.31873 14.6987 8.31891 14.6986 8.3191L8.41444 18.701C7.9918 19.3741 7.30557 19.868 6.49825 20.0687C5.68937 20.2699 4.83087 20.1586 4.10949 19.7614C3.38872 19.3646 2.86649 18.7168 2.64727 17.9633C2.42868 17.212 2.5264 16.4083 2.92214 15.7226L9.20689 5.33823C9.20695 5.33813 9.20702 5.33802 9.20708 5.33792C9.62451 4.65082 10.3142 4.14383 11.1301 3.93599C11.9464 3.72804 12.8151 3.83872 13.5437 4.24116Z",fill:"#FFB70A",stroke:"#FFB70A"}),e.jsx("path",{d:"M21.5404 15.4544L15.24 5.04127C14.7453 4.25097 13.9459 3.67817 13.0138 3.44633C12.0817 3.21448 11.0917 3.34215 10.2572 3.80182C9.4226 4.26149 8.8103 5.01636 8.55224 5.90372C8.29418 6.79108 8.41102 7.73988 8.87757 8.54562L15.178 18.9587C15.6726 19.749 16.4721 20.3218 17.4042 20.5537C18.3362 20.7855 19.3262 20.6579 20.1608 20.1982C20.9953 19.7385 21.6076 18.9836 21.8657 18.0963C22.1238 17.2089 22.0069 16.2601 21.5404 15.4544Z",fill:"#3B8AD8"}),e.jsx("path",{d:"M9.23018 16.2447C9.07335 15.6884 8.77505 15.1775 8.36166 14.7572C7.94827 14.3369 7.43255 14.0202 6.86011 13.835C6.28768 13.6499 5.67618 13.6021 5.07973 13.6958C4.48328 13.7895 3.92026 14.0219 3.44049 14.3723C2.96071 14.7227 2.57898 15.1804 2.32906 15.7049C2.07914 16.2294 1.96873 16.8045 2.00762 17.3794C2.0465 17.9542 2.23347 18.5111 2.55199 19.0007C2.8705 19.4902 3.31074 19.8975 3.83376 20.1863C4.46363 20.5354 5.1882 20.6983 5.91542 20.6542C6.64264 20.6101 7.33969 20.361 7.91802 19.9386C8.49636 19.5162 8.92988 18.9395 9.16351 18.2817C9.39715 17.624 9.42035 16.915 9.23018 16.2447Z",fill:"#2CAA14"})]}),tl=()=>e.jsxs(le,{className:"transition-transform transform hover:scale-105 hover:border hover:border-blue-600",children:[e.jsxs(ws,{className:"flex flex-col items-start justify-start",children:[e.jsxs("div",{className:"flex flex-row items-center gap-2",children:[e.jsx(Oe,{className:"w-4 h-4 rounded-full"}),e.jsx(Oe,{className:"h-6 w-24"})]}),e.jsx(Oe,{className:"h-4 w-32 mt-2"})]}),e.jsx(ce,{children:e.jsx(Oe,{className:"h-8 w-20 mt-2"})})]}),al=({label:s,value:r,date:a,icon:n,tooltipContent:l})=>{const o=m=>m?(typeof m=="string"&&(m=new Date(m)),m.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})):"";return e.jsxs(le,{className:"transition-transform transform hover:scale-105 hover:border hover:border-blue-600",children:[e.jsxs(ws,{className:"flex flex-col items-start justify-start",children:[e.jsxs("div",{className:"flex flex-row items-center gap-2",children:[n==="Facebook"?e.jsx(Qe,{width:"1rem",height:"1rem"}):n==="Google"?e.jsx(Xe,{width:"1rem",height:"1rem"}):null,e.jsx("div",{className:"text-base font-medium",children:s}),l&&e.jsx(Ds,{children:e.jsxs(os,{children:[e.jsx(ls,{asChild:!0,children:e.jsx("button",{className:"p-0 m-0","aria-label":`Info about ${s}`,children:e.jsx(cr,{className:"w-3 h-3 text-gray-400"})})}),e.jsxs(as,{className:"w-64 p-0 bg-white text-black border shadow-sm",children:[e.jsx("div",{className:"p-2 font-semibold border-black",children:s}),e.jsx("div",{className:"w-full h-[0.5px] bg-black"}),e.jsx("div",{className:"p-2",children:l})]})]})})]}),e.jsxs("div",{className:"text-xs text-gray-500 font-bold",children:[o(a.from),a.from&&a.to?" - ":"",o(a.to)]})]}),e.jsx(ce,{children:e.jsx("p",{className:"text-xl lg:text-2xl 2xl:text-3xl font-bold text-cyan-950",children:r})})]})},Bs=({title:s,metrics:r=[],date:a,isLoading:n=!1,icon:l,errorMessage:o})=>o&&!n?e.jsx("section",{className:s?"mt-10":"",children:e.jsxs(le,{className:"p-4",children:[e.jsx(ws,{children:e.jsx("h2",{className:"text-xl font-semibold flex items-center space-x-2",children:s&&e.jsxs(e.Fragment,{children:[l==="Facebook"?e.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"#1877F2",children:e.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}):e.jsxs("svg",{viewBox:"0 0 24 24",className:"w-5 h-5",children:[e.jsx("path",{d:"M13.5437 4.24116L13.5441 4.24138C13.904 4.43971 14.2179 4.70303 14.4689 5.01529C14.7198 5.3275 14.903 5.68264 15.009 6.0601L15.4904 5.92486L15.009 6.0601C15.115 6.43752 15.1422 6.83078 15.0891 7.21776C15.0361 7.60457 14.9038 7.97861 14.6989 8.31855C14.6988 8.31873 14.6987 8.31891 14.6986 8.3191L8.41444 18.701C7.9918 19.3741 7.30557 19.868 6.49825 20.0687C5.68937 20.2699 4.83087 20.1586 4.10949 19.7614C3.38872 19.3646 2.86649 18.7168 2.64727 17.9633C2.42868 17.212 2.5264 16.4083 2.92214 15.7226L9.20689 5.33823C9.20695 5.33813 9.20702 5.33802 9.20708 5.33792C9.62451 4.65082 10.3142 4.14383 11.1301 3.93599C11.9464 3.72804 12.8151 3.83872 13.5437 4.24116Z",fill:"#FFB70A",stroke:"#FFB70A"}),e.jsx("path",{d:"M21.5404 15.4544L15.24 5.04127C14.7453 4.25097 13.9459 3.67817 13.0138 3.44633C12.0817 3.21448 11.0917 3.34215 10.2572 3.80182C9.4226 4.26149 8.8103 5.01636 8.55224 5.90372C8.29418 6.79108 8.41102 7.73988 8.87757 8.54562L15.178 18.9587C15.6726 19.749 16.4721 20.3218 17.4042 20.5537C18.3362 20.7855 19.3262 20.6579 20.1608 20.1982C20.9953 19.7385 21.6076 18.9836 21.8657 18.0963C22.1238 17.2089 22.0069 16.2601 21.5404 15.4544Z",fill:"#3B8AD8"}),e.jsx("path",{d:"M9.23018 16.2447C9.07335 15.6884 8.77505 15.1775 8.36166 14.7572C7.94827 14.3369 7.43255 14.0202 6.86011 13.835C6.28768 13.6499 5.67618 13.6021 5.07973 13.6958C4.48328 13.7895 3.92026 14.0219 3.44049 14.3723C2.96071 14.7227 2.57898 15.1804 2.32906 15.7049C2.07914 16.2294 1.96873 16.8045 2.00762 17.3794C2.0465 17.9542 2.23347 18.5111 2.55199 19.0007C2.8705 19.4902 3.31074 19.8975 3.83376 20.1863C4.46363 20.5354 5.1882 20.6983 5.91542 20.6542C6.64264 20.6101 7.33969 20.361 7.91802 19.9386C8.49636 19.5162 8.92988 18.9395 9.16351 18.2817C9.39715 17.624 9.42035 16.915 9.23018 16.2447Z",fill:"#2CAA14"})]}),e.jsx("span",{children:s})]})})}),e.jsx(ce,{children:e.jsx("p",{className:"text-red-600 text-sm",children:o})})]})}):e.jsxs("section",{className:s?"mt-10":"",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 flex items-center space-x-2",children:s&&e.jsxs(e.Fragment,{children:[l==="Facebook"?e.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"#1877F2",children:e.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}):e.jsxs("svg",{viewBox:"0 0 24 24",className:"w-5 h-5",children:[e.jsx("path",{d:"M13.5437 4.24116L13.5441 4.24138C13.904 4.43971 14.2179 4.70303 14.4689 5.01529C14.7198 5.3275 14.903 5.68264 15.009 6.0601L15.4904 5.92486L15.009 6.0601C15.115 6.43752 15.1422 6.83078 15.0891 7.21776C15.0361 7.60457 14.9038 7.97861 14.6989 8.31855C14.6988 8.31873 14.6987 8.31891 14.6986 8.3191L8.41444 18.701C7.9918 19.3741 7.30557 19.868 6.49825 20.0687C5.68937 20.2699 4.83087 20.1586 4.10949 19.7614C3.38872 19.3646 2.86649 18.7168 2.64727 17.9633C2.42868 17.212 2.5264 16.4083 2.92214 15.7226L9.20689 5.33823C9.20695 5.33813 9.20702 5.33802 9.20708 5.33792C9.62451 4.65082 10.3142 4.14383 11.1301 3.93599C11.9464 3.72804 12.8151 3.83872 13.5437 4.24116Z",fill:"#FFB70A",stroke:"#FFB70A"}),e.jsx("path",{d:"M21.5404 15.4544L15.24 5.04127C14.7453 4.25097 13.9459 3.67817 13.0138 3.44633C12.0817 3.21448 11.0917 3.34215 10.2572 3.80182C9.4226 4.26149 8.8103 5.01636 8.55224 5.90372C8.29418 6.79108 8.41102 7.73988 8.87757 8.54562L15.178 18.9587C15.6726 19.749 16.4721 20.3218 17.4042 20.5537C18.3362 20.7855 19.3262 20.6579 20.1608 20.1982C20.9953 19.7385 21.6076 18.9836 21.8657 18.0963C22.1238 17.2089 22.0069 16.2601 21.5404 15.4544Z",fill:"#3B8AD8"}),e.jsx("path",{d:"M9.23018 16.2447C9.07335 15.6884 8.77505 15.1775 8.36166 14.7572C7.94827 14.3369 7.43255 14.0202 6.86011 13.835C6.28768 13.6499 5.67618 13.6021 5.07973 13.6958C4.48328 13.7895 3.92026 14.0219 3.44049 14.3723C2.96071 14.7227 2.57898 15.1804 2.32906 15.7049C2.07914 16.2294 1.96873 16.8045 2.00762 17.3794C2.0465 17.9542 2.23347 18.5111 2.55199 19.0007C2.8705 19.4902 3.31074 19.8975 3.83376 20.1863C4.46363 20.5354 5.1882 20.6983 5.91542 20.6542C6.64264 20.6101 7.33969 20.361 7.91802 19.9386C8.49636 19.5162 8.92988 18.9395 9.16351 18.2817C9.39715 17.624 9.42035 16.915 9.23018 16.2447Z",fill:"#2CAA14"})]}),e.jsx("span",{children:s})]})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:n?Array(r.length).fill(0).map((m,h)=>e.jsx(tl,{},h)):r.map((m,h)=>e.jsx(e.Fragment,{children:e.jsx(al,{label:m.label,value:m.value,date:a,icon:l,tooltipContent:m.tooltipContent},h)}))})]}),rl=({campaigns:s,isLoading:r,icon:a})=>r?e.jsx("div",{children:"Loading..."}):e.jsxs(le,{className:" p-4 my-4  hover:border hover:border-blue-600",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[a==="Facebook"?e.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"#1877F2",children:e.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}):e.jsxs("svg",{viewBox:"0 0 24 24",className:"w-5 h-5",children:[e.jsx("path",{d:"M13.5437 4.24116L13.5441 4.24138C13.904 4.43971 14.2179 4.70303 14.4689 5.01529C14.7198 5.3275 14.903 5.68264 15.009 6.0601L15.4904 5.92486L15.009 6.0601C15.115 6.43752 15.1422 6.83078 15.0891 7.21776C15.0361 7.60457 14.9038 7.97861 14.6989 8.31855C14.6988 8.31873 14.6987 8.31891 14.6986 8.3191L8.41444 18.701C7.9918 19.3741 7.30557 19.868 6.49825 20.0687C5.68937 20.2699 4.83087 20.1586 4.10949 19.7614C3.38872 19.3646 2.86649 18.7168 2.64727 17.9633C2.42868 17.212 2.5264 16.4083 2.92214 15.7226L9.20689 5.33823C9.20695 5.33813 9.20702 5.33802 9.20708 5.33792C9.62451 4.65082 10.3142 4.14383 11.1301 3.93599C11.9464 3.72804 12.8151 3.83872 13.5437 4.24116Z",fill:"#FFB70A",stroke:"#FFB70A"}),e.jsx("path",{d:"M21.5404 15.4544L15.24 5.04127C14.7453 4.25097 13.9459 3.67817 13.0138 3.44633C12.0817 3.21448 11.0917 3.34215 10.2572 3.80182C9.4226 4.26149 8.8103 5.01636 8.55224 5.90372C8.29418 6.79108 8.41102 7.73988 8.87757 8.54562L15.178 18.9587C15.6726 19.749 16.4721 20.3218 17.4042 20.5537C18.3362 20.7855 19.3262 20.6579 20.1608 20.1982C20.9953 19.7385 21.6076 18.9836 21.8657 18.0963C22.1238 17.2089 22.0069 16.2601 21.5404 15.4544Z",fill:"#3B8AD8"}),e.jsx("path",{d:"M9.23018 16.2447C9.07335 15.6884 8.77505 15.1775 8.36166 14.7572C7.94827 14.3369 7.43255 14.0202 6.86011 13.835C6.28768 13.6499 5.67618 13.6021 5.07973 13.6958C4.48328 13.7895 3.92026 14.0219 3.44049 14.3723C2.96071 14.7227 2.57898 15.1804 2.32906 15.7049C2.07914 16.2294 1.96873 16.8045 2.00762 17.3794C2.0465 17.9542 2.23347 18.5111 2.55199 19.0007C2.8705 19.4902 3.31074 19.8975 3.83376 20.1863C4.46363 20.5354 5.1882 20.6983 5.91542 20.6542C6.64264 20.6101 7.33969 20.361 7.91802 19.9386C8.49636 19.5162 8.92988 18.9395 9.16351 18.2817C9.39715 17.624 9.42035 16.915 9.23018 16.2447Z",fill:"#2CAA14"})]}),e.jsx("h3",{className:"text-lg font-semibold",children:"Campaign Performance"})]}),e.jsx("div",{className:"overflow-x-auto max-h-[280px] overflow-y-auto",children:e.jsxs("table",{className:"min-w-full table-auto border-collapse bg-white shadow-md rounded-lg",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100 text-left text-sm font-medium text-gray-700 sticky top-0",children:[e.jsx("th",{className:"px-6 py-3",children:"Campaign Name"}),e.jsx("th",{className:"px-6 py-3 text-center",children:"Spend (₹)"}),e.jsx("th",{className:"px-6 py-3 text-center",children:"ROAS"})]})}),e.jsx("tbody",{children:s.map((n,l)=>{var d;const o=parseFloat(String(n.spend));let m=null;typeof n.purchase_roas=="string"?m=n.purchase_roas:Array.isArray(n.purchase_roas)&&(m=(d=n.purchase_roas[0])==null?void 0:d.value);const h=m?parseFloat(String(m)):null;return e.jsxs("tr",{className:`border-t text-sm ${l%2===0?"bg-gray-50":"bg-white"}`,children:[e.jsx("td",{className:"px-6 py-3 line-clamp-2",title:String(n.campaign_name),children:n.campaign_name}),e.jsxs("td",{className:"px-6 py-3 text-center text-gray-700 font-semibold",children:["₹",o.toFixed(2)]}),e.jsx("td",{className:"px-6 py-3 text-center",children:h!==null?e.jsx("span",{className:"inline-flex items-center rounded-full font-medium",children:h.toFixed(2)}):e.jsx("span",{className:"text-gray-500",children:"N/A"})})]},l)})})]})})]}),nl=({label:s,value:r,isActive:a,onClick:n})=>e.jsx("button",{className:`px-6 py-2 text-sm font-bold transition-colors duration-200 ${a?" text-blue-500":"text-gray-600 hover:text-gray-900"}`,onClick:()=>n(r),children:s}),zs=({tabs:s,activeTab:r,onTabChange:a})=>e.jsx("div",{className:"flex justify-center items-center border-b border-gray-200",children:s.map(n=>e.jsx(nl,{label:n.label,value:n.value,isActive:r===n.value,onClick:a},n.value))});function ut({className:s,classNames:r,showOutsideDays:a=!0,...n}){return e.jsx(bo,{showOutsideDays:a,className:ae("px-3",s),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-xs font-medium",nav:"space-x-1 flex items-center",nav_button:ae($t({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-7 font-normal text-[0.6rem]",row:"flex w-full mt-2",cell:ae("relative p-0 text-center text-[0.7rem] focus-within:relative focus-within:z-20 [&:has([aria-selected])]:bg-accent [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected].day-range-end)]:rounded-r-md",n.mode==="range"?"[&:has(>.day-range-end)]:rounded-r-md [&:has(>.day-range-start)]:rounded-l-md first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md":"[&:has([aria-selected])]:rounded-md"),day:ae($t({variant:"ghost"}),"h-7 w-7 p-0 font-normal aria-selected:opacity-100 text-[0.7rem]"),day_range_start:"day-range-start",day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50  aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...r},components:{IconLeft:()=>e.jsx(mn,{className:"h-4 w-4"}),IconRight:()=>e.jsx(Pa,{className:"h-4 w-4"})},...n})}ut.displayName="Calendar";const Is=hn,Fs=xn,Cs=t.forwardRef(({className:s,align:r="start",sideOffset:a=4,...n},l)=>e.jsx(un,{children:e.jsx(La,{ref:l,align:r,sideOffset:a,className:ae("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...n})}));Cs.displayName=La.displayName;const ps=t.forwardRef(({className:s,...r},a)=>e.jsx(Ea,{ref:a,className:ae("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...r,children:e.jsx(fn,{className:ae("flex items-center justify-center text-current"),children:e.jsx(Lt,{className:"h-4 w-4"})})}));ps.displayName=Ea.displayName;const ol={from:new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString(),to:new Date().toISOString()},Mr=$s({name:"date",initialState:ol,reducers:{setDate:(s,r)=>{s.from=r.payload.from,s.to=r.payload.to,s.compareFrom=r.payload.compareFrom,s.compareTo=r.payload.compareTo},clearDate:s=>{s.from=void 0,s.to=void 0,s.compareFrom=void 0,s.compareTo=void 0}}}),{setDate:ue,clearDate:ll}=Mr.actions,il=Mr.reducer,cl=vo(s=>s.date.from,s=>s.date.to,(s,r)=>({from:s,to:r}));function be({defaultDate:s,resetToFirstPage:r}){const a=Se(),n=z(cl),l=t.useMemo(()=>n?{from:n.from?new Date(n.from):void 0,to:n.to?new Date(n.to):void 0}:s?{from:s.from?new Date(s.from):void 0,to:s.to?new Date(s.to):void 0}:void 0,[n,s]),[o,m]=t.useState(l),[h,d]=t.useState(),[c,p]=t.useState(!1),[C,x]=t.useState(null),[S,A]=t.useState(!1),[y,b]=t.useState("primary"),[$,v]=t.useState(o!=null&&o.from?H(o.from,"yyyy-MM-dd"):""),[w,g]=t.useState(o!=null&&o.to?H(o.to,"yyyy-MM-dd"):""),[F,M]=t.useState(""),[N,u]=t.useState(""),I=t.useMemo(()=>{const j=new Date,E=j.getDay(),R=vs(j,E),Y=yo(R,6),W=new Date(j.getFullYear(),j.getMonth(),1),O=new Date(j.getFullYear(),j.getMonth()+1,0),J=vs(R,7),se=vs(R,1),Q=Math.floor(j.getMonth()/3),re=new Date(j.getFullYear(),Q*3,1),xe=new Date(j.getFullYear(),(Q+1)*3,0),U=j.getMonth()<3?3:Math.floor((j.getMonth()-3)/3),G=j.getMonth()<3?j.getFullYear()-1:j.getFullYear(),X=new Date(G,U*3,1),ee=new Date(G,(U+1)*3,0);return{today:j,startOfThisWeek:R,endOfThisWeek:Y,startOfThisMonth:W,endOfThisMonth:O,startOfLastWeek:J,endOfLastWeek:se,startOfThisQuarter:re,endOfThisQuarter:xe,startOfLastQuarter:X,endOfLastQuarter:ee}},[]),i=t.useCallback(j=>{try{const E=No(j,"yyyy-MM-dd",new Date);return isNaN(E.getTime())?void 0:E}catch{return}},[]),L=t.useCallback(()=>{const j=i($),E=i(w);j&&E&&(m({from:j,to:E}),x(null))},[$,w,i]),_=t.useCallback(()=>{const j=i(F),E=i(N);j&&E&&d({from:j,to:E})},[F,N,i]),T=t.useCallback((j,E)=>{y==="primary"?(m({from:j,to:E}),v(H(j,"yyyy-MM-dd")),g(H(E,"yyyy-MM-dd"))):y==="comparison"&&(d({from:j,to:E}),M(H(j,"yyyy-MM-dd")),u(H(E,"yyyy-MM-dd"))),x(null)},[y]),f=t.useMemo(()=>[{label:"Today",fn:()=>T(I.today,I.today)},{label:"Yesterday",fn:()=>T(vs(I.today,1),vs(I.today,1))},{label:"This Week",fn:()=>T(I.startOfThisWeek,I.endOfThisWeek)},{label:"Last 7 Days",fn:()=>T(vs(I.today,6),I.today)},{label:"Last week",fn:()=>T(I.startOfLastWeek,I.endOfLastWeek)},{label:"Last 30 Days",fn:()=>T(vs(I.today,29),I.today)},{label:"This Month",fn:()=>T(I.startOfThisMonth,I.today)},{label:"Last 3 Months",fn:()=>T(la(I.today,3),I.today)},{label:"Last 6 Months",fn:()=>T(la(I.today,6),I.today)},{label:"This Quarter",fn:()=>T(I.startOfThisQuarter,I.endOfThisQuarter)},{label:"Last Quarter",fn:()=>T(I.startOfLastQuarter,I.endOfLastQuarter)},{label:"This Year",fn:()=>T(new Date(new Date().getFullYear(),0,1),I.today)},{label:"Last 365 Days",fn:()=>T(vs(I.today,365),I.today)},{label:"Last Year",fn:()=>T(ia(wo(new Date),1),ia(Co(new Date),1))}],[I,T]),P=t.useCallback(j=>{y==="primary"?(j!=null&&j.from&&!j.to?(m({from:j.from,to:j.from}),v(H(j.from,"yyyy-MM-dd")),g(H(j.from,"yyyy-MM-dd"))):j!=null&&j.from&&(j!=null&&j.to)&&j.from>j.to?(m({from:j.from,to:j.from}),v(H(j.from,"yyyy-MM-dd")),g(H(j.from,"yyyy-MM-dd"))):j!=null&&j.from&&(j!=null&&j.to)?(m(j),v(H(j.from,"yyyy-MM-dd")),g(H(j.to,"yyyy-MM-dd"))):(m(void 0),v(""),g("")),x(null)):j!=null&&j.from&&!j.to?(d({from:j.from,to:j.from}),M(H(j.from,"yyyy-MM-dd")),u(H(j.from,"yyyy-MM-dd"))):j!=null&&j.from&&(j!=null&&j.to)&&j.from>j.to?(d({from:j.from,to:j.from}),M(H(j.from,"yyyy-MM-dd")),u(H(j.from,"yyyy-MM-dd"))):j!=null&&j.from&&(j!=null&&j.to)?(d(j),M(H(j.from,"yyyy-MM-dd")),u(H(j.to,"yyyy-MM-dd"))):(d(void 0),M(""),u(""))},[y]),V=t.useCallback(j=>j?j.from?j.to?`${H(j.from,"LLL dd, y")} - ${H(j.to,"LLL dd, y")}`:H(j.from,"LLL dd, y"):"Pick a date":s&&s.from&&s.to?`${H(s.from,"LLL dd, y")} - ${H(s.to,"LLL dd, y")}`:"Pick a date",[s]),Z=t.useCallback(()=>{m(void 0),d(void 0),x(null),A(!1),v(""),g(""),M(""),u(""),a(ll()),r&&r(),p(!1)},[a,r]),k=t.useCallback(()=>{o&&a(ue({from:o.from?o.from.toISOString():void 0,to:o.to?o.to.toISOString():void 0,compareFrom:S&&(h!=null&&h.from)?h.from.toISOString():void 0,compareTo:S&&(h!=null&&h.to)?h.to.toISOString():void 0})),r&&r(),p(!1)},[a,r,o,h,S]);return e.jsxs(Is,{open:c,onOpenChange:p,children:[e.jsx(Fs,{asChild:!0,children:e.jsxs(D,{variant:"outline",className:ae("w-[250px] justify-start text-left font-normal",!o&&!s&&"text-muted-foreground","hover:bg-muted/50 transition-colors rounded-lg border-muted-foreground/20"),children:[e.jsx(_n,{className:"mr-2 h-4 w-4 text-primary"}),V(o)]})}),e.jsxs(Cs,{className:"w-auto p-0 max-w-[650px]",align:"start",children:[e.jsxs("div",{className:"flex flex-col md:flex-row",children:[e.jsx("div",{className:"border-r p-3 w-full md:w-[150px] overflow-y-auto bg-gradient-to-b from-muted/50 to-muted/10",style:{maxHeight:"400px"},children:e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("h1",{className:"text-sm pb-2 font-medium border-b border-border/50 text-primary",children:"Presets"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-1 gap-1",children:f.map(j=>e.jsx(D,{size:"sm",variant:C===j.label?"default":"ghost",className:ae("w-full justify-start text-xs font-normal h-8 rounded-md",C===j.label?"bg-primary text-primary-foreground":"hover:bg-muted text-muted-foreground hover:text-foreground"),onClick:()=>{j.fn(),x(j.label)},children:j.label},j.label))})]})}),e.jsxs("div",{className:"p-3 flex-grow",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(ps,{id:"compare-toggle",checked:S,onCheckedChange:()=>A(!S),className:"text-primary"}),e.jsx("label",{htmlFor:"compare-toggle",className:"text-sm font-medium",children:"Compare with another period"})]}),e.jsxs("div",{className:"grid gap-3 mb-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-xs font-medium text-muted-foreground",children:"Primary Range"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(De,{placeholder:"YYYY-MM-DD",value:$,onChange:j=>v(j.target.value),onBlur:L,onClick:()=>{b("primary")},className:"h-8 pl-10 text-xs rounded-md"}),e.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-xs text-muted-foreground",children:"From"})]}),e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(De,{placeholder:"YYYY-MM-DD",value:w,onChange:j=>g(j.target.value),onBlur:L,onClick:()=>{b("primary")},className:"h-8 pl-10 text-xs rounded-md"}),e.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-xs text-muted-foreground",children:"To"})]})]})]}),S&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-xs font-medium text-muted-foreground",children:"Comparison Range"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(De,{placeholder:"YYYY-MM-DD",value:F,onChange:j=>M(j.target.value),onBlur:_,onClick:()=>{b("comparison")},className:"h-8 pl-10 text-xs rounded-md"}),e.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-xs text-muted-foreground",children:"From"})]}),e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(De,{placeholder:"YYYY-MM-DD",value:N,onChange:j=>u(j.target.value),onBlur:_,onClick:()=>{b("comparison")},className:"h-8 pl-10 text-xs rounded-md"}),e.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-xs text-muted-foreground",children:"To"})]})]})]})]}),e.jsx("div",{className:"border rounded-lg p-2 bg-background/80 shadow-sm",children:e.jsx(ut,{initialFocus:!0,mode:"range",defaultMonth:y==="primary"?(o==null?void 0:o.from)||(s==null?void 0:s.from)||I.today:(h==null?void 0:h.from)||I.today,selected:y==="primary"?o:h,onSelect:P,numberOfMonths:2,disabled:j=>j>new Date||j<new Date("2023-01-01"),className:"rounded-md"})})]})]}),e.jsxs("div",{className:"border-t p-2 flex justify-end gap-2 bg-muted/10",children:[e.jsx(D,{variant:"outline",size:"sm",onClick:Z,className:"rounded-md h-8 text-xs",children:"Clear"}),e.jsx(D,{size:"sm",onClick:k,className:"rounded-md h-8 text-xs bg-primary hover:bg-primary/90",children:"Apply"})]})]})]})}const Yt=[{id:"business-performance",title:"Business Performance",route:"/dashboard",description:"Period wise Metrics Performance"},{id:"report-tab",title:"Report Tab",route:/^\/conversion-reports\/[a-zA-Z0-9]+\/demographics$/,description:"Choose the Reports you want. Tap one any of the report and you will redirect to that report",priority:2,relatedTutorials:["age-conversion-report"]},{id:"age-conversion-report",title:"Age Conversion Report",description:"Understanding the age conversion report",route:/^\/conversion-reports\/[a-zA-Z0-9]+\/demographics$/,componentId:"age-report",priority:1},{id:"marketing-insights",title:"Marketing Insights",description:"Understanding the marketing insights iver different months",route:/^\/ad-metrics\/[a-zA-Z0-9]+$/}],dl={"business-performance":[{element:"#analytics-section",popover:{title:"Analytics Overview",description:"This section provides key business metrics such as Sessions, Cart Additions, Checkouts, and Purchases.",position:"top"}},{element:"#sessions-metric",popover:{title:"Sessions Overview",description:`This section shows the total number of sessions on your website:

            - Yesterday: Displays the total sessions for yesterday and its comparison to the previous day.

            - Last 7 Days: Aggregates data for the last 7 days and compares it with the previous 7-day period.

            - Last 30 Days: Shows trends over the last month, compared with the previous 30-day period.`,position:"bottom"}}],"report-tab":[{element:"#report-tab",popover:{title:"Report Tab",description:"Choose the Reports you want. Tap one any of the report and you will redirect to that report",position:"bottom"}}],"age-conversion-report":[{element:"#age-report",popover:{title:"Age based Report",description:"Review detailed monthly conversion numbers for each age group here.",position:"top"}},{element:"#age-report-performance",popover:{title:"Key Performers",description:"These metrics highlight your best and worst performing age segments.",position:"left"}},{element:"#age-report-table",popover:{title:"Detailed Data",description:"Analyze session counts, conversion rates, and purchase trends for different age groups over time.",position:"top"}},{element:"#refresh",popover:{title:"Refresh for Updated Values",description:"Refresh to see the latest performance metrics for different age segments",position:"bottom"}},{element:"#filters",popover:{title:"Filter Your Data",description:"Use filters to refine your data by selecting a metric, condition, and value. Click 'Add Filter' to apply.",position:"bottom"}},{element:"#download-button",popover:{title:"Download Your Excel Report",description:"Click to download the report as an Excel file for further analysis.",position:"bottom"}},{element:"#expand-button",popover:{title:"Expand the Table for a Better View",description:"Click to enlarge the table for easier data analysis and readability.",position:"bottom"}}],"marketing-insights":[{element:"#metrics-table",popover:{title:"Monthly Performance Overview",description:"This table displays key performance metrics for each month over the last two years, including ad spend, sales, and ROAS for Meta, Google, and Shopify.",position:"left"}},{element:"#expand-month",popover:{title:"Expand to View Daily Breakdown",description:"Click on a month to expand and see the daily breakdown of ad performance metrics.",position:"top"}}]},ml=s=>Yt.filter(r=>typeof r.route=="string"?r.route===s:r.route.test(s)).sort((r,a)=>(a.priority||0)-(r.priority||0)),ul=s=>{const r=Wt(s);return r!=null&&r.steps&&r.steps.length>0?r.steps:dl[s]||[]},Wt=s=>Yt.find(r=>r.id===s),hl=s=>{const r=Wt(s);return(r==null?void 0:r.relatedTutorials)||[]},Kt=s=>{const a=[...ml(s)].sort((m,h)=>(h.priority||0)-(m.priority||0)),n=new Map,l=m=>{if(!n.has(m.id)&&(n.set(m.id,m),m.relatedTutorials&&m.relatedTutorials.length>0))for(const h of m.relatedTutorials){const d=Wt(h);d&&l(d)}};for(const m of a)l(m);const o=Array.from(n.values());return console.log("Available tutorials:",o.map(m=>m.id).join(", ")),o},xl={};Yt.forEach(s=>{xl[s.id]=s.route});const fl={isFirstTimeLogin:!1,activeTutorial:null,isTutorialActive:!1,activeTutorialStep:0,tutorialQueue:[],completedTutorials:{}},Tr=$s({name:"tutorial",initialState:fl,reducers:{setFirstTimeLogin:(s,r)=>{s.isFirstTimeLogin=r.payload},queueTutorials:(s,r)=>{const a=r.payload.filter(n=>!s.tutorialQueue.includes(n)&&n!==s.activeTutorial);if(a.length===0){console.log("No new tutorials to queue");return}s.tutorialQueue=[...a,...s.tutorialQueue],console.log(`Queued tutorials: ${a.join(", ")}, Queue is now: ${s.tutorialQueue.join(", ")}`),!s.isTutorialActive&&s.tutorialQueue.length>0&&(s.activeTutorial=s.tutorialQueue[0],s.tutorialQueue=s.tutorialQueue.slice(1),s.isTutorialActive=!0,s.activeTutorialStep=0,console.log(`Auto-starting tutorial: ${s.activeTutorial}`))},startTutorial:(s,r)=>{s.activeTutorial=r.payload,s.isTutorialActive=!0,s.activeTutorialStep=0,console.log(`Manually starting tutorial: ${r.payload}`)},nextTutorial:s=>{s.activeTutorial&&(s.completedTutorials[s.activeTutorial]=!0,console.log(`Completed tutorial: ${s.activeTutorial}`)),console.log(`nextTutorial called, queue length: ${s.tutorialQueue.length}, queue: [${s.tutorialQueue.join(", ")}]`),s.tutorialQueue.length>0?(s.activeTutorial=s.tutorialQueue[0],s.tutorialQueue=s.tutorialQueue.slice(1),s.activeTutorialStep=0,s.isTutorialActive=!0,console.log(`Starting next tutorial: ${s.activeTutorial}, remaining queue: [${s.tutorialQueue.join(", ")}]`)):(s.activeTutorial=null,s.isTutorialActive=!1,console.log("No more tutorials in queue, stopping tutorial mode"))},setTutorialStep:(s,r)=>{s.activeTutorialStep=r.payload},stopTutorial:s=>{s.activeTutorial&&(s.completedTutorials[s.activeTutorial]=!0,console.log(`Tutorial stopped, marking ${s.activeTutorial} as completed`)),s.isTutorialActive=!1,s.activeTutorial=null,s.tutorialQueue=[],s.activeTutorialStep=0,console.log("Tutorial stopped, queue cleared")},completeFirstTimeLogin:s=>{s.isFirstTimeLogin=!1},resetTutorial:(s,r)=>{s.completedTutorials[r.payload]&&(s.completedTutorials[r.payload]=!1)},resetAllTutorials:s=>{s.completedTutorials={}}}}),{setFirstTimeLogin:gl,queueTutorials:Es,startTutorial:zd,nextTutorial:kt,setTutorialStep:pl,stopTutorial:Gd,completeFirstTimeLogin:jl,resetTutorial:_d,resetAllTutorials:Bd}=Tr.actions,vl=Tr.reducer,bl=({className:s="",buttonText:r="Start Tutorial",variant:a="primary",componentId:n,tutorialId:l,position:o="inline"})=>{const m=Se(),d=pt().pathname,c=z(x=>x.tutorials.isTutorialActive),p=()=>{if(l){m(Es([l]));return}const x=Kt(d),S=x.map(A=>A.id);if(o==="header"){S.length>0?m(Es(S)):console.warn(`No tutorials found for path ${d}`);return}if(n){const A=x.filter(y=>y.componentId===n).map(y=>y.id);A.length>0?m(Es(A)):console.warn(`No tutorials found for component ${n} on path ${d}`);return}S.length>0?m(Es(S)):console.warn(`No tutorials found for path ${d}`)},C={primary:"bg-blue-500 hover:bg-blue-600 text-white",secondary:"bg-gray-500 hover:bg-gray-600 text-white",outline:"border border-blue-500 text-blue-500 hover:bg-blue-50"};return e.jsx("button",{onClick:p,disabled:c,className:`px-4 py-2 rounded-md ${C[a]} ${s} ${c?"opacity-50 cursor-not-allowed":""}`,children:r})},Ir=()=>{const r=pt().pathname,a=z(h=>h.tutorials.isTutorialActive),n=z(h=>h.tutorials.completedTutorials||{}),l=Kt(r),o=l.length>0,m=o&&l.every(h=>n[h.id]);return!o||a?null:e.jsx(bl,{buttonText:m?"Replay Tutorial":"Start Tutorial",variant:"outline",position:"header",className:"ml-2"})};function js({title:s,Icon:r,showDatePicker:a=!1,showSettings:n=!1,showRefresh:l=!1,isLoading:o=!1,handleManualRefresh:m,locale:h,setLocale:d}){return e.jsx("header",{className:"sticky top-0 z-40 bg-white border-b px-6 py-3 transition-all duration-300",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"rounded-lg bg-secondary p-2 transition-transform duration-300 ease-in-out hover:scale-110",children:e.jsx(r,{className:"h-6 w-6 text-secondary-foreground"})}),e.jsx("h1",{className:"text-2xl font-semibold tracking-tight bg-clip-text text-transparent bg-gradient-to-r from-secondary-foreground to-primary",children:s})]}),e.jsxs("div",{className:"flex flex-row items-center space-x-2",children:[a&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{defaultDate:{from:new Date(new Date().getFullYear(),new Date().getMonth(),1),to:new Date}})}),l&&e.jsx("div",{className:"md:flex items-center hidden",children:e.jsx(D,{onClick:m,disabled:o,className:"flex items-center",children:e.jsx(fe,{className:`h-4 w-4 ${o?"animate-spin":""}`})})}),n&&e.jsxs(Is,{children:[e.jsx(Fs,{asChild:!0,children:e.jsx(D,{variant:"outline",size:"icon",children:e.jsx(dr,{className:"h-4 w-4"})})}),e.jsx(Cs,{children:e.jsxs("div",{className:"grid gap-2",children:[e.jsx("h3",{className:"font-medium",children:"Locale Settings"}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"radio",name:"locale",value:"en-IN",checked:h==="en-IN",onChange:()=>d&&d("en-IN"),className:"mr-2"}),"Indian Formatting"]}),e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"radio",name:"locale",value:"en-US",checked:h==="en-US",onChange:()=>d&&d("en-US"),className:"mr-2"}),"Western Formatting"]})]})]})})]}),e.jsx(Ir,{})]})]})})}const yl={labels:{},isAddingLabel:!1},Fr=$s({name:"campaignLabels",initialState:yl,reducers:{addLabelToCampaign:(s,r)=>{const{accountId:a,campaignId:n,label:l}=r.payload;s.labels[a]||(s.labels[a]={}),s.labels[a][n]||(s.labels[a][n]=[]),s.labels[a][n].includes(l)||s.labels[a][n].push(l)},removeLabelFromCampaign:(s,r)=>{const{accountId:a,campaignId:n,label:l}=r.payload;s.labels[a]&&s.labels[a][n]&&(s.labels[a][n]=s.labels[a][n].filter(o=>o!==l))},toggleAddingLabel:(s,r)=>{s.isAddingLabel=r.payload},clearAccountLabels:(s,r)=>{const a=r.payload;s.labels[a]&&(s.labels[a]={})},deleteLabel:(s,r)=>{const{accountId:a,label:n}=r.payload;s.labels[a]&&(Object.keys(s.labels[a]).forEach(l=>{s.labels[a][l]=s.labels[a][l].filter(o=>o!==n),s.labels[a][l].length===0&&delete s.labels[a][l]}),Object.keys(s.labels[a]).length===0&&delete s.labels[a])},copyLabels:(s,r)=>{const{accountId:a,sourceCampaignId:n,targetCampaignId:l}=r.payload;s.labels[a]&&s.labels[a][n]&&(s.labels[a][l]||(s.labels[a][l]=[]),s.labels[a][n].forEach(o=>{s.labels[a][l].includes(o)||s.labels[a][l].push(o)}))}}}),{addLabelToCampaign:Nl,removeLabelFromCampaign:wl,toggleAddingLabel:fa,clearAccountLabels:Vd,copyLabels:Ud,deleteLabel:Hd}=Fr.actions,Cl=Fr.reducer,Sl=Hs("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Vs({className:s,variant:r,...a}){return e.jsx("div",{className:ae(Sl({variant:r}),s),...a})}const Al=Da,kl=za,Ml=Oa,$r=t.forwardRef(({className:s,...r},a)=>e.jsx(ht,{className:ae("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...r,ref:a}));$r.displayName=ht.displayName;const Tl=Hs("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500 data-[state=open]:animate-in data-[state=closed]:animate-out",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),Pr=t.forwardRef(({side:s="right",className:r,children:a,...n},l)=>e.jsxs(Ml,{children:[e.jsx($r,{}),e.jsxs(xt,{ref:l,className:ae(Tl({side:s}),r),...n,children:[e.jsxs(Ra,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[e.jsx(Pt,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]}),a]})]}));Pr.displayName=xt.displayName;const Lr=({className:s,...r})=>e.jsx("div",{className:ae("flex flex-col space-y-2 text-center sm:text-left",s),...r});Lr.displayName="SheetHeader";const Er=t.forwardRef(({className:s,...r},a)=>e.jsx(ft,{ref:a,className:ae("text-lg font-semibold text-foreground",s),...r}));Er.displayName=ft.displayName;const Rr=t.forwardRef(({className:s,...r},a)=>e.jsx(gt,{ref:a,className:ae("text-sm text-muted-foreground",s),...r}));Rr.displayName=gt.displayName;const yt=({visibleColumns:s,columnOrder:r,frozenColumns:a=[],onVisibilityChange:n,onOrderChange:l,onFrozenChange:o})=>{const[m,h]=t.useState(""),[d,c]=t.useState(null),[p,C]=t.useState(null),x=r.filter(v=>v.toLowerCase().includes(m.toLowerCase())),S=v=>{c(v)},A=(v,w)=>{v.preventDefault(),w!==d&&C(w)},y=v=>{if(!d||d===v)return;const w=[...r],g=w.indexOf(d),F=w.indexOf(v);w.splice(g,1),w.splice(F,0,d),l(w),c(null),C(null)},b=v=>{const w=s.includes(v)?s.filter(g=>g!==v):[...s,v];n(w)},$=v=>{if(!o||v==="Campaign")return;const w=a.includes(v)?a.filter(g=>g!==v):[...a,v];o(w)};return e.jsxs(Al,{children:[e.jsx(kl,{asChild:!0,children:e.jsxs(D,{variant:"outline",size:"sm",className:"ml-2",children:[e.jsx(Bn,{className:"w-4 h-4 mr-2"}),"Manage Columns"]})}),e.jsxs(Pr,{className:"w-[400px] sm:w-[540px]",children:[e.jsxs(Lr,{children:[e.jsx(Er,{children:"Column Management"}),e.jsx(Rr,{children:"Select columns to display, drag to reorder, and pin columns to freeze them"})]}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 px-1",children:[e.jsx(Ws,{className:"w-4 h-4 text-slate-400"}),e.jsx(De,{placeholder:"Search columns...",value:m,onChange:v=>h(v.target.value),className:"h-8"})]}),e.jsx("div",{className:"max-h-[calc(100vh-200px)] overflow-y-auto",children:x.map(v=>e.jsxs("div",{draggable:!0,onDragStart:()=>S(v),onDragOver:w=>A(w,v),onDrop:()=>y(v),className:`flex items-center space-x-3 p-3 border-b border-slate-200 hover:bg-slate-50 cursor-move
                  ${p===v?"bg-slate-100":""}`,children:[e.jsx(mr,{className:"w-4 h-4 text-slate-400"}),e.jsx(ps,{id:`col-${v}`,checked:s.includes(v),onCheckedChange:()=>b(v)}),e.jsx("label",{htmlFor:`col-${v}`,className:"flex-1 text-sm font-medium leading-none cursor-pointer",children:v}),o&&e.jsx(D,{variant:"ghost",size:"sm",className:`px-2 ${v==="Campaign"?"opacity-50 cursor-not-allowed":""}`,onClick:()=>$(v),disabled:v==="Campaign",children:a.includes(v)||v==="Campaign"?e.jsx(Vn,{className:"w-4 h-4 text-blue-500"}):e.jsx(Un,{className:"w-4 h-4"})})]},v))})]})]})]})},ga=["bg-red-100 text-red-800 border border-red-200 hover:bg-red-200","bg-blue-100 text-blue-800 border border-blue-200 hover:bg-blue-200","bg-green-100 text-green-800 border border-green-200 hover:bg-green-200","bg-yellow-100 text-yellow-800 border border-yellow-200 hover:bg-yellow-200","bg-purple-100 text-purple-800 border border-purple-200 hover:bg-purple-200","bg-pink-100 text-pink-800 border border-pink-200 hover:bg-pink-200","bg-indigo-100 text-indigo-800 border border-indigo-200 hover:bg-indigo-200","bg-orange-100 text-orange-800 border border-orange-200 hover:bg-orange-200"],pa="85px",Or=({data:s,height:r})=>{const a=Se(),[n,l]=t.useState(""),[o,m]=t.useState([]),[h,d]=t.useState(!1),[c,p]=t.useState(""),[C,x]=t.useState(null),[S,A]=t.useState(null),[y,b]=t.useState(!1),[$,v]=t.useState(null),[w,g]=t.useState(null),[F,M]=t.useState([]),[N,u]=t.useState([]),[I,i]=t.useState(["Campaign"]),[L,_]=t.useState(!0),[T,f]=t.useState([]),[P,V]=t.useState([]),Z=t.useRef(null),k=t.useRef({}),{labels:j,isAddingLabel:E}=z(K=>K.campaignLabels),R=t.useMemo(()=>j[s.account_id]||{},[j,s.account_id]),Y=t.useMemo(()=>Object.values(R).some(K=>K&&K.length>0),[R]);t.useEffect(()=>{if(s.campaigns.length>0){const ne=Object.keys(s.campaigns[0]).filter(Ce=>Ce!=="Labels"),te=Y||E,oe=te?[...ne,"Labels"]:ne;M(oe);const he=[...ne].filter(Ce=>Ce!=="Campaign"),ie=["Campaign"];te&&ie.push("Labels"),ie.push(...he),u(ie)}},[s.campaigns,Y,E]),t.useEffect(()=>{if(L&&Y){const K=new Set;Object.entries(R).forEach(([,he])=>{he==null||he.forEach(ie=>{K.add(ie)})});const ne={};Array.from(K).forEach(he=>{ne[he]=[]});const te=[];s.campaigns.forEach(he=>{const ie=R[he.Campaign]||[];ie.length>0?ie.forEach(Ce=>{ne[Ce].push(he)}):te.push(he)});const oe=Object.entries(ne).map(([he,ie])=>({label:he,campaigns:ie,isExpanded:!0}));f(oe),V(te)}else f([]),V(s.campaigns)},[s.campaigns,R,L,Y]);const W=Ze.useMemo(()=>{const K=new Map;let ne=0;const te=new Set;return Object.values(R).forEach(oe=>{oe==null||oe.forEach(he=>te.add(he))}),Array.from(te).forEach(oe=>{K.set(oe,ga[ne%ga.length]),ne++}),K},[R]),O=K=>{let ne=0;const te=N.filter(oe=>F.includes(oe));for(let oe=0;oe<K;oe++){const he=te[oe];if(I.includes(he)){const ie=k.current[he];ie&&(ne+=ie.offsetWidth)}}return ne},J=()=>{if(n&&o.length>0&&(o.forEach(K=>{a(Nl({accountId:s.account_id,campaignId:K,label:n}))}),l(""),m([]),a(fa(!1)),!F.includes("Labels")&&(M([...F,"Labels"]),!N.includes("Labels")))){const K=N.indexOf("Campaign"),ne=[...N];ne.splice(K+1,0,"Labels"),u(ne)}},se=(K,ne)=>{a(wl({accountId:s.account_id,campaignId:K,label:ne}))},Q=s.campaigns.filter(K=>K.campaignName.toString().toLowerCase().includes(c.toLowerCase())),re=K=>K==="Campaign"?{width:"auto",minWidth:"200px"}:K==="Labels"?{width:"auto",minWidth:"120px"}:{width:pa,minWidth:pa},xe=K=>{x(K)},U=(K,ne)=>{K.preventDefault(),ne!==C&&A(ne)},G=K=>{!C||C===K||(x(null),A(null),console.log(`Dragged ${C} and dropped on ${K}`))},X=()=>{x(null),A(null)},ee=K=>{v(K)},de=(K,ne)=>{K.preventDefault(),ne!==$&&g(ne)},B=K=>{if(!$||$===K)return;const ne=N.indexOf($),te=N.indexOf(K);if(ne!==-1&&te!==-1){const oe=[...N];oe.splice(ne,1),oe.splice(te,0,$),u(oe)}v(null),g(null)},q=()=>{v(null),g(null)},me=()=>{b(!y)},Ne=K=>{const ne=[...T];ne[K].isExpanded=!ne[K].isExpanded,f(ne)},we=K=>{const ne={},te=N.filter(he=>F.includes(he)&&he!=="Campaign"&&he!=="Labels"),oe={"Conversion Rate":(he,ie)=>{const Ce=ie.reduce(($e,ze)=>$e+Number(ze["Link Click"]||0),0),Ee=ie.reduce(($e,ze)=>$e+Number(ze.Purchases||0),0);return Ce===0?0:Ee/Ce*100},"CPM (Reach Based)":(he,ie)=>{const Ce=ie.reduce(($e,ze)=>$e+Number(ze.Reach||0),0);return ie.reduce(($e,ze)=>$e+Number(ze["Amount spend"]||0),0)/(Ce/1e3)},"Audience Saturation Score":(he,ie)=>{const Ce=ie.reduce(($e,ze)=>$e+Number(ze["Outbound CTR"]||0),0),Ee=ie.reduce(($e,ze)=>$e+Number(ze.Frequency||0),0);return Ce===0?0:Ee/Ce*100},"Reach v/s Unique Click":(he,ie)=>{const Ce=ie.reduce(($e,ze)=>$e+Number(ze["Unique Link Click"]||0),0),Ee=ie.reduce(($e,ze)=>$e+Number(ze.Reach||0),0);return Ce===0?0:Ee/Ce},"High-Intent Click Rate":(he,ie)=>{const Ce=ie.reduce((ms,ye)=>ms+Number(ye["Add To Cart (ATC)"]||0),0),Ee=ie.reduce((ms,ye)=>ms+Number(ye["Checkout Initiate (CI)"]||0),0),Ge=ie.reduce((ms,ye)=>ms+Number(ye["Landing Page View"]||0),0),$e=ie.reduce((ms,ye)=>ms+Number(ye["Link Click"]||0),0);return $e===0?0:(Ce+Ee+Ge)/$e*100},HookRate:(he,ie)=>{const Ce=ie.reduce(($e,ze)=>$e+Number(ze["Three Seconds View"]||0),0),Ee=ie.reduce(($e,ze)=>$e+Number(ze.Impressions||0),0);return Ee===0?0:Ce/Ee*100},DEFAULT:(he,ie)=>he.reduce((Ce,Ee)=>Ce+Ee,0)};return te.forEach(he=>{const ie=K.map(Ee=>Number(Ee[he]||0)).filter(Ee=>!isNaN(Ee)),Ce=oe[he]||oe.DEFAULT;ne[he]=Ce(ie,K).toFixed(2)}),ne},Be=()=>y?"max-h-[calc(100vh-100px)]":r;return e.jsx(Ds,{children:e.jsxs(le,{className:`overflow-hidden ${y?"fixed inset-0 z-50":""} border-slate-200 shadow-md`,children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border-b bg-gradient-to-r from-slate-50 to-white",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Qe,{height:"1rem",width:"1rem"}),e.jsxs("div",{className:"text-base font-semibold text-slate-800",children:["Campaign Performance ",e.jsxs("span",{children:["(",s.account_name,")"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(os,{children:[e.jsx(ls,{asChild:!0,children:e.jsx(D,{variant:"outline",onClick:()=>_(!L),size:"sm",className:"gap-1 font-medium",children:L?e.jsx(e.Fragment,{children:e.jsx(ta,{className:"h-4 w-4 text-blue-600"})}):e.jsx(e.Fragment,{children:e.jsx(ta,{className:"h-4 w-4 text-slate-500"})})})}),e.jsx(as,{children:L?"Disable Grouping":"Enable Grouping"})]}),e.jsxs(os,{children:[e.jsx(ls,{asChild:!0,children:e.jsx(D,{variant:"outline",onClick:()=>a(fa(!E)),size:"sm",className:"gap-1 font-medium",children:E?e.jsxs(e.Fragment,{children:[e.jsx(rs,{className:"h-4 w-4 text-red-500"}),e.jsx("span",{className:"hidden sm:inline",children:"Cancel"})]}):e.jsx(e.Fragment,{children:e.jsx(ot,{className:"h-4 w-4 text-slate-500"})})})}),e.jsx(as,{children:E?"Cancel Adding Label":"Add Label"})]}),e.jsxs(os,{children:[e.jsx(ls,{asChild:!0,children:e.jsx(D,{variant:"outline",size:"sm",onClick:me,className:"font-medium",children:y?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})}),e.jsx(as,{children:y?"Exit Fullscreen":"Enter Fullscreen"})]}),e.jsxs(os,{children:[e.jsx(ls,{asChild:!0,children:e.jsx("div",{children:e.jsx(yt,{visibleColumns:F,columnOrder:N,frozenColumns:I,onVisibilityChange:M,onOrderChange:u,onFrozenChange:i})})}),e.jsx(as,{children:"Manage Columns"})]})]})]}),e.jsxs("div",{className:"p-3",children:[E&&e.jsxs("div",{className:"mb-4 p-4 bg-white rounded-lg shadow-sm border border-slate-200 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsxs("div",{className:"relative flex-grow max-w-xs",children:[e.jsx(ot,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 h-4 w-4"}),e.jsx(De,{value:n,onChange:K=>l(K.target.value),placeholder:"Enter label name",className:"pl-9"})]}),e.jsxs(Is,{open:h,onOpenChange:d,children:[e.jsx(Fs,{asChild:!0,children:e.jsxs(D,{variant:"outline",className:"w-[180px] justify-between text-xs gap-1",size:"sm",children:[e.jsx(Hn,{className:"h-3.5 w-3.5 text-slate-500"}),o.length===0?"Select campaigns":`${o.length} selected`,e.jsx(is,{className:"h-3 w-3 opacity-50"})]})}),e.jsx(Cs,{className:"w-[280px] p-0",children:e.jsxs("div",{className:"p-2",children:[e.jsxs("div",{className:"relative mb-2",children:[e.jsx(Ws,{className:"absolute left-2.5 top-1/2 transform -translate-y-1/2 h-3.5 w-3.5 text-slate-400"}),e.jsx(De,{placeholder:"Search campaigns...",value:c,onChange:K=>p(K.target.value),className:"pl-8 text-xs"})]}),e.jsx("div",{className:"max-h-[200px] overflow-y-auto",children:Q.map(K=>e.jsxs("div",{className:"flex items-center space-x-2 p-1.5 hover:bg-slate-100 rounded",children:[e.jsx(ps,{checked:o.includes(K.campaignName),onCheckedChange:ne=>{m(ne?[...o,K.campaignName]:o.filter(te=>te!==K.campaignName))}}),e.jsx("span",{className:"text-xs",children:K.Campaign})]},K.Campaign))})]})})]}),e.jsxs(D,{onClick:J,disabled:!n||o.length===0,size:"sm",className:"gap-1",children:[e.jsx(ur,{className:"h-3.5 w-3.5"}),"Add Label"]})]}),o.length>0&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-slate-500",children:[e.jsx(Yn,{className:"h-3.5 w-3.5"}),o.length," campaign(s) selected"]})]}),e.jsx("div",{ref:Z,className:`overflow-auto ${Be()} bg-white rounded-lg border border-slate-200 shadow-sm`,children:e.jsxs("table",{className:"w-full border-collapse text-xs relative",children:[e.jsx("thead",{className:"bg-slate-50 sticky top-0 z-20",children:e.jsx("tr",{children:N.filter(K=>F.includes(K)).map((K,ne)=>{const te=I.includes(K),oe=te?`${O(ne)}px`:void 0,he=re(K);return e.jsx("th",{ref:ie=>k.current[K]=ie,className:`text-left p-2 font-medium text-slate-700 border-b border-r ${te?"sticky z-20 bg-slate-50":""} ${w===K?"bg-blue-50":""}`,style:{left:oe,...he},draggable:!0,onDragStart:()=>ee(K),onDragOver:ie=>de(ie,K),onDrop:()=>B(K),onDragEnd:q,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:K}),e.jsx(hr,{className:"h-3 w-3 text-slate-400 cursor-grab"})]})},K)})})}),e.jsxs("tbody",{children:[L&&T.map((K,ne)=>e.jsxs(Ze.Fragment,{children:[e.jsx("tr",{className:"bg-gradient-to-r from-slate-100 to-slate-50 font-medium hover:bg-slate-100 transition-colors",children:N.filter(te=>F.includes(te)).map((te,oe)=>{const he=I.includes(te),ie=he?`${O(oe)}px`:void 0,Ce=re(te),Ee=we(K.campaigns);return te==="Campaign"?e.jsx("td",{className:"p-2 border-r sticky z-10 bg-gradient-to-r from-slate-100 to-slate-50",style:{left:ie,...Ce},children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>Ne(ne),className:"mr-2 focus:outline-none rounded-full p-0.5 hover:bg-slate-200 transition-colors",children:K.isExpanded?e.jsx(is,{className:"h-4 w-4 text-slate-600"}):e.jsx(xs,{className:"h-4 w-4 text-slate-600"})}),e.jsxs("span",{className:"font-medium text-slate-700",children:["Group: ",K.campaigns.length," campaigns"]})]})},te):te==="Labels"?e.jsx("td",{className:`p-2 border-r ${he?"sticky z-10 bg-gradient-to-r from-slate-100 to-slate-50":"bg-gradient-to-r from-slate-100 to-slate-50"}`,style:{left:ie,...Ce},children:e.jsx(Vs,{className:`${W.get(K.label)} w-fit flex items-center gap-1 cursor-default text-xs py-0.5 px-2 rounded-md`,children:K.label})},te):e.jsx("td",{className:`p-2 border-r ${he?"sticky z-10 bg-gradient-to-r from-slate-100 to-slate-50":"bg-gradient-to-r from-slate-100 to-slate-50"} font-semibold`,style:{left:ie,...Ce},children:e.jsx("div",{children:Ee[te]})},te)})}),K.isExpanded&&K.campaigns.map(te=>e.jsx("tr",{className:`border-b hover:bg-slate-50 transition-colors ${S===te.campaignName?"bg-blue-50":""}`,draggable:!0,onDragStart:()=>xe(te.campaignName),onDragOver:oe=>U(oe,te.campaignName),onDrop:()=>G(te.campaignName),onDragEnd:X,children:N.filter(oe=>F.includes(oe)).map((oe,he)=>{var Ge;const ie=I.includes(oe),Ce=ie?`${O(he)}px`:void 0,Ee=re(oe);return oe==="Campaign"?e.jsx("td",{className:"p-2 border-r sticky bg-white  z-10 ",style:{left:Ce,paddingLeft:"30px",...Ee},children:e.jsx("div",{children:te.Campaign})},oe):oe==="Labels"?e.jsx("td",{className:`p-2 border-r ${ie?"sticky z-10 bg-white":""}`,style:{left:Ce,...Ee},children:e.jsx("div",{className:"flex flex-wrap gap-1",children:(Ge=R[te.Campaign])==null?void 0:Ge.map($e=>e.jsxs(Vs,{className:`${W.get($e)} flex items-center gap-1 cursor-default text-xs py-0 px-1.5 rounded-md`,children:[$e,e.jsx(rs,{className:"h-2.5 w-2.5 cursor-pointer hover:opacity-75",onClick:()=>se(te.campaignName,$e)})]},$e))})},oe):e.jsx("td",{className:`p-2 border-r ${ie?"sticky z-10 bg-white":""}`,style:{left:Ce,...Ee},children:e.jsx("div",{children:te[oe]})},oe)})},`${K.label}-${te.campaignName}`))]},`group-${K.label}`)),L&&P.length>0&&e.jsx("tr",{className:"bg-gradient-to-r from-gray-100 to-gray-50 font-medium hover:bg-gray-100 transition-colors",children:N.filter(K=>F.includes(K)).map((K,ne)=>{const te=I.includes(K),oe=te?`${O(ne)}px`:void 0,he=re(K);if(K==="Campaign")return e.jsx("td",{className:"p-2 border-r sticky z-10 bg-gradient-to-r from-gray-100 to-gray-50",style:{left:oe,...he},children:e.jsxs("div",{className:"font-medium text-slate-700 flex items-center",children:[e.jsx(ks,{className:"h-4 w-4 mr-2 text-slate-500"}),"Unlabeled: ",P.length," campaigns"]})},K);if(K==="Labels")return e.jsx("td",{className:`p-2 border-r ${te?"sticky z-10 bg-gradient-to-r from-gray-100 to-gray-50":"bg-gradient-to-r from-gray-100 to-gray-50"}`,style:{left:oe,...he},children:e.jsx("span",{className:"text-slate-400 italic",children:"-"})},K);const ie=we(P);return e.jsx("td",{className:`p-2 border-r ${te?"sticky z-10 bg-gradient-to-r from-gray-100 to-gray-50":"bg-gradient-to-r from-gray-100 to-gray-50"} font-semibold`,style:{left:oe,...he},children:e.jsx("div",{children:ie[K]})},K)})}),(L?P:s.campaigns).map(K=>e.jsx("tr",{className:`border-b hover:bg-slate-50 transition-colors ${S===K.campaignName?"bg-blue-50":""}`,draggable:!0,onDragStart:()=>xe(K.campaignName),onDragOver:ne=>U(ne,K.campaignName),onDrop:()=>G(K.campaignName),onDragEnd:X,children:N.filter(ne=>F.includes(ne)).map((ne,te)=>{var Ce,Ee;const oe=I.includes(ne),he=oe?`${O(te)}px`:void 0,ie=re(ne);return ne==="Campaign"?e.jsx("td",{className:"p-2 border-r sticky z-10",style:{left:he,backgroundColor:"white",...ie},children:e.jsx("div",{className:"font-medium text-slate-700",children:K.Campaign})},ne):ne==="Labels"?e.jsx("td",{className:`p-2 border-r ${oe?"sticky z-10":""}`,style:{left:he,backgroundColor:oe?"white":void 0,...ie},children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[(Ce=R[K.Campaign])==null?void 0:Ce.map(Ge=>e.jsxs(Vs,{className:`${W.get(Ge)} flex items-center gap-1 cursor-default text-xs py-0 px-1.5 rounded-md`,children:[Ge,e.jsx(rs,{className:"h-2.5 w-2.5 cursor-pointer hover:opacity-75",onClick:()=>se(K.campaignName,Ge)})]},Ge)),!((Ee=R[K.Campaign])!=null&&Ee.length)&&e.jsx("span",{className:"text-slate-400 italic text-xs",children:"-"})]})},ne):e.jsx("td",{className:`p-2 border-r ${oe?"sticky z-10":""}`,style:{left:he,backgroundColor:oe?"white":void 0,...ie},children:e.jsx("div",{children:K[ne]})},ne)})},K.Campaign))]})]})})]})]})})},ja="85px",Il=({data:s,height:r})=>{const[a,n]=t.useState(null),[l,o]=t.useState(null),[m,h]=t.useState(!1),[d,c]=t.useState(null),[p,C]=t.useState(null),[x,S]=t.useState(["Interest","Spend","Revenue","Roas"]),[A,y]=t.useState(["Interest","Spend","Revenue","Roas"]),[b,$]=t.useState(["Interest"]),v=t.useRef(null),w=t.useRef({}),g=k=>{let j=0;const E=A.filter(R=>x.includes(R));for(let R=0;R<k;R++){const Y=E[R];if(b.includes(Y)){const W=w.current[Y];W&&(j+=W.offsetWidth)}}return j},F=k=>k==="Interest"?{width:"auto",minWidth:"200px"}:{width:ja,minWidth:ja},M=k=>{n(k)},N=(k,j)=>{k.preventDefault(),j!==a&&o(j)},u=k=>{!a||a===k||(n(null),o(null),console.log(`Dragged ${a} and dropped on ${k}`))},I=()=>{n(null),o(null)},i=k=>{c(k)},L=(k,j)=>{k.preventDefault(),j!==d&&C(j)},_=k=>{if(!d||d===k)return;const j=A.indexOf(d),E=A.indexOf(k);if(j!==-1&&E!==-1){const R=[...A];R.splice(j,1),R.splice(E,0,d),y(R)}c(null),C(null)},T=()=>{c(null),C(null)},f=()=>{h(!m)},P=()=>m?"max-h-[calc(100vh-100px)]":r,V=k=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:2}).format(k),Z=k=>k.toFixed(2)+"x";return e.jsx(Ds,{children:e.jsxs(le,{className:`overflow-hidden ${m?"fixed inset-0 z-50":""} border-slate-200 shadow-md`,children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border-b bg-gradient-to-r from-slate-50 to-white",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Qe,{height:"1rem",width:"1rem"}),e.jsxs("div",{className:"text-base font-semibold text-slate-800",children:["Interest Performance ",e.jsxs("span",{children:["(",s.account_name,")"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(os,{children:[e.jsx(ls,{asChild:!0,children:e.jsx(D,{variant:"outline",size:"sm",onClick:f,className:"font-medium",children:m?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})}),e.jsx(as,{children:m?"Exit Fullscreen":"Enter Fullscreen"})]}),e.jsxs(os,{children:[e.jsx(ls,{asChild:!0,children:e.jsx("div",{children:e.jsx(yt,{visibleColumns:x,columnOrder:A,frozenColumns:b,onVisibilityChange:S,onOrderChange:y,onFrozenChange:$})})}),e.jsx(as,{children:"Manage Columns"})]})]})]}),e.jsx("div",{className:"p-3",children:e.jsx("div",{ref:v,className:`overflow-auto ${P()} bg-white rounded-lg border border-slate-200 shadow-sm`,children:e.jsxs("table",{className:"w-full border-collapse text-xs relative",children:[e.jsx("thead",{className:"bg-slate-50 sticky top-0 z-20",children:e.jsx("tr",{children:A.filter(k=>x.includes(k)).map((k,j)=>{const E=b.includes(k),R=E?`${g(j)}px`:void 0,Y=F(k);return e.jsx("th",{ref:W=>w.current[k]=W,className:`text-left p-2 font-medium text-slate-700 border-b border-r ${E?"sticky z-20 bg-slate-50":""} ${p===k?"bg-blue-50":""}`,style:{left:R,...Y},draggable:!0,onDragStart:()=>i(k),onDragOver:W=>L(W,k),onDrop:()=>_(k),onDragEnd:T,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:k}),e.jsx(hr,{className:"h-3 w-3 text-slate-400 cursor-grab"})]})},k)})})}),e.jsx("tbody",{children:s.interest.map((k,j)=>e.jsx("tr",{className:`border-b hover:bg-slate-50 transition-colors ${l===k.Interest?"bg-blue-50":""}`,draggable:!0,onDragStart:()=>M(k.InterestId.toString()),onDragOver:E=>N(E,k.InterestId.toString()),onDrop:()=>u(k.InterestId.toString()),onDragEnd:I,children:A.filter(E=>x.includes(E)).map((E,R)=>{const Y=b.includes(E),W=Y?`${g(R)}px`:void 0,O=F(E);let J=k[E];return E==="Spend"||E==="Revenue"?J=V(Number(k[E])):E==="Roas"&&(J=Z(Number(k[E]))),e.jsx("td",{className:`p-2 border-b border-r text-slate-700 ${Y?"sticky z-10 bg-inherit":""}`,style:{left:W,...O},children:J},`${k.InterestId}-${E}`)})},k.InterestId.toString()))})]})})})]})})};function Fl(){var T,f,P,V,Z,k,j,E;const[s,r]=t.useState(!1),[a,n]=t.useState([]),[l,o]=t.useState(),[m,h]=t.useState("all"),[d,c]=t.useState("all"),[p,C]=t.useState("en-IN"),[x,S]=t.useState({totalSpent:0,totalRevenue:0,totalROAS:0,totalPurchases:0,totalCTR:0,totalCPC:0,totalCPM:0,totalCPP:0}),{brandId:A}=ge(),y=fs(),b=[{label:"All Data",value:"all"},{label:"Meta",value:"facebook"},{label:"Google",value:"google"}],$=z(R=>R.date.from),v=z(R=>R.date.to),w=t.useMemo(()=>({from:$,to:v}),[$,v]),g=R=>{const Y=b.find(W=>W.value===R);Y&&Y.value!==d&&(h(Y.value),c(Y.value))},F=z(R=>R.user.user),M=F==null?void 0:F.id,N=t.useCallback(async()=>{var R,Y;r(!0);try{const W="https://parallels.messold.com",O=w!=null&&w.from?H(w.from,"yyyy-MM-dd"):"",J=w!=null&&w.to?H(w.to,"yyyy-MM-dd"):"";let se=[],Q=[];if(d==="all"||d==="facebook")try{se=(await ve.post(`${W}/api/metrics/fbAdAndCampaign/${A}`,{startDate:O,endDate:J,userId:M},{withCredentials:!0})).data.data,console.log("fbdata",se),n(se)}catch(re){console.error("Error fetching Facebook ad data:",re)}if(d==="all"||d==="google")try{Q=((R=(await ve.post(`${W}/api/metrics/googleAdAndCampaign/${A}`,{startDate:O,endDate:J,userId:M},{withCredentials:!0})).data)==null?void 0:R.data)||[],console.log(Q),o(Q)}catch(re){console.error("Error fetching Google ad data:",re)}I(d==="google"?[]:se,d==="facebook"?void 0:Q)}catch(W){console.error("Error fetching ad data:",W),ve.isAxiosError(W)&&((Y=W.response)==null?void 0:Y.status)===401&&(alert("Your session has expired. Please log in again."),y("/"))}finally{r(!1)}},[y,w,d,A,M]);t.useEffect(()=>{N()},[N]),t.useEffect(()=>{N();const R=setInterval(N,3*60*60*1e3);return()=>clearInterval(R)},[N]);let u="";a&&a.length>1?u="max-h-[calc(100vh-400px)]":u="max-h-[calc(100vh-210px)]";const I=t.useCallback((R,Y)=>{let W=0,O=0,J=0,se=0,Q=0;R!=null&&R.length&&R.forEach(re=>{var xe,U;W+=parseFloat(String(re.spend||"0")),O+=parseFloat(String(((xe=re.Revenue)==null?void 0:xe.value)||"0")),J+=parseFloat(String(((U=re.purchases)==null?void 0:U.value)||"0")),se+=parseFloat(String(re.clicks||"0")),Q+=parseFloat(String(re.impressions||"0"))}),Y!=null&&Y.adMetrics&&(W+=parseFloat(Y.adMetrics.totalSpend||"0"),O+=parseFloat(Y.adMetrics.totalConversionsValue||"0"),J+=parseFloat(Y.adMetrics.totalConversions||"0"),se+=parseFloat(Y.adMetrics.totalClicks||"0"),Q+=parseFloat(Y.adMetrics.totalImpressions||"0")),S({totalSpent:W,totalRevenue:O,totalROAS:O/W||0,totalPurchases:J,totalCTR:se/Q*100||0,totalCPC:W/se||0,totalCPM:W*1e3/Q||0,totalCPP:J>0?W/J:0})},[]),i=t.useMemo(()=>({totalSpent:`₹ ${x.totalSpent.toLocaleString(p)}`,totalRevenue:`₹ ${x.totalRevenue.toLocaleString(p)}`,totalROAS:Number(x.totalROAS.toFixed(2)).toLocaleString(p),totalPurchases:x.totalPurchases.toLocaleString(p),totalCTR:`${Number(x.totalCTR.toFixed(2)).toLocaleString(p)} %`,totalCPC:Number(x.totalCPC.toFixed(2)).toLocaleString(p),totalCPM:Number(x.totalCPM.toFixed(2)).toLocaleString(p),totalCPP:Number(x.totalCPP.toFixed(2)).toLocaleString(p)}),[x,p]),L=[{label:"Amount Spent",value:i.totalSpent,tooltipContent:"The sum of ad spends for all advertising platforms"},{label:"Revenue",value:i.totalRevenue,tooltipContent:"Revenue from Ads Purchases"},{label:"ROAS (Ads only)",value:i.totalROAS,tooltipContent:"Blended ROAS = Ads Purchases value / Blended Ad Spend"},{label:"Ads Purchases",value:i.totalPurchases,tooltipContent:"Ads Purchases = Fb Ads Purchase + Google Conversions"},{label:"CPC",value:i.totalCPC,tooltipContent:"Average CPC from all advertising platforms = (Blended Ad Spend / Blended Clicks)"},{label:"CTR",value:i.totalCTR,tooltipContent:"Average CTR from all advertising platforms = (Blended Clicks / Blended Impressions)*100"},{label:"CPM",value:i.totalCPM,tooltipContent:"Average CPM from all advertising platforms = (Blended Ad Spend * 1000 / Blended Impressions)"},{label:"CPP",value:i.totalCPP,tooltipContent:"Average CPP from all advertising platforms = (Blended Ad Spend / Blended Purchases)"}],_=[{label:"Total Cost",value:l?`₹ ${parseFloat(((T=l==null?void 0:l.adMetrics)==null?void 0:T.totalSpend)||"0").toLocaleString(p)}`:"₹ 0"},{label:"Conversion Value",value:l?`₹ ${parseFloat((f=l==null?void 0:l.adMetrics)==null?void 0:f.totalConversionsValue).toLocaleString(p)}`:" 0"},{label:"ROAS",value:l?parseFloat((P=l==null?void 0:l.adMetrics)==null?void 0:P.roas).toLocaleString(p):"0.00"},{label:"Conversions",value:l?parseFloat((V=l==null?void 0:l.adMetrics)==null?void 0:V.totalConversions).toLocaleString(p):"0"},{label:"CPC",value:l?`₹ ${parseFloat((Z=l==null?void 0:l.adMetrics)==null?void 0:Z.totalCPC).toLocaleString(p)}`:" 0"},{label:"CPM",value:l?`₹ ${parseFloat((k=l==null?void 0:l.adMetrics)==null?void 0:k.totalCPM).toLocaleString(p)}`:" 0"},{label:"CTR",value:l?`${parseFloat((j=l==null?void 0:l.adMetrics)==null?void 0:j.totalCTR).toLocaleString(p)} %`:" 0"},{label:"Cost Per Conversion",value:l?`₹ ${parseFloat((E=l==null?void 0:l.adMetrics)==null?void 0:E.totalCostPerConversion).toLocaleString(p)}`:" 0"}];return e.jsxs("div",{className:"min-h-screen bg-gray-100",children:[e.jsx(js,{title:"AdMetrics Dashboard",Icon:Rs,showDatePicker:!0,showSettings:!0,showRefresh:!0,isLoading:!1,handleManualRefresh:()=>{N()},locale:p,setLocale:C}),e.jsx("div",{className:"bg-white px-6 sticky top-0 z-10",children:e.jsx(zs,{tabs:b,activeTab:m,onTabChange:g})}),e.jsxs("main",{className:"p-4 md:p-6 lg:px-8",children:[e.jsx("div",{className:"space-y-2",children:e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold flex flex-row items-center justify-between",children:e.jsxs("div",{className:"flex flex-row items-center space-x-2",children:[e.jsx(Rt,{className:"h-5 w-5"}),e.jsx("span",{children:"Blended summary"}),(d==="all"||d==="facebook")&&e.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"#1877F2",children:e.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),(d==="all"||d==="google")&&e.jsxs("svg",{viewBox:"0 0 24 24",className:"w-5 h-5",children:[e.jsx("path",{d:"M13.5437 4.24116L13.5441 4.24138C13.904 4.43971 14.2179 4.70303 14.4689 5.01529C14.7198 5.3275 14.903 5.68264 15.009 6.0601L15.4904 5.92486L15.009 6.0601C15.115 6.43752 15.1422 6.83078 15.0891 7.21776C15.0361 7.60457 14.9038 7.97861 14.6989 8.31855C14.6988 8.31873 14.6987 8.31891 14.6986 8.3191L8.41444 18.701C7.9918 19.3741 7.30557 19.868 6.49825 20.0687C5.68937 20.2699 4.83087 20.1586 4.10949 19.7614C3.38872 19.3646 2.86649 18.7168 2.64727 17.9633C2.42868 17.212 2.5264 16.4083 2.92214 15.7226L9.20689 5.33823C9.20695 5.33813 9.20702 5.33802 9.20708 5.33792C9.62451 4.65082 10.3142 4.14383 11.1301 3.93599C11.9464 3.72804 12.8151 3.83872 13.5437 4.24116Z",fill:"#FFB70A",stroke:"#FFB70A"}),e.jsx("path",{d:"M21.5404 15.4544L15.24 5.04127C14.7453 4.25097 13.9459 3.67817 13.0138 3.44633C12.0817 3.21448 11.0917 3.34215 10.2572 3.80182C9.4226 4.26149 8.8103 5.01636 8.55224 5.90372C8.29418 6.79108 8.41102 7.73988 8.87757 8.54562L15.178 18.9587C15.6726 19.749 16.4721 20.3218 17.4042 20.5537C18.3362 20.7855 19.3262 20.6579 20.1608 20.1982C20.9953 19.7385 21.6076 18.9836 21.8657 18.0963C22.1238 17.2089 22.0069 16.2601 21.5404 15.4544Z",fill:"#3B8AD8"}),e.jsx("path",{d:"M9.23018 16.2447C9.07335 15.6884 8.77505 15.1775 8.36166 14.7572C7.94827 14.3369 7.43255 14.0202 6.86011 13.835C6.28768 13.6499 5.67618 13.6021 5.07973 13.6958C4.48328 13.7895 3.92026 14.0219 3.44049 14.3723C2.96071 14.7227 2.57898 15.1804 2.32906 15.7049C2.07914 16.2294 1.96873 16.8045 2.00762 17.3794C2.0465 17.9542 2.23347 18.5111 2.55199 19.0007C2.8705 19.4902 3.31074 19.8975 3.83376 20.1863C4.46363 20.5354 5.1882 20.6983 5.91542 20.6542C6.64264 20.6101 7.33969 20.361 7.91802 19.9386C8.49636 19.5162 8.92988 18.9395 9.16351 18.2817C9.39715 17.624 9.42035 16.915 9.23018 16.2447Z",fill:"#2CAA14"})]})]})}),e.jsx(Bs,{metrics:L,date:{from:w.from?new Date(w.from):void 0,to:w.to?new Date(w.to):void 0},isLoading:s,icon:d==="all"?"":d==="facebook"?"Facebook":"Google"})]})}),(d==="all"||d==="facebook")&&(a==null?void 0:a.length)>0&&a.map((R,Y)=>{var O,J;const W=[{label:"Amount Spent",value:`₹ ${parseFloat(String(R.spend||"0")).toLocaleString(p)}`},{label:"Revenue",value:`₹ ${parseFloat(String(((O=R.Revenue)==null?void 0:O.value)||"0")).toLocaleString(p)}`},{label:"ROAS (Ads only)",value:R.purchase_roas&&R.purchase_roas.length>0?parseFloat(String(R.purchase_roas[0].value)).toFixed(2):"0"},{label:"Ads Purchases",value:((J=R.purchases)==null?void 0:J.value)||"0"},{label:"CPC (All clicks)",value:`₹ ${new Intl.NumberFormat(p).format(parseFloat(R.cpc||"0"))}`},{label:"CPM",value:`₹ ${new Intl.NumberFormat(p,{minimumFractionDigits:2}).format(parseFloat(R.cpm||"0"))}`},{label:"CTR",value:`${parseFloat(R.ctr||"0").toFixed(2)} %`},{label:"Cost per Purchase (All)",value:`₹ ${new Intl.NumberFormat(p).format(parseFloat(R.cpp||"0"))}`}];return e.jsxs(e.Fragment,{children:[e.jsx(Bs,{icon:"Facebook",title:`Facebook - ${R.account_name}`,metrics:W,date:{from:w.from?new Date(w.from):void 0,to:w.to?new Date(w.to):void 0},isLoading:s,errorMessage:R.message},Y),e.jsx("div",{className:"mt-6",children:e.jsx(Or,{data:{account_name:R.account_name,account_id:R.adAccountId,campaigns:R.campaigns},height:u})}),e.jsx("div",{className:"mt-6",children:e.jsx(Il,{data:{account_name:R.account_name,account_id:R.adAccountId,interest:R.interestMetrics},height:u})})]})}),(d==="all"||d==="google")&&(l&&Object.keys(l).length>0?e.jsxs(e.Fragment,{children:[e.jsx(Bs,{icon:"Google",title:`Google Ads - ${l==null?void 0:l.adAccountName}`,metrics:_,date:{from:w.from?new Date(w.from):void 0,to:w.to?new Date(w.to):void 0},isLoading:s}),e.jsx(rl,{campaigns:l.campaignData||[],isLoading:s,icon:"Google"})]}):e.jsxs("section",{children:[e.jsxs("div",{className:"flex flex-row gap-2 items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Google Ad Metrics"}),e.jsxs("svg",{viewBox:"0 0 24 24",className:"w-5 h-5",children:[e.jsx("path",{d:"M13.5437 4.24116L13.5441 4.24138C13.904 4.43971 14.2179 4.70303 14.4689 5.01529C14.7198 5.3275 14.903 5.68264 15.009 6.0601L15.4904 5.92486L15.009 6.0601C15.115 6.43752 15.1422 6.83078 15.0891 7.21776C15.0361 7.60457 14.9038 7.97861 14.6989 8.31855C14.6988 8.31873 14.6987 8.31891 14.6986 8.3191L8.41444 18.701C7.9918 19.3741 7.30557 19.868 6.49825 20.0687C5.68937 20.2699 4.83087 20.1586 4.10949 19.7614C3.38872 19.3646 2.86649 18.7168 2.64727 17.9633C2.42868 17.212 2.5264 16.4083 2.92214 15.7226L9.20689 5.33823C9.20695 5.33813 9.20702 5.33802 9.20708 5.33792C9.62451 4.65082 10.3142 4.14383 11.1301 3.93599C11.9464 3.72804 12.8151 3.83872 13.5437 4.24116Z",fill:"#FFB70A",stroke:"#FFB70A"}),e.jsx("path",{d:"M21.5404 15.4544L15.24 5.04127C14.7453 4.25097 13.9459 3.67817 13.0138 3.44633C12.0817 3.21448 11.0917 3.34215 10.2572 3.80182C9.4226 4.26149 8.8103 5.01636 8.55224 5.90372C8.29418 6.79108 8.41102 7.73988 8.87757 8.54562L15.178 18.9587C15.6726 19.749 16.4721 20.3218 17.4042 20.5537C18.3362 20.7855 19.3262 20.6579 20.1608 20.1982C20.9953 19.7385 21.6076 18.9836 21.8657 18.0963C22.1238 17.2089 22.0069 16.2601 21.5404 15.4544Z",fill:"#3B8AD8"}),e.jsx("path",{d:"M9.23018 16.2447C9.07335 15.6884 8.77505 15.1775 8.36166 14.7572C7.94827 14.3369 7.43255 14.0202 6.86011 13.835C6.28768 13.6499 5.67618 13.6021 5.07973 13.6958C4.48328 13.7895 3.92026 14.0219 3.44049 14.3723C2.96071 14.7227 2.57898 15.1804 2.32906 15.7049C2.07914 16.2294 1.96873 16.8045 2.00762 17.3794C2.0465 17.9542 2.23347 18.5111 2.55199 19.0007C2.8705 19.4902 3.31074 19.8975 3.83376 20.1863C4.46363 20.5354 5.1882 20.6983 5.91542 20.6542C6.64264 20.6101 7.33969 20.361 7.91802 19.9386C8.49636 19.5162 8.92988 18.9395 9.16351 18.2817C9.39715 17.624 9.42035 16.915 9.23018 16.2447Z",fill:"#2CAA14"})]})]}),e.jsx("div",{className:"text-center text-gray-500 mt-4 bg-white p-2",children:"No Google Ad Account for this brand."})]}))]})]})}const va="https://parallels.messold.com";function $l(){return e.jsx(le,{className:"p-6 space-y-4",children:e.jsxs(ce,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Oe,{className:"h-4 w-32"}),e.jsx(Oe,{className:"h-10 w-full"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Oe,{className:"h-4 w-32"}),e.jsx(Oe,{className:"h-10 w-full"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Oe,{className:"h-4 w-32"}),e.jsx(Oe,{className:"h-10 w-full"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Oe,{className:"h-4 w-32"}),e.jsx(Oe,{className:"h-24 w-full"})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(Oe,{className:"h-10 w-24"}),e.jsx(Oe,{className:"h-10 w-24"})]})]})})}function Pl({onClose:s}){const[r,a]=t.useState({subject:"",description:"",departmentId:"",brand:"",firstName:"",lastName:"",email:""}),[n,l]=t.useState([]),[o,m]=t.useState(!1),[h,d]=t.useState(!1),[c,p]=t.useState({});t.useEffect(()=>{(async()=>{m(!0);try{const y=await ve.get(`${va}/api/zoho/departments`,{withCredentials:!0});y.data&&y.data.departments&&l(y.data.departments)}catch(y){console.error("Error fetching departments:",y)}finally{m(!1)}})()},[]);const C=A=>{const{name:y,value:b}=A.target;a($=>({...$,[y]:b})),c[y]&&p($=>{const v={...$};return delete v[y],v})},x=()=>{const A={};return r.subject.trim()||(A.subject="Subject is required"),r.brand.trim()||(A.brand="Brand name is required"),r.departmentId||(A.departmentId="Please select a department"),r.description.trim()||(A.description="Description is required"),r.firstName.trim()||(A.firstName="First Name is required"),r.email.trim()?/\S+@\S+\.\S+/.test(r.email)||(A.email="Please enter a valid email address"):A.email="Email is required",p(A),Object.keys(A).length===0},S=async A=>{if(A.preventDefault(),!!x()){d(!0);try{(await ve.post(`${va}/api/zoho/create-ticket`,r,{withCredentials:!0})).data.success&&s()}catch(y){console.error("Error submitting ticket:",y),p({form:"There was an error submitting your ticket. Please try again."})}finally{d(!1)}}};return o?e.jsx($l,{}):e.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-slate-800 px-6 py-4 flex justify-between items-center",children:[e.jsxs("h2",{className:"text-xl font-semibold text-white flex items-center",children:[e.jsx(aa,{className:"mr-2 h-5 w-5"}),"Submit a Support Ticket"]}),e.jsx("button",{onClick:s,className:"text-slate-300 hover:text-white transition-colors",children:e.jsx(rs,{className:"h-6 w-6"})})]}),c.form&&e.jsxs("div",{className:"mx-6 mt-4 p-3 bg-red-50 border border-red-200 rounded-md flex items-start",children:[e.jsx(Gt,{className:"h-5 w-5 text-red-500 mr-2 flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-red-700 text-sm",children:c.form})]}),e.jsxs("form",{onSubmit:S,className:"p-6 space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",htmlFor:"subject",children:["Subject ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(aa,{className:"h-5 w-5 text-slate-400"})}),e.jsx("input",{id:"subject",name:"subject",type:"text",value:r.subject,onChange:C,className:`pl-10 block w-full px-3 py-2.5 border ${c.subject?"border-red-300 bg-red-50":"border-slate-300"} rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-500 focus:border-slate-500`,placeholder:"Brief description of your issue"})]}),c.subject&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.subject})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",htmlFor:"brand",children:["Brand Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Wn,{className:"h-5 w-5 text-slate-400"})}),e.jsx("input",{id:"brand",name:"brand",type:"text",value:r.brand,onChange:C,className:`pl-10 block w-full px-3 py-2.5 border ${c.brand?"border-red-300 bg-red-50":"border-slate-300"} rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-500 focus:border-slate-500`,placeholder:"Your brand name"})]}),c.brand&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.brand})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",htmlFor:"departmentId",children:["Department ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Kn,{className:"h-5 w-5 text-slate-400"})}),e.jsxs("select",{id:"departmentId",name:"departmentId",value:r.departmentId,onChange:C,className:`pl-10 block w-full px-3 py-2.5 border ${c.departmentId?"border-red-300 bg-red-50":"border-slate-300"} rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-500 focus:border-slate-500 appearance-none bg-no-repeat bg-right`,style:{backgroundImage:`url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' strokeLinecap='round' strokeLinejoin='round' strokeWidth='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e")`,backgroundPosition:"right 0.5rem center",backgroundSize:"1.5em 1.5em"},children:[e.jsx("option",{value:"",children:"Select an issue type"}),n.map(A=>e.jsx("option",{value:A==null?void 0:A.id,children:A.name},A.id))]})]}),c.departmentId&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.departmentId})]})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",htmlFor:"firstName",children:["First Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(lr,{className:"h-5 w-5 text-slate-400"})}),e.jsx("input",{id:"firstName",name:"firstName",type:"text",value:r.firstName,onChange:C,className:"pl-10 block w-full px-3 py-2.5 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-500 focus:border-slate-500",placeholder:"First name"})]}),c.firstName&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.firstName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",htmlFor:"lastName",children:"Last Name"}),e.jsx("input",{id:"lastName",name:"lastName",type:"text",value:r.lastName,onChange:C,className:"block w-full px-3 py-2.5 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-500 focus:border-slate-500",placeholder:"Last name"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",htmlFor:"email",children:["Email Address ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Ys,{className:"h-5 w-5 text-slate-400"})}),e.jsx("input",{id:"email",name:"email",type:"email",value:r.email,onChange:C,className:`pl-10 block w-full px-3 py-2.5 border ${c.email?"border-red-300 bg-red-50":"border-slate-300"} rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-500 focus:border-slate-500`,placeholder:"your.email@example.com"})]}),c.email&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.email}),e.jsx("div",{className:"h-full flex items-end",children:e.jsx("div",{className:"text-xs text-slate-500 italic",children:"We'll use this email to contact you about your ticket"})})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-1",htmlFor:"description",children:["Description ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{id:"description",name:"description",value:r.description,onChange:C,rows:5,className:`block w-full px-3 py-2.5 border ${c.description?"border-red-300 bg-red-50":"border-slate-300"} rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-slate-500 focus:border-slate-500`,placeholder:"Please provide detailed information about your issue to help us assist you better"}),c.description&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.description})]}),e.jsxs("div",{className:"flex gap-4 pt-2",children:[e.jsx("button",{type:"submit",disabled:h,className:`flex-1 bg-slate-700 text-white py-2.5 px-4 rounded-md hover:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-slate-500 focus:ring-offset-2 transition-colors ${h?"opacity-70 cursor-not-allowed":""}`,children:h?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx(Qn,{className:"w-5 h-5 animate-spin"}),"Submitting..."]}):e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx(Zn,{className:"w-4 h-4"}),"Submit Ticket"]})}),e.jsx("button",{type:"button",onClick:s,className:"flex-1 bg-white text-slate-700 py-2.5 px-4 border border-slate-300 rounded-md hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-slate-500 focus:ring-offset-2 transition-colors",children:"Cancel"})]})]})]})}const gs=()=>{const[s,r]=t.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>r(!0),className:"fixed bottom-8 right-8 z-30 flex items-center gap-2 bg-indigo-600 text-white p-3 rounded-full shadow-lg hover:bg-indigo-700 transition-colors duration-200 group",children:e.jsx(Tn,{className:"w-5 h-5 group-hover:animate-pulse"})}),s&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:e.jsx(Pl,{onClose:()=>r(!1)})})})]})},Ll=()=>e.jsxs("div",{className:"flex h-screen",children:[e.jsx(ts,{}),e.jsxs("div",{className:"flex-1 h-screen overflow-auto",children:[e.jsx(Fl,{}),e.jsx(gs,{})]})]}),Dr=Da,El=za,Rl=Oa,zr=t.forwardRef(({className:s,...r},a)=>e.jsx(ht,{ref:a,className:ae("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...r}));zr.displayName=ht.displayName;const Qt=t.forwardRef(({className:s,children:r,...a},n)=>e.jsxs(Rl,{children:[e.jsx(zr,{}),e.jsxs(xt,{ref:n,className:ae("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...a,children:[r,e.jsxs(Ra,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Pt,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Qt.displayName=xt.displayName;const Zt=({className:s,...r})=>e.jsx("div",{className:ae("flex flex-col space-y-1.5 text-center sm:text-left",s),...r});Zt.displayName="DialogHeader";const qt=t.forwardRef(({className:s,...r},a)=>e.jsx(ft,{ref:a,className:ae("text-lg font-semibold leading-none tracking-tight",s),...r}));qt.displayName=ft.displayName;const Gr=t.forwardRef(({className:s,...r},a)=>e.jsx(gt,{ref:a,className:ae("text-sm text-muted-foreground",s),...r}));Gr.displayName=gt.displayName;function Ol(){const[s,r]=t.useState(""),a="https://parallels.messold.com",n=async()=>{try{const l=await ve.post(`${a}/api/auth/shopify`,{shop:s},{withCredentials:!0});if(l.data.success){const{authUrl:o}=l.data;console.log("Generated Shopify Auth URL:",o),window.location.href=o}else console.error("Failed to get Shopify Auth URL")}catch(l){console.error("Error getting Shopify Auth URL:",l)}};return e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsx(De,{type:"text",placeholder:"Enter your Shopify store name",value:s,onChange:l=>r(l.target.value)}),e.jsx(D,{className:"w-full",onClick:n,disabled:!s,children:"Login to Shopify"})]})}const Re=({width:s="1.25rem",height:r="1.25rem"})=>e.jsxs("svg",{viewBox:"0 0 24 24",style:{height:r,width:s},children:[e.jsx("rect",{x:"17",y:"2",width:"2rem",height:"2rem",rx:"2.5",fill:"#F9AB00"}),e.jsx("path",{d:"M9.5 13.5C9.5 12.1193 10.6193 11 12 11C13.3807 11 14.5 12.1193 14.5 13.5V19.5C14.5 20.8807 13.3807 22 12 22C10.6193 22 9.5 20.8807 9.5 19.5V13.5Z",fill:"#E37400"}),e.jsx("path",{d:"M2 19.5C2 18.1193 3.11929 17 4.5 17C5.88071 17 7 18.1193 7 19.5C7 20.8807 5.88071 22 4.5 22C3.11929 22 2 20.8807 2 19.5Z",fill:"#E37400"}),e.jsx("path",{d:"M6.92162 10C6.36184 10 5.95724 9.68838 5.95724 9.05977V8.55474H3.2304C2.49881 8.55474 2 8.1088 2 7.45332C2 7.07723 2.12193 6.70651 2.40459 6.22297C2.93666 5.29349 3.57403 4.31565 4.31116 3.23573C4.92637 2.31162 5.39747 2 6.20111 2C7.2209 2 7.88044 2.54265 7.88044 3.38617V7.02351H8.19082C8.72842 7.02351 9 7.34587 9 7.79181C9 8.23774 8.72288 8.55474 8.19082 8.55474H7.88044V9.05977C7.88044 9.68838 7.47585 10 6.92162 10ZM6.01267 7.09335V3.48287H5.97387C5.0095 4.8368 4.34996 5.83076 3.7015 7.03962V7.09335H6.01267Z",fill:"#E37400"})]}),_r=({width:s="1.25rem",height:r="1.25rem"})=>e.jsx("svg",{viewBox:"0 0 64 64",style:{height:r,width:s},xmlns:"http://www.w3.org/2000/svg",children:e.jsxs("g",{children:[e.jsx("g",{children:e.jsx("path",{d:"M51.759,12.659c-0.221-0.021-4.94-0.371-4.94-0.371s-3.28-3.271-3.639-3.631    c-0.36-0.362-1.063-0.254-1.337-0.171c-0.039,0.011-0.715,0.222-1.834,0.567c-1.096-3.167-3.027-6.077-6.426-6.077    c-0.094,0-0.191,0.004-0.289,0.01c-0.966-1.283-2.164-1.844-3.199-1.844c-7.919,0-11.703,9.951-12.889,15.008    c-3.078,0.956-5.266,1.638-5.542,1.728C9.943,18.42,9.89,18.474,9.667,20.1C9.495,21.331,5,56.264,5,56.264l35.022,6.594    L59,58.731c0,0-6.661-45.261-6.703-45.572C52.255,12.849,51.983,12.677,51.759,12.659z M33.034,10.88    c0,0.119-0.002,0.231-0.002,0.344c-1.928,0.601-4.02,1.251-6.121,1.906c1.179-4.57,3.387-6.78,5.32-7.613    C32.716,6.743,33.034,8.505,33.034,10.88z M29.876,3.278c0.346,0,0.688,0.116,1.018,0.345c-2.539,1.199-5.258,4.224-6.408,10.261    c-1.679,0.522-3.319,1.034-4.838,1.506C20.994,10.783,24.188,3.278,29.876,3.278z M31.241,30.19c0,0-2.05-1.099-4.561-1.099    c-3.686,0-3.872,2.324-3.872,2.908c0,3.195,8.287,4.42,8.287,11.903c0,5.888-3.714,9.678-8.726,9.678    c-6.012,0-9.088-3.761-9.088-3.761l1.609-5.345c0,0,3.16,2.729,5.83,2.729c1.74,0,2.449-1.38,2.449-2.387    c0-4.168-6.799-4.354-6.799-11.203c0-5.761,4.116-11.341,12.428-11.341c3.199,0,4.783,0.923,4.783,0.923L31.241,30.19z     M35.11,10.578c0-0.211,0.002-0.417,0.002-0.644c0-1.966-0.273-3.551-0.709-4.807c1.752,0.219,2.919,2.223,3.67,4.528    C37.194,9.931,36.194,10.241,35.11,10.578z",fill:"#95C675"})}),e.jsx("g",{children:e.jsx("path",{d:"M51.759,12.659c-0.221-0.021-4.94-0.371-4.94-0.371s-3.28-3.271-3.639-3.631    c-0.36-0.362-1.063-0.254-1.337-0.171c-0.039,0.011-0.715,0.222-1.834,0.567c-1.096-3.167-3.027-6.077-6.426-6.077    c-0.094,0-0.191,0.004-0.289,0.01c-0.966-1.283-2.164-1.844-3.199-1.844c-7.919,0-9.873,9.951-11.059,15.008    c-3.078,0.956-5.44,6.219-5.719,6.307c-1.719,0.542-1.772,0.596-1.996,2.223C11.148,25.91,5,56.264,5,56.264l35.022,6.594    L59,58.731c0,0-6.661-45.261-6.703-45.572C52.255,12.849,51.983,12.677,51.759,12.659z M33.034,10.88    c0,0.119-0.002,0.231-0.002,0.344c-1.928,0.601-4.02,1.251-6.121,1.906c1.179-4.57,3.387-6.78,5.32-7.613    C32.716,6.743,33.034,8.505,33.034,10.88z M29.876,3.278c0.346,0,0.688,0.116,1.018,0.345c-2.539,1.199-5.258,4.224-6.408,10.261    c-1.679,0.522-3.319,1.034-4.838,1.506C20.994,10.783,24.188,3.278,29.876,3.278z M31.241,30.19c0,0-2.05-1.099-4.561-1.099    c-3.686,0-3.872,2.324-3.872,2.908c0,3.195,8.287,4.42,8.287,11.903c0,5.888-3.714,9.678-8.726,9.678    c-6.012,0-9.088-3.761-9.088-3.761l1.609-5.345c0,0,3.16,2.729,5.83,2.729c1.74,0,2.449-1.38,2.449-2.387    c0-4.168-6.799-4.354-6.799-11.203c0-5.761,4.116-11.341,12.428-11.341c3.199,0,4.783,0.923,4.783,0.923L31.241,30.19z     M35.11,10.578c0-0.211,0.002-0.417,0.002-0.644c0-1.966-0.273-3.551-0.709-4.807c1.752,0.219,2.919,2.223,3.67,4.528    C37.194,9.931,36.194,10.241,35.11,10.578z",fill:"#79B259"})}),e.jsx("path",{d:"M40.022,62.857L59,58.731c0,0-6.661-45.261-6.703-45.572c-0.042-0.311-0.313-0.482-0.538-0.5   c-0.221-0.021-4.94-0.371-4.94-0.371s-3.28-3.271-3.639-3.631c-0.192-0.194-0.479-0.249-0.75-0.251   c-0.72,1.22-0.571,3.537-0.571,3.537l-2.232,50.839L40.022,62.857z",fill:"#55932C"}),e.jsx("path",{d:"M33.583,2.977c-0.094,0-0.191,0.004-0.289,0.01c-0.966-1.283-2.164-1.844-3.199-1.844   c-7.887,0-11.674,9.873-12.875,14.947l2.447-0.759c1.354-4.609,4.545-12.053,10.209-12.053c0.346,0,0.688,0.116,1.018,0.345   c-2.532,1.195-5.244,4.209-6.398,10.213l2.43-0.75c1.182-4.541,3.381-6.739,5.307-7.569c0.484,1.227,0.803,2.988,0.803,5.363   c0,0.108,0,0.211-0.002,0.314l2.078-0.643c0-0.2,0.002-0.4,0.002-0.617c0-1.966-0.273-3.551-0.709-4.807   c1.746,0.218,2.912,2.213,3.662,4.508l1.938-0.601C38.906,5.876,36.976,2.977,33.583,2.977z",fill:"#4A7A2B"}),e.jsx("path",{d:"M47.611,12.348c-0.474-0.037-0.793-0.06-0.793-0.06s-3.28-3.271-3.639-3.631   c-0.192-0.194-0.479-0.249-0.75-0.251c-0.72,1.22-0.571,3.537-0.571,3.537l-2.232,50.839l0.396,0.075l10.098-2.196L47.611,12.348z",fill:"#4C822A"})]})});function Dl({platform:s,onConnect:r,connectedId:a}){var M;const[n,l]=t.useState(""),[o,m]=t.useState([]),[h,d]=t.useState([]),[c,p]=t.useState([]),[C,x]=t.useState(!1),[S,A]=t.useState(!1),y="https://parallels.messold.com",b=z(N=>N.user.user);t.useEffect(()=>{const N=async()=>{var i;A(!0);try{const L=b==null?void 0:b.id,_=await ve.post(`${y}/api/setup/google-accounts`,{userId:L},{withCredentials:!0});_.status===200?(x(!1),m((i=_.data)==null?void 0:i.clientAccounts.filter(T=>!T.hidden))):console.log("Unexpected status code:",_.status)}catch(L){$(L,x)}finally{A(!1)}},u=async()=>{A(!0);try{const i=b==null?void 0:b.id,L=await ve.post(`${y}/api/setup/ga4-propertyIds`,{userId:i},{withCredentials:!0});L.status===200?(x(!1),d(L.data.propertiesList||[])):console.log("Unexpected status code:",L.status)}catch(i){$(i,x)}finally{A(!1)}},I=async()=>{A(!0);try{const i=b==null?void 0:b.id,L=await ve.post(`${y}/api/setup/fb-ad-accounts`,{userId:i},{withCredentials:!0});p(L.data.adAccounts||[])}catch(i){$(i,x)}finally{A(!1)}};s.toLowerCase()==="google ads"&&N(),s.toLowerCase()==="google analytics"&&u(),s.toLowerCase()==="facebook"&&I()},[s,b]);const $=(N,u)=>{const I=N;if(I.response){const{status:i,data:L}=I.response,_=I.code;i===400||i===403?u(!0):i===401||_==="TOKEN_EXPIRED"?(alert("Your Google session has expired. Please log in again."),u(!0)):(console.error("Unhandled Error Status:",i),console.error("Error Message:",L))}else I.request?console.error("No response received:",I.request):console.error("Unexpected Error:",I.message)},v=()=>s.toLowerCase()==="google ads"?!o||o.length===0?null:o.filter(N=>N.name.toLowerCase().includes(n.toLowerCase())):s.toLowerCase()==="google analytics"?!h||h.length===0?null:h.filter(N=>N.propertyName.toLowerCase().includes(n.toLowerCase())):s.toLowerCase()==="facebook"?!c||c.length===0?null:c.filter(N=>N.adname.toLowerCase().includes(n.toLowerCase())):[],w=N=>{let u,I,i;"clientId"in N?(u=N.clientId,i=N.managerId,I=i?`${N.name} (${u}/${i})`:`${N.name} (${u})`):"propertyId"in N?(u=N.propertyId,I=`${N.propertyName} (${u})`):"id"in N?(u=N.id,I=`${N.adname}`):(u="",I=""),r(s,I,u,i)},g=async()=>{try{const N=await ve.get(`${y}/api/auth/google?context=brandSetup`,{withCredentials:!0}),{authUrl:u}=N.data;window.location.href=u}catch(N){console.error("Error getting Google Auth URL:",N)}},F=async()=>{try{const N=await ve.get(`${y}/api/auth/facebook`,{withCredentials:!0});N.data.success?window.location.href=N.data.authURL:console.error("Failed to get Facebook Auth URL")}catch(N){console.error("Error getting Facebook Auth URL:",N)}};return S?e.jsx("div",{children:"Loading..."}):e.jsx(e.Fragment,{children:C?e.jsxs(D,{size:"sm",onClick:s.toLowerCase()==="facebook"?F:g,className:"flex items-center gap-2 bg-white text-black border border-green-800 hover:bg-green-50",children:[s.toLowerCase()==="google ads"&&e.jsxs(e.Fragment,{children:[e.jsx(Xe,{height:"1rem",width:"1rem"}),"Connect to your Google Ads account"]}),s.toLowerCase()==="google analytics"&&e.jsxs(e.Fragment,{children:[e.jsx(Re,{height:"1rem",width:"1rem"}),"Connect to your GA4 account"]}),s.toLowerCase()==="facebook"&&e.jsxs(e.Fragment,{children:[e.jsx(Qe,{height:"1rem",width:"1rem"}),"Connect to your Facebook account"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx(De,{type:"text",placeholder:"Search accounts...",className:"pl-10",value:n,onChange:N=>l(N.target.value)})]}),e.jsx("div",{className:"max-h-[50vh] overflow-auto",children:(M=v())==null?void 0:M.map(N=>{const u=s.toLowerCase()==="google ads",I=s.toLowerCase()==="facebook",i=u?N.clientId:I?N.id:N.propertyId,L=u?N.managerId:void 0,_=u?N.name:I?N.adname:N.propertyName,T=u?e.jsx(Xe,{height:"1rem",width:"1rem"}):I?e.jsx(Qe,{height:"1rem",width:"1rem"}):e.jsx(Re,{height:"1rem",width:"1rem"}),f=u&&L?`${_} (${i}/${L})`:I?`${_}`:`${_} (${i})`;return e.jsxs("div",{className:"flex items-center justify-between p-2 rounded hover:bg-gray-50",children:[e.jsx("span",{children:e.jsxs("div",{className:"flex flex-row items-center gap-3",children:[T,f]})}),e.jsxs(D,{size:"sm",onClick:()=>w(N),disabled:a.includes(i),className:"bg-blue-600",children:[a.includes(i)&&e.jsx(Ss,{className:"h-4 w-4 mr-2"}),a.includes(i)?"Connected":"Connect"]})]},`${s}-${i}-${L||""}`)})})]})})}const zl=[{name:"Shopify",color:"bg-emerald-50",icon:_r,textColor:"text-emerald-700",ringColor:"ring-emerald-200",description:"Connect your e-commerce store"},{name:"Facebook",color:"bg-blue-50",icon:Qe,textColor:"text-blue-700",ringColor:"ring-blue-200",description:"Link your ad accounts"},{name:"Google Ads",color:"bg-rose-50",icon:Xe,textColor:"text-rose-700",ringColor:"ring-rose-200",description:"Import campaign data"},{name:"Google Analytics",color:"bg-yellow-50",icon:Re,textColor:"text-yellow-700",ringColor:"ring-yellow-200",description:"Track website metrics"}],Xs=["Brand Details","Platform Connections","Review"];function Gl(){const[s,r]=t.useState(0),[a,n]=t.useState(null),[l,o]=t.useState({}),[m,h]=t.useState(""),[d,c]=t.useState(null),[p,C]=t.useState(""),[x,S]=t.useState(""),[A,y]=t.useState([]),[b,$]=t.useState(""),[v,w]=t.useState(""),{toast:g}=bt(),F="https://parallels.messold.com",M=z(f=>f.user.user);t.useEffect(()=>{const f=new URLSearchParams(window.location.search),P=f.get("access_token"),V=f.get("shop_name");P&&V&&(w(P),$(V),o(Z=>({...Z,Shopify:[V]})))},[]);const N=(f,P,V)=>{o(Z=>({...Z,[f]:[...Z[f]||[],P]})),f.toLowerCase()==="google ads"?C(V):f.toLowerCase()==="google analytics"?S(V):y(Z=>[...Z,V]),g({description:`Successfully connected ${P} to ${f}`,variant:"default"})},u=f=>{var V;const P=(V=f.target.files)==null?void 0:V[0];P&&(c(P),g({description:"Logo uploaded successfully",variant:"default"}))},I=f=>{var P;return(((P=l[f])==null?void 0:P.length)||0)>0},i=f=>{switch(f.toLowerCase()){case"google ads":return p;case"google analytics":return x;case"facebook":return A.join(",");default:return""}},L=()=>{switch(s){case 0:return!!m&&!!d;case 1:return Object.keys(l).length>0;default:return!0}},_=async()=>{if(!m||Object.keys(l).length===0)return g({description:"Please complete all fields before submitting.",variant:"destructive"});const f={name:m,logoUrl:d||"",googleAdAccount:p||"",ga4Account:{PropertyID:x||""},fbAdAccounts:A.map(P=>P),shopifyAccount:{shopName:b||"",shopifyAccessToken:v||""}};try{const V=(await ve.post(`${F}/api/brands/add`,f,{withCredentials:!0})).data.brand._id;M&&await ve.post(`${F}/api/users/add-brand`,{userId:M==null?void 0:M.id,brandId:V},{withCredentials:!0});const Z=M?{...M,brands:[...M.brands,V]}:null;Z&&mt(Z),g({description:"Brand setup completed successfully!",variant:"default"})}catch(P){console.error(P),g({description:"Error creating brand. Please try again.",variant:"destructive"})}},T=()=>{switch(s){case 0:return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Brand Name"}),e.jsx(De,{placeholder:"Enter your brand name",value:m,onChange:f=>h(f.target.value),className:"w-full"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Brand Logo"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(De,{id:"brandLogo",type:"file",accept:"image/*",onChange:u,className:"hidden"}),e.jsxs(D,{variant:"outline",className:"flex-1",onClick:()=>{var f;return(f=document.getElementById("brandLogo"))==null?void 0:f.click()},children:[e.jsx(qn,{className:"h-4 w-4 mr-2"}),d?"Change Logo":"Upload Logo"]}),d&&e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-gray-50 rounded-lg",children:[e.jsx(Ss,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"text-sm text-gray-600",children:d.name})]})]})]})]});case 1:return e.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:zl.map(f=>e.jsxs(Dr,{open:a===f.name,onOpenChange:P=>n(P?f.name:null),children:[e.jsx(El,{asChild:!0,children:e.jsx("button",{className:`relative group p-6 rounded-xl ${f.color} ring-1 ${f.ringColor} transition-all duration-200 hover:scale-[1.02]`,children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(f.icon,{width:"2rem",height:"2rem"}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("h3",{className:`font-semibold ${f.textColor}`,children:f.name}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:f.description})]}),I(f.name)?e.jsx(Ss,{className:"h-5 w-5 text-green-500"}):e.jsx(xs,{className:"h-5 w-5 text-gray-400"})]})})}),e.jsxs(Qt,{className:"sm:max-w-[600px]",children:[e.jsxs(Zt,{children:[e.jsxs(qt,{children:["Connect to ",f.name]}),e.jsx(Gr,{children:f.name==="Shopify"?"Enter your Shopify store name and login to connect.":"Select an account to connect with your brand."})]}),f.name==="Shopify"?e.jsx(Ol,{}):e.jsx(Dl,{platform:f.name,onConnect:N,connectedId:i(f.name)})]})]},f.name))});case 2:return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-lg bg-gray-50 p-6",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"Brand Details"}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Name"}),e.jsx("span",{className:"font-medium",children:m})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Logo"}),e.jsx("span",{className:"font-medium",children:d==null?void 0:d.name})]})]})]}),e.jsxs("div",{className:"rounded-lg bg-gray-50 p-6",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"Connected Platforms"}),e.jsx("div",{className:"mt-4 space-y-3",children:Object.entries(l).map(([f,P])=>e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:f}),e.jsx("span",{className:"font-medium",children:P.join(", ")})]},f))})]})]})}};return e.jsx(le,{className:"mx-auto shadow-lg",children:e.jsxs(ce,{className:"p-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[e.jsx("div",{className:"rounded-full bg-primary/10 p-2",children:e.jsx(xr,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Brand Setup"}),e.jsx("p",{className:"text-gray-500",children:"Complete the steps below to set up your brand"})]})]}),e.jsx("div",{className:"mb-8",children:e.jsx("div",{className:"flex justify-between items-center mb-4",children:Xs.map((f,P)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`flex items-center justify-center w-8 h-8 rounded-full ${P<=s?"bg-primary text-white":"bg-gray-100 text-gray-400"}`,children:P<s?e.jsx(Ss,{className:"h-5 w-5"}):e.jsx("span",{children:P+1})}),e.jsx("span",{className:`ml-2 ${P<=s?"text-gray-900":"text-gray-400"}`,children:f}),P<Xs.length-1&&e.jsx("div",{className:`w-24 h-0.5 mx-4 ${P<s?"bg-primary":"bg-gray-100"}`})]},f))})}),T(),e.jsxs("div",{className:"flex justify-between mt-8",children:[s>0&&e.jsx(D,{variant:"outline",onClick:()=>r(f=>f-1),children:"Back"}),e.jsx(D,{className:"ml-auto",disabled:!L(),onClick:()=>{s===Xs.length-1?_():r(f=>f+1)},children:s===Xs.length-1?e.jsxs(e.Fragment,{children:["Complete Setup",e.jsx(Ss,{className:"ml-2 h-5 w-5"})]}):e.jsxs(e.Fragment,{children:["Continue",e.jsx(jt,{className:"ml-2 h-5 w-5"})]})})]})]})})}function Br(){const s=z(r=>r.user.user);return e.jsxs("div",{className:"flex h-screen",children:[" ",e.jsx(ts,{}),e.jsx("div",{className:"flex-1 h-screen overflow-auto",children:e.jsx("div",{className:"container mx-auto px-4 py-4",children:e.jsxs("div",{className:"space-y-5",children:[e.jsx("div",{className:"bg-gradient-to-r from-primary to-primary/80 text-white rounded-2xl shadow-md overflow-hidden",children:e.jsxs("div",{className:"p-8 flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-4 max-w-2xl",children:[e.jsxs("h1",{className:"text-4xl font-extrabold tracking-tight",children:["Welcome, ",e.jsx("span",{className:"text-white/90",children:(s==null?void 0:s.username.split(" ")[0])||"User"})]}),e.jsx("p",{className:"text-lg text-white/80 leading-relaxed",children:"Embark on your analytics journey! Setting up your first brand will unlock powerful insights, helping you transform data into strategic growth."})]}),e.jsx(Jn,{className:"h-24 w-24 text-white/20 animate-pulse"})]})}),e.jsx(Gl,{})]})})})]})}const Vr=t.createContext({tokenError:!1,setTokenError:()=>{}}),_l=({children:s})=>{const[r,a]=t.useState(!1);return e.jsx(Vr.Provider,{value:{tokenError:r,setTokenError:a},children:s})},Qs=()=>t.useContext(Vr),ke=()=>{const s=fs(),{setTokenError:r}=Qs(),a=ve.create({baseURL:"https://parallels.messold.com",withCredentials:!0});return a.interceptors.response.use(n=>n,n=>{var l,o;return((l=n.response)==null?void 0:l.status)===401?(localStorage.removeItem("user"),s("/")):((o=n.response)==null?void 0:o.status)===403&&r(!0),Promise.reject(n)}),a},et=()=>e.jsxs("div",{className:"relative overflow-hidden bg-white p-6",children:[e.jsx("div",{className:"absolute top-0 right-0 p-4",children:e.jsx(Oe,{className:"h-6 w-6 rounded"})}),e.jsx(Oe,{className:"h-4 w-24"}),e.jsx("div",{className:"mt-4",children:e.jsx(Oe,{className:"h-8 w-32"})}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsx(Oe,{className:"h-4 w-16"}),e.jsx(Oe,{className:"h-4 w-24"})]})]}),Mt=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Oe,{className:"h-7 w-32"}),e.jsx("div",{className:"h-[1px] flex-1 mx-4 bg-slate-200"})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[e.jsx(et,{}),e.jsx(et,{}),e.jsx(et,{}),e.jsx(et,{})]})]}),Bl=()=>e.jsx("div",{className:"min-h-screen bg-slate-100",children:e.jsxs("div",{className:"mx-auto max-w-7xl p-8",children:[e.jsx("div",{className:"mb-6 space-y-4",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"h-12 w-1 bg-blue-500 rounded-full"}),e.jsxs("div",{children:[e.jsx(Oe,{className:"h-9 w-64"}),e.jsx(Oe,{className:"h-5 w-48 mt-1"})]})]})}),e.jsxs("div",{className:"space-y-10",children:[e.jsx(Mt,{}),e.jsx(Mt,{}),e.jsx(Mt,{})]})]})}),Vl={Yesterday:"bg-blue-500","Last 7 Days":"bg-purple-500","Last 30 Days":"bg-amber-500"},Ul={Yesterday:"bg-blue-50 border-blue-100","Last 7 Days":"bg-purple-50 border-purple-100","Last 30 Days":"bg-amber-50 border-amber-100"},ba=(s,r=!1)=>r?s.toFixed(2):s>=1e3?Math.round(s).toLocaleString():s,Hl=({period:s,value:r,previousValue:a,change:n,trend:l,isRoas:o=!1})=>e.jsxs("div",{className:ae("p-3 rounded-md border shadow-sm flex flex-col",Ul[s]),children:[e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx("div",{className:ae("h-2 w-2 rounded-full mr-1.5",Vl[s])}),e.jsx("span",{className:"text-xs font-medium text-slate-700",children:s})]}),e.jsx("div",{className:"text-lg font-bold text-slate-800",children:ba(r,o)}),e.jsxs("div",{className:"flex items-center mt-1 justify-between",children:[e.jsxs("span",{className:"text-xs text-slate-500",children:["vs ",ba(a,o)]}),e.jsxs("div",{className:ae("px-1.5 py-0.5 rounded text-xs font-medium flex items-center",l==="up"?"bg-emerald-100 text-emerald-700":"bg-rose-100 text-rose-700"),children:[l==="up"?e.jsx(Ms,{className:"h-3 w-3 mr-0.5"}):e.jsx(Ts,{className:"h-3 w-3 mr-0.5"}),Math.abs(n),"%"]})]})]}),bs=({title:s,icon:r,metricsData:a=[],isRoas:n=!1})=>{const l=["Yesterday","Last 7 Days","Last 30 Days"],o=a.reduce((m,h)=>(m[h.period]=h,m),{});return e.jsxs(le,{className:"border-slate-200 shadow-md",children:[e.jsxs(ws,{className:"p-4 pb-2 flex flex-row items-center space-x-2 border-b",children:[e.jsx("div",{className:"p-2 rounded-md bg-slate-100",children:e.jsx(r,{className:"h-5 w-5 text-slate-700"})}),e.jsx(_s,{className:"text-base font-semibold",children:s})]}),e.jsx(ce,{className:"p-4 pt-3",children:e.jsx("div",{className:"grid grid-cols-3 gap-3",children:l.map(m=>o[m]?e.jsx(Hl,{period:m,value:o[m].current,previousValue:o[m].previous,change:o[m].change,trend:o[m].trend,isRoas:n},m):e.jsx("div",{className:"p-3 rounded-md border border-slate-200 bg-slate-50 flex items-center justify-center",children:e.jsx("span",{className:"text-xs text-slate-400",children:"No data"})},m))})})]})},Yl=()=>{const s=z(S=>S.user.user),r=z(S=>S.brand.selectedBrandId),a=s==null?void 0:s.username,[n,l]=t.useState(!1),[o,m]=t.useState(),[h,d]=t.useState(),[c,p]=t.useState(),C=ke(),x=t.useCallback(async()=>{l(!0),m(void 0),d(void 0),p(void 0);const S=[{key:"analytics",promise:C.post(`api/summary/analytics/${r}`,{userId:s==null?void 0:s.id},{withCredentials:!0})},{key:"facebookAds",promise:C.post(`api/summary/facebook-ads/${r}`,{userId:s==null?void 0:s.id},{withCredentials:!0})},{key:"googleAds",promise:C.post(`api/summary/google-ads/${r}`,{userId:s==null?void 0:s.id},{withCredentials:!0})}];(await Promise.allSettled(S.map(y=>y.promise))).forEach((y,b)=>{y.status==="fulfilled"?(S[b].key==="analytics"&&m(y.value.data),S[b].key==="facebookAds"&&d(y.value.data),S[b].key==="googleAds"&&p(y.value.data)):console.error(`Error fetching ${S[b].key} data:`,y.reason)}),l(!1)},[r,s==null?void 0:s.id]);return t.useEffect(()=>{x()},[x]),n?e.jsx(Bl,{}):e.jsx("div",{className:"min-h-screen bg-slate-50 text-slate-900",children:e.jsxs("div",{className:"mx-auto p-6",children:[e.jsx("div",{className:"mb-6 animate-fade-up",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"h-12 w-1 bg-blue-500 rounded-full"}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl lg:text-3xl font-bold tracking-tight",children:["Welcome Back, ",a]}),e.jsx("p",{className:"text-slate-500 mt-1",children:"Here's your business performance overview"})]})]}),e.jsxs("div",{className:"flex flex-row items-center gap-3",children:[e.jsx(Ir,{}),e.jsx(D,{onClick:x,disabled:n,size:"sm",variant:"outline",className:"hover:bg-slate-100",children:e.jsx(fe,{className:ae("h-4 w-4 ",n&&"animate-spin")})})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{id:"analytics-section",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("div",{className:"h-4 w-1 bg-amber-500 rounded-full mr-2.5"}),e.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:"Analytics"})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 ",children:[e.jsx("div",{id:"sessions-metric",children:e.jsx(bs,{title:"Sessions",icon:_t,metricsData:(o==null?void 0:o.metricsSummary.sessions)||[]})}),e.jsx(bs,{title:"Cart Additions",icon:Dt,metricsData:(o==null?void 0:o.metricsSummary.addToCarts)||[]}),e.jsx(bs,{title:"Checkouts",icon:Xn,metricsData:(o==null?void 0:o.metricsSummary.checkouts)||[]}),e.jsx(bs,{title:"Purchases",icon:ot,metricsData:(o==null?void 0:o.metricsSummary.purchases)||[]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-3 mt-6",children:[e.jsx("div",{className:"h-4 w-1 bg-indigo-500 rounded-full mr-2.5"}),e.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:"Meta"})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx(bs,{title:"Meta Spend",icon:ra,metricsData:(h==null?void 0:h.metricsSummary.spend)||[]}),e.jsx(bs,{title:"Meta ROAS",icon:na,metricsData:(h==null?void 0:h.metricsSummary.roas)||[],isRoas:!0})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-3 mt-6",children:[e.jsx("div",{className:"h-4 w-1 bg-emerald-500 rounded-full mr-2.5"}),e.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:"Google"})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx(bs,{title:"Google Spend",icon:ra,metricsData:(c==null?void 0:c.metricsSummary.spend)??[]}),e.jsx(bs,{title:"Google ROAS",icon:na,metricsData:(c==null?void 0:c.metricsSummary.roas)??[],isRoas:!0})]})]})]})]})})},Wl=()=>{var r;const{user:s}=Os();return e.jsxs("div",{className:"flex h-screen relative",children:[e.jsx(ts,{}),e.jsx("div",{className:"flex-1 h-screen overflow-auto",children:((r=s==null?void 0:s.brands)==null?void 0:r.length)===0?e.jsx(Br,{}):e.jsx(Yl,{})}),e.jsx(gs,{})]})},Kl=t.createContext(void 0),Ql=({children:s})=>{const[r,a]=t.useState(null),[n,l]=t.useState([]);t.useEffect(()=>{const m=localStorage.getItem("brands"),h=localStorage.getItem("selectedBrandId");m&&l(JSON.parse(m)),h&&a(h)},[]),t.useEffect(()=>{n.length>0&&localStorage.setItem("brands",JSON.stringify(n))},[n]),t.useEffect(()=>{r&&localStorage.setItem("selectedBrandId",r)},[r]);const o=()=>{a(null),localStorage.removeItem("selectedBrandId")};return e.jsx(Kl.Provider,{value:{selectedBrandId:r,setSelectedBrandId:a,resetBrand:o,brands:n,setBrands:l},children:s})};function Ue({title:s,tooltip:r,colSpan:a=1,rowSpan:n,isSubHeader:l=!1}){return e.jsx("th",{className:`
                ${l?"text-xs font-medium":"font-semibold text-sm"}
                text-center whitespace-nowrap border-r border-gray-400 p-2
                ${l?"bg-gradient-to-b from-gray-100 to-gray-200":"bg-gradient-to-r from-gray-100 to-gray-200"}
                relative overflow-hidden
                ${l?"":'after:content-[""] after:absolute after:bottom-0 after:left-0 after:w-full after:h-0.5 after:bg-blue-500/20'}
            `,colSpan:a,rowSpan:n,children:e.jsx(Ga,{children:e.jsxs(_a,{children:[e.jsx(Ba,{asChild:!0,children:e.jsx("span",{className:"flex items-center justify-center gap-1 cursor-help",children:s})}),e.jsx(Va,{className:"mb-3",children:e.jsx("div",{className:"text-gray-700 bg-white p-2 rounded-md text-sm border shadow-lg max-w-xs",children:r})})]})})})}const Zl=()=>{const[s,r]=t.useState([]),[a,n]=t.useState(!0),[l,o]=t.useState(null),[m,h]=t.useState(!1),d=z(N=>N.date.from),c=z(N=>N.date.to),[p,C]=t.useState([]),{brandId:x}=ge(),S=t.useMemo(()=>({from:d,to:c}),[d,c]),A=S!=null&&S.from?H(S.from,"yyyy-MM-dd"):"",y=S!=null&&S.to?H(S.to,"yyyy-MM-dd"):"",b="https://parallels.messold.com",$=()=>{h(!m)},v=()=>m?"max-h-[calc(100vh-80px)]":"max-h-[calc(100vh-200px)]";t.useEffect(()=>{(async()=>{n(!0),o(null);try{const u={};A&&(u.startDate=A),y&&(u.endDate=y);const i=(await ve.get(`${b}/api/report/${x}`,{params:u,withCredentials:!0})).data.data;r(i)}catch(u){console.error(u),o("Failed to fetch data. Please try again later.")}finally{n(!1)}})()},[x,A,y,b]);const w=N=>{C(u=>u.includes(N)?u.filter(I=>I!==N):[...u,N])},g=N=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(N),F=N=>`${N.toFixed(2)}`,M=t.useMemo(()=>{const N=(u,I)=>I?u/I:0;return s.map(u=>{const I=u.dailyMetrics.map(T=>({...T,metaSales:T.metaSpend*(T.metaROAS||0),googleSales:T.googleSpend*(T.googleROAS||0),adSales:T.totalSpend*T.grossROI||0,ROI:N(T.totalSales,T.totalSpend)})),i=I.reduce((T,f)=>T+f.metaSales,0),L=I.reduce((T,f)=>T+f.googleSales,0),_=i+L||0;return{...u,metaSales:i,googleSales:L,totalAdSales:_,metaROAS:N(i,u.metaSpend),googleROAS:N(L,u.googleSpend),grossROI:N(_,u.totalSpend),netROI:N(u.shopifySales,u.totalSpend),ROI:N(u.totalSales,u.totalSpend),dailyMetrics:I}})},[s]);return e.jsxs("div",{className:"flex h-screen",children:[e.jsx(ts,{}),e.jsxs("div",{className:"flex-1 h-screen overflow-hidden bg-gray-100",children:[e.jsx(js,{title:"Marketing Insights Tracker",Icon:Ot,showDatePicker:!0}),e.jsx(le,{id:"metrics-table",className:`${m?"fixed inset-0 z-50 m-0":"m-6"}`,children:e.jsxs(ce,{children:[e.jsxs("div",{className:"flex flex-row items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex flex-row items-center gap-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 ",children:"Key Performance Metrics by Month with Daily Drill-Down"}),e.jsxs("div",{className:"flex flex-row gap-2",children:[e.jsx(Qe,{width:20,height:20}),e.jsx(Xe,{width:20,height:20}),e.jsx(_r,{width:20,height:20})]})]}),e.jsxs("div",{className:"flex flex-row items-center gap-3",children:[m&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{defaultDate:{from:new Date(new Date().getFullYear(),new Date().getMonth(),1),to:new Date}})}),e.jsx(D,{onClick:$,size:"icon",variant:"outline",children:m?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]}),a?e.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-300px)]",children:e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-blue-600"})}):l?e.jsx("div",{className:"rounded-lg bg-red-50 p-4 text-red-600 border border-red-200",children:l}):e.jsx("div",{className:"border rounded-lg shadow-sm bg-white overflow-hidden",children:e.jsx("div",{className:`${v()}  overflow-auto`,children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsxs("thead",{className:"sticky top-0 z-20 text-sm",children:[e.jsxs("tr",{children:[e.jsx("th",{className:"w-3 bg-gradient-to-r from-gray-100 to-gray-200 border-r border-gray-400 after:content-[''] after:absolute after:bottom-0 after:left-0 after:w-full after:h-0.5 after:bg-blue-500/20",rowSpan:2}),e.jsx(Ue,{title:"Date",tooltip:"Date",rowSpan:2}),e.jsx(Ue,{title:"Meta (Facebook & Instagram Ads)",tooltip:"Meta Metrics",colSpan:3}),e.jsx(Ue,{title:"Google Ads",tooltip:"Google Metrics",colSpan:3}),e.jsx(Ue,{title:"Marketing Performance (Platform-Reported)",tooltip:"Marketing Performance (Platform-Reported)",colSpan:3}),e.jsx(Ue,{title:"Shopify (Actual Sales Data)",tooltip:"Shopify Metrics",colSpan:5})]}),e.jsxs("tr",{children:[e.jsx(Ue,{title:"Spend",tooltip:"Meta Spent",isSubHeader:!0}),e.jsx(Ue,{title:"Sales",tooltip:"Meta Sales = Meta Spent * Meta ROAS",isSubHeader:!0}),e.jsx(Ue,{title:"ROAS",tooltip:"Meta ROAS",isSubHeader:!0}),e.jsx(Ue,{title:"Spend",tooltip:"Google Spent",isSubHeader:!0}),e.jsx(Ue,{title:"Sales",tooltip:"Google Sales = Google Spent * Google ROAS",isSubHeader:!0}),e.jsx(Ue,{title:"ROAS",tooltip:"Google ROAS",isSubHeader:!0}),e.jsx(Ue,{title:"Spend",tooltip:"Total Spent = Meta Spent + Google Spent",isSubHeader:!0}),e.jsx(Ue,{title:"Sales",tooltip:"ROI = (MetaSales + GoogleSales)",isSubHeader:!0}),e.jsx(Ue,{title:"ROI",tooltip:"ROI = (MetaSales + GoogleSales)/ Total Spent",isSubHeader:!0}),e.jsx(Ue,{title:"Net Sales",tooltip:"Net Sales = Gross Sales - Discount",isSubHeader:!0}),e.jsx(Ue,{title:"Net ROI",tooltip:"Total Sales / Total Spend",isSubHeader:!0}),e.jsx(Ue,{title:"Returns",tooltip:"Returns",isSubHeader:!0}),e.jsx(Ue,{title:"Total Sales",tooltip:"Total Sales = Net Sales - Returns",isSubHeader:!0}),e.jsx(Ue,{title:"Final ROI",tooltip:"Final ROI = Total Sales / Total Spend",isSubHeader:!0})]})]}),e.jsx("tbody",{children:M.map(N=>{const u=`${N.year}-${N.month.toString().padStart(2,"0")}`,I=p.includes(u);return e.jsxs(Ze.Fragment,{children:[e.jsxs("tr",{className:`
                                                        ${I?"bg-blue-100/30 ":"hover:bg-gradient-to-r hover:from-gray-50 hover:to-transparent"} 
                                                        border-b border-gray-200 cursor-pointer 
                                                        transition-colors text-sm 
                                                    `,onClick:()=>w(u),children:[e.jsx("td",{id:"expand-month",className:"w-3 px-4 py-2",children:e.jsx("div",{className:`
                          w-6 h-6 rounded-full bg-blue-100 flex items-center justify-center
                          transition-all duration-300 transform
                          ${I?"rotate-180 bg-blue-500":"hover:bg-blue-200"}
                        `,children:e.jsx(is,{className:`w-4 h-4 ${I?"text-white":"text-blue-500"}`})})}),e.jsx("td",{className:"px-4 py-3 text-left font-medium whitespace-nowrap",children:H(new Date(N.year,N.month-1),"MMM yyyy")}),e.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700",children:g(N.metaSpend)}),e.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700",children:g(N.metaSales)}),e.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700",children:F(N.metaROAS)}),e.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700",children:g(N.googleSpend)}),e.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700",children:g(N.googleSales)}),e.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700",children:F(N.googleROAS)}),e.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700",children:g(N.totalSpend)}),e.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700",children:g(N.totalSpend*N.grossROI)||0}),e.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700",children:F(N.grossROI)}),e.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700",children:g(N.totalSales)}),e.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700",children:F(N.ROI)}),e.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700",children:g(N.refundAmount)}),e.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700",children:g(N.shopifySales)}),e.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700",children:F(N.netROI)})]}),I&&N.dailyMetrics.map(i=>e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"w-5 px-4 py-1.5"}),e.jsx("td",{className:"px-4 py-1.5 text-xs text-left text-gray-600",children:H(new Date(i.date),"dd/MM/yyyy")}),e.jsx("td",{className:"px-4 py-1.5 text-xs text-right text-gray-700",children:g(i.metaSpend)}),e.jsx("td",{className:"px-4 py-1.5 text-xs text-right text-gray-700",children:g(i.metaSales)}),e.jsx("td",{className:"px-4 py-1.5 text-xs text-right  text-gray-700",children:F(i.metaROAS)}),e.jsx("td",{className:"px-4 py-1.5 text-xs text-right  text-gray-700",children:g(i.googleSpend)}),e.jsx("td",{className:"px-4 py-1.5 text-xs text-right  text-gray-700",children:g(i.googleSales)}),e.jsx("td",{className:"px-4 py-1.5 text-xs text-right  text-gray-700",children:F(i.googleROAS)}),e.jsx("td",{className:"px-4 py-1.5 text-xs text-right  text-gray-700",children:g(i.totalSpend)}),e.jsx("td",{className:"px-4 py-1.5 text-xs text-right  text-gray-700",children:g(i.adSales)}),e.jsx("td",{className:"px-4 py-1.5 text-xs text-right  text-gray-700",children:F(i.grossROI)}),e.jsx("td",{className:"px-4 py-1.5 text-xs text-right text-gray-700",children:g(i.totalSales)}),e.jsx("td",{className:"px-4 py-1.5 text-xs text-right text-gray-700",children:F(i.ROI)}),e.jsx("td",{className:"px-4 py-1.5 text-xs text-right text-gray-700",children:g(i.refundAmount)}),e.jsx("td",{className:"px-4 py-1.5 text-xs text-right text-gray-700",children:g(i.shopifySales)}),e.jsx("td",{className:"px-4 py-1.5 text-xs text-right text-gray-700",children:F(i.netROI)})]},i._id))]},u)})})]})})})]})})]}),e.jsx(gs,{})]})},Jt=t.forwardRef(({className:s,...r},a)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:a,className:ae("w-full caption-bottom text-sm",s),...r})}));Jt.displayName="Table";const Xt=t.forwardRef(({className:s,...r},a)=>e.jsx("thead",{ref:a,className:ae("[&_tr]:border-b",s),...r}));Xt.displayName="TableHeader";const ea=t.forwardRef(({className:s,...r},a)=>e.jsx("tbody",{ref:a,className:ae("[&_tr:last-child]:border-0",s),...r}));ea.displayName="TableBody";const ql=t.forwardRef(({className:s,...r},a)=>e.jsx("tfoot",{ref:a,className:ae("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...r}));ql.displayName="TableFooter";const Us=t.forwardRef(({className:s,...r},a)=>e.jsx("tr",{ref:a,className:ae("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...r}));Us.displayName="TableRow";const ss=t.forwardRef(({className:s,...r},a)=>e.jsx("th",{ref:a,className:ae("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...r}));ss.displayName="TableHead";const Ye=t.forwardRef(({className:s,...r},a)=>e.jsx("td",{ref:a,className:ae("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...r}));Ye.displayName="TableCell";const Jl=t.forwardRef(({className:s,...r},a)=>e.jsx("caption",{ref:a,className:ae("mt-4 text-sm text-muted-foreground",s),...r}));Jl.displayName="TableCaption";const qe=Nn,Je=wn,We=t.forwardRef(({className:s,children:r,...a},n)=>e.jsxs(Ua,{ref:n,className:ae("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...a,children:[r,e.jsx(gn,{asChild:!0,children:e.jsx(Ha,{className:"h-4 w-4 opacity-50"})})]}));We.displayName=Ua.displayName;const Ur=t.forwardRef(({className:s,...r},a)=>e.jsx(Ya,{ref:a,className:ae("flex cursor-default items-center justify-center py-1",s),...r,children:e.jsx(pn,{className:"h-4 w-4"})}));Ur.displayName=Ya.displayName;const Hr=t.forwardRef(({className:s,...r},a)=>e.jsx(Wa,{ref:a,className:ae("flex cursor-default items-center justify-center py-1",s),...r,children:e.jsx(Ha,{className:"h-4 w-4"})}));Hr.displayName=Wa.displayName;const Ke=t.forwardRef(({className:s,children:r,position:a="popper",...n},l)=>e.jsx(jn,{children:e.jsxs(Ka,{ref:l,className:ae("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:a,...n,children:[e.jsx(Ur,{}),e.jsx(vn,{className:ae("p-1",a==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),e.jsx(Hr,{})]})}));Ke.displayName=Ka.displayName;const Xl=t.forwardRef(({className:s,...r},a)=>e.jsx(Qa,{ref:a,className:ae("px-2 py-1.5 text-sm font-semibold",s),...r}));Xl.displayName=Qa.displayName;const Te=t.forwardRef(({className:s,children:r,...a},n)=>e.jsxs(Za,{ref:n,className:ae("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...a,children:[e.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(bn,{children:e.jsx(Lt,{className:"h-4 w-4"})})}),e.jsx(yn,{children:r})]}));Te.displayName=Za.displayName;const ei=t.forwardRef(({className:s,...r},a)=>e.jsx(qa,{ref:a,className:ae("-mx-1 my-1 h-px bg-muted",s),...r}));ei.displayName=qa.displayName;function si(){const s=z(T=>T.brand.brands),[r,a]=t.useState([]),[n,l]=t.useState({brandId:"",name:"",source:"",targetSales:0,targetSpend:0,targetROAS:0,targetDate:ca(new Date)}),[o,m]=t.useState(null),[h,d]=t.useState(null),[c,p]=t.useState({}),[C,x]=t.useState(!1),S=z(T=>T.user.user),A=S==null?void 0:S.id,y="https://parallels.messold.com",b=fs(),$=t.useCallback(async T=>{var f;try{return(await ve.post(`${y}/api/performance/metaMetrics/${T}`,{userId:A},{withCredentials:!0})).data}catch(P){return console.error("Error fetching metrics data:",P),ve.isAxiosError(P)&&((f=P.response)==null?void 0:f.status)===401&&(alert("Your session has expired. Please log in again."),b("/")),{success:!1,data:{spend:0,Revenue:0,purchase_roas:"0.00"}}}},[y,A,b]),v=t.useCallback(async()=>{x(!0);try{const T={};await Promise.all(r.map(async f=>{const P=await $(f.brandId);P.success&&(T[f.brandId]=P.data)})),p(T)}catch(T){console.error("Error fetching metrics data:",T)}finally{x(!1)}},[r,$]);t.useEffect(()=>{r.length>0&&v()},[v,r]);const w=T=>{const{name:f,value:P}=T.target;l(V=>({...V,[f]:["brandId","name"].includes(f)?P:Number(P)}))},g=T=>{l(f=>({...f,source:T}))},F=async()=>{const T=s.find(f=>String(f._id)===String(n.brandId));if(T)try{const f={brandId:T._id,name:T.name,source:n.source,targetSales:n.targetSales,targetSpend:n.targetSpend,targetROAS:n.targetROAS,targetDate:n.targetDate},P=await ve.post(`${y}/api/performance/addTarget`,f,{withCredentials:!0});a(V=>[...V,P.data]),l({brandId:"",name:"",source:"",targetSales:0,targetSpend:0,targetROAS:0,targetDate:ca(new Date)})}catch(f){console.error("Error adding brand:",f)}else console.log("Brand not found")},M=T=>{const f=r.find(P=>P.brandId===T);f&&(m(T),d({...f,targetDate:new Date(f.targetDate)}))},N=async T=>{if(h)try{const f=await ve.patch(`${y}/api/performance/updateTarget/${T}`,h,{withCredentials:!0});a(P=>P.map(V=>V.brandId===T?{...V,...f.data}:V)),m(null),d(null),alert("Brand updated successfully!")}catch(f){console.error("Error saving brand edit:",f),alert("Failed to update brand")}},u=()=>{m(null),d(null)},I=async T=>{try{await ve.delete(`${y}/api/performance/deleteTarget/${T}`,{withCredentials:!0}),a(f=>f.filter(P=>P.brandId!==T)),console.log("Brand deleted successfully")}catch(f){console.error("Error deleting brand:",f)}},i=()=>e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-blue-500"}),L=T=>{const f=c[T.brandId]||{spend:0,Revenue:0,purchase_roas:"0.00"},P=f.spend||0,V=Number(f.Revenue)||0,Z=Math.max(T.targetSales-V,0).toFixed(2),k=parseFloat(f.purchase_roas)||0,j=new Date;j.setHours(0,0,0,0);const E=new Date(T.targetDate);E.setHours(0,0,0,0);const R=Math.max(Math.ceil((E.getTime()-j.getTime())/(1e3*60*60*24)),0),Y=R>0?parseFloat(Z)/R:0;return{achievedSales:V,remainingSales:Z,achievedSpend:P,achievedROAS:k,remainingDays:R,requiredSalesPerDay:Y}},_=r.map(T=>{const{achievedSales:f,remainingSales:P}=L(T);return{name:T.name,Achieved:f,Remaining:P}});return t.useEffect(()=>{(async()=>{try{const P=(await ve.get(`${y}/api/performance/brandTarget`,{withCredentials:!0})).data.map(V=>({...V,targetDate:new Date(V.targetDate)}));a(P)}catch(f){console.error("Error fetching brands:",f)}})()},[y]),e.jsxs("div",{className:"bg-gray-100 min-h-screen",children:[e.jsx("nav",{className:"bg-white border-b border-gray-200 px-4 py-4 md:px-6 lg:px-8",children:e.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:e.jsx("h1",{className:"text-2xl font-bold",children:"Brands Performance Metrics"})})}),e.jsxs("div",{className:"container mx-auto p-4",children:[e.jsxs(le,{className:"mb-4",children:[e.jsx(ws,{children:e.jsx(_s,{children:"Add New Brand Target"})}),e.jsx(ce,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-7 gap-4",children:[e.jsxs("div",{children:[e.jsx(us,{htmlFor:"brandName",children:"Brand Name"}),e.jsxs(qe,{onValueChange:T=>{const f=s.find(P=>P._id===T);l(P=>({...P,brandId:T,name:(f==null?void 0:f.name)||""}))},children:[e.jsx(We,{children:e.jsx(Je,{placeholder:"Select brand"})}),e.jsx(Ke,{children:s.map(T=>e.jsx(Te,{value:T._id,children:T.name},T._id))})]})]}),e.jsxs("div",{children:[e.jsx(us,{htmlFor:"source",children:"Source"}),e.jsxs(qe,{onValueChange:g,value:n.source,children:[e.jsx(We,{children:e.jsx(Je,{placeholder:"Select source"})}),e.jsxs(Ke,{children:[e.jsx(Te,{value:"Meta & Google",children:"Meta & Google"}),e.jsx(Te,{value:"Meta",children:"Meta"}),e.jsx(Te,{value:"Google",children:"Google"})]})]})]}),e.jsxs("div",{children:[e.jsx(us,{htmlFor:"targetSales",children:"Target Sales"}),e.jsx(De,{id:"targetSales",name:"targetSales",type:"number",value:n.targetSales,onChange:w,placeholder:"Enter target sales"})]}),e.jsxs("div",{children:[e.jsx(us,{htmlFor:"targetSpend",children:"Target Spend"}),e.jsx(De,{id:"targetSpend",name:"targetSpend",type:"number",value:n.targetSpend,onChange:w,placeholder:"Enter target spend"})]}),e.jsxs("div",{children:[e.jsx(us,{htmlFor:"targetROAS",children:"Target ROAS"}),e.jsx(De,{id:"targetROAS",name:"targetROAS",type:"number",value:n.targetROAS,onChange:w,placeholder:"Enter target ROAS",step:"0.01"})]}),e.jsxs("div",{children:[e.jsx(us,{children:"Target Date"}),e.jsxs(Is,{children:[e.jsx(Fs,{asChild:!0,children:e.jsx(D,{variant:"outline",className:ae("w-full justify-start text-left font-normal",!n.targetDate&&"text-muted-foreground"),children:n.targetDate?H(n.targetDate,"PPP"):e.jsx("span",{children:"Pick a date"})})}),e.jsx(Cs,{className:"w-auto p-0",children:e.jsx(ut,{mode:"single",selected:n.targetDate,onSelect:T=>T&&l(f=>({...f,targetDate:T})),initialFocus:!0})})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs(D,{onClick:F,className:"w-full",children:[e.jsx(eo,{className:"mr-2 h-4 w-4"})," Add Brand Target"]})})]})})]}),e.jsxs(le,{className:"mb-4",children:[e.jsx(ws,{children:e.jsx(_s,{children:"Brand Performance Table"})}),e.jsx(ce,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Jt,{children:[e.jsx(Xt,{children:e.jsxs(Us,{children:[e.jsx(ss,{children:"Brand"}),e.jsx(ss,{children:"Source"}),e.jsx(ss,{children:"Month"}),e.jsx(ss,{children:"Target Spend"}),e.jsx(ss,{children:"Target Sales"}),e.jsx(ss,{children:"Target ROAS"}),e.jsx(ss,{children:"Achieved Spend"}),e.jsx(ss,{children:"Achieved Sales"}),e.jsx(ss,{children:"Achieved ROAS"}),e.jsx(ss,{children:"Remaining Sales"}),e.jsx(ss,{children:"Remaining Days"}),e.jsx(ss,{children:"Required Sales/Day"}),e.jsx(ss,{children:"Actions"})]})}),e.jsx(ea,{children:r.map(T=>{const{achievedSales:f,remainingSales:P,achievedSpend:V,achievedROAS:Z,remainingDays:k,requiredSalesPerDay:j}=L(T),E=o===T.brandId;return e.jsxs(Us,{children:[e.jsx(Ye,{className:"font-bold text-sm",children:T.name}),e.jsx(Ye,{children:E?e.jsxs(qe,{onValueChange:R=>d(Y=>Y?{...Y,source:R}:null),defaultValue:h==null?void 0:h.source,children:[e.jsx(We,{children:e.jsx(Je,{placeholder:T.source})}),e.jsxs(Ke,{children:[e.jsx(Te,{value:"Meta & Google",children:"Meta & Google"}),e.jsx(Te,{value:"Meta",children:"Meta"}),e.jsx(Te,{value:"Google",children:"Google"})]})]}):T.source}),e.jsx(Ye,{children:E?e.jsxs(Is,{children:[e.jsx(Fs,{asChild:!0,children:e.jsx(D,{variant:"outline",children:h!=null&&h.targetDate?H(h.targetDate,"PPP"):e.jsx("span",{children:"Pick a date"})})}),e.jsx(Cs,{className:"w-auto p-0",children:e.jsx(ut,{mode:"single",selected:h==null?void 0:h.targetDate,onSelect:R=>R&&d(Y=>Y?{...Y,targetDate:R}:null),initialFocus:!0})})]}):H(new Date(T.targetDate),"MMM yyyy")}),e.jsx(Ye,{children:E?e.jsx(De,{type:"number",value:h==null?void 0:h.targetSpend,onChange:R=>d(Y=>Y?{...Y,targetSpend:Number(R.target.value)}:null)}):`₹${T.targetSpend.toLocaleString()}`}),e.jsx(Ye,{children:E?e.jsx(De,{type:"number",value:h==null?void 0:h.targetSales,onChange:R=>d(Y=>Y?{...Y,targetSales:Number(R.target.value)}:null)}):`₹${T.targetSales.toLocaleString()}`}),e.jsx(Ye,{children:E?e.jsx(De,{type:"number",step:"0.01",value:h==null?void 0:h.targetROAS,onChange:R=>d(Y=>Y?{...Y,targetROAS:Number(R.target.value)}:null)}):T.targetROAS.toFixed(2)}),e.jsx(Ye,{children:C?e.jsx(i,{}):`₹${V.toLocaleString("en-IN")}`}),e.jsx(Ye,{children:C?e.jsx(i,{}):`₹${f.toLocaleString("en-IN")}`}),e.jsx(Ye,{children:C?e.jsx(i,{}):Z.toFixed(2)}),e.jsx(Ye,{children:new Intl.NumberFormat("en-IN",{maximumFractionDigits:2}).format(Number(P))}),e.jsx(Ye,{children:k}),e.jsxs(Ye,{children:["₹",new Intl.NumberFormat("en-IN",{maximumFractionDigits:2}).format(j)]}),e.jsx(Ye,{children:E?e.jsxs(e.Fragment,{children:[e.jsx(D,{onClick:()=>N(T.brandId),className:"mr-2",children:"Save"}),e.jsx(D,{onClick:u,variant:"outline",children:e.jsx(rs,{className:"h-4 w-4"})})]}):e.jsxs("div",{className:"flex flex-row gap-1",children:[e.jsx(D,{size:"sm",onClick:()=>M(T.brandId),children:e.jsx(so,{className:"h-2 w-2"})}),e.jsx(D,{size:"sm",onClick:()=>I(T.brandId),variant:"destructive",children:e.jsx(fr,{className:"h-2 w-2"})})]})})]},T.brandId)})})]})})})]}),e.jsxs(le,{children:[e.jsx(ws,{children:e.jsx(_s,{children:"Sales Progress"})}),e.jsx(ce,{children:e.jsx(lt,{width:"100%",height:300,children:e.jsxs(It,{data:_,children:[e.jsx(it,{dataKey:"name"}),e.jsx(ct,{}),e.jsx(Ft,{formatter:T=>`₹${Number(T).toLocaleString()}`}),e.jsx(dt,{dataKey:"Achieved",stackId:"a",fill:"#4ade80"}),e.jsx(dt,{dataKey:"Remaining",stackId:"a",fill:"#f87171"})]})})})]})]})]})}const ti=()=>e.jsxs("div",{className:"flex h-screen",children:[e.jsx(ts,{}),e.jsx("div",{className:"flex-1 h-screen overflow-auto",children:e.jsx(si,{})})]});function ai(){var O,J,se,Q,re,xe,U;const s="https://parallels.messold.com",{brandId:r}=ge(),[a,n]=t.useState([{id:"products",label:"Products",apiEndpoint:`${s}/api/segment/productMetrics/${r}`,columns:[],data:[],lastUpdated:null},{id:"categories",label:"Categories",apiEndpoint:`${s}/api/segment/categoryMetrics/${r}`,columns:[],data:[],lastUpdated:null},{id:"brands",label:"Brands",apiEndpoint:`${s}/api/segment/brandMetrics/${r}`,columns:[],data:[],lastUpdated:null},{id:"productTypes",label:"Product types",apiEndpoint:`${s}/api/segment/typeMetrics/${r}`,columns:[],data:[],lastUpdated:null}]),[l,o]=t.useState(a[0].id),[m,h]=t.useState(1),[d,c]=t.useState(new Set),[p,C]=t.useState(!1),[x,S]=t.useState(!1),A=100,[y,b]=t.useState({}),$=t.useRef({}),v=5*60*1e3,w=z(G=>G.date.from),g=z(G=>G.date.to),F=t.useMemo(()=>({from:w,to:g}),[w,g]),M=F!=null&&F.from?H(F.from,"yyyy-MM-dd"):"",N=F!=null&&F.to?H(F.to,"yyyy-MM-dd"):"",[u,I]=t.useState(null),[i,L]=t.useState("asc"),_=G=>{o(G),h(1),c(new Set)},T=t.useCallback(async(G,X={},ee=!1)=>{if(p)return;C(!0);const de=a.find(we=>we.id===G);if(!de){console.warn(`Tab not found for ID: ${G}`),C(!1);return}const B={...X,...M&&{startDate:M},...N&&{endDate:N}},q=`${G}-${M||"default"}-${N||"default"}`,me=$.current[q],Ne=Date.now();if(!ee&&G==="products"&&delete $.current[q],!ee&&me&&Ne-me.timestamp<v){n(we=>we.map(Be=>Be.id===G?{...Be,data:me.data,lastUpdated:me.timestamp}:Be)),C(!1);return}try{const we=await ve.post(de.apiEndpoint,B,{withCredentials:!0});if(we.data.success){const K=we.data[`${G}Data`]||[];console.log("New Data for Tab:",G,K);const ne=Object.keys(K[0]||{}).map(te=>({id:te,header:te.charAt(0).toUpperCase()+te.slice(1),accessorKey:te,cell:oe=>te==="issues"&&Array.isArray(oe)?oe.length>0?oe[0].description:"No issues":String(oe)}));console.log("Columns for Tab:",ne),n(te=>te.map(oe=>oe.id===G?{...oe,columns:ne,data:K,lastUpdated:Ne}:oe)),$.current[q]={data:K,timestamp:Ne}}else console.error(`Failed to fetch data for ${G}`)}catch(we){console.error(`Error fetching data for ${G}:`,we)}finally{C(!1)}},[a,p,$,M,N]);t.useEffect(()=>{const G={...y,...M&&{startDate:M},...N&&{endDate:N}};T(l,x?G:{},!!x)},[l,F,x,y]);const f=(G,X)=>{const ee={brands:"Brand",productTypes:"Type",categories:"name",products:"status"},de={brands:"brands",productTypes:"productType",categories:"categoryName",products:"status"},B=ee[G],q=de[G];if(B&&q){const me=X[B];if(me){const Ne={[q]:me};G==="categories"&&X.level&&(Ne.categoryLevel=X.level),b(Ne),S(!0),o("products")}else console.warn(`No value found for column "${B}" in row`,X)}else console.warn(`No column or body key mapping found for tab: ${G}`)},P=G=>{c(X=>{const ee=new Set(X);return ee.has(G)?ee.delete(G):ee.add(G),ee})},V=(G,X=0,ee="")=>{const de=ee?`${ee}.${G.name}`:G.name,B=d.has(de);return e.jsxs(Ze.Fragment,{children:[e.jsxs("tr",{className:`${B?"bg-gray-100":"bg-white"}`,children:[e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm flex items-center",children:e.jsxs("div",{style:{marginLeft:`${X*20}px`},onClick:()=>P(de),className:"flex items-center cursor-pointer",children:[G.subcategories.length>0&&e.jsx("button",{className:"mr-2",children:B?e.jsx(is,{className:"h-4 w-4"}):e.jsx(xs,{className:"h-4 w-4"})}),G.name]})}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm cursor-pointer text-blue-500 underline",onClick:()=>f(l,G),children:G.metrics.products}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:G.metrics.totalCost}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:G.metrics.ROAS}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:G.metrics.conversions}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:G.metrics.ConversionValue}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:G.metrics.ConversionRate}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:G.metrics.totalClicks}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:G.metrics.ctr}),e.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:G.metrics.AvgCPC})]}),B&&G.subcategories.map(q=>V(q,X+1,de))]},de)},Z=G=>{u===G?L(X=>X==="asc"?"desc":"asc"):(I(G),L("asc"))},k=()=>{const G=a.find(B=>B.id===l);if(!G||G.id==="categories")return{columns:[],data:[]};let X=G.data;u&&(X=[...X].sort((B,q)=>{const me=B[u],Ne=q[u];if(typeof me=="number"&&typeof Ne=="number")return i==="asc"?me-Ne:Ne-me;const we=String(me||"").toLowerCase(),Be=String(Ne||"").toLowerCase();return we<Be?i==="asc"?-1:1:we>Be?i==="asc"?1:-1:0}));const ee=(m-1)*A,de=ee+A;return{columns:G.columns,data:X.slice(ee,de)}},{columns:j,data:E}=k(),R=Math.ceil((((O=a.find(G=>G.id===l))==null?void 0:O.data.length)||0)/A),Y=[{id:"name",header:"Name"},{id:"products",header:"Products"},{id:"totalCost",header:"Cost"},{id:"ROAS",header:"ROAS"},{id:"conversions",header:"Conversions"},{id:"ConversionValue",header:"Conv. Value"},{id:"ConversionRate",header:"Conv. Rate"},{id:"totalClicks",header:"Clicks"},{id:"ctr",header:"CTR"},{id:"AvgCPC",header:"Avg CPC"}];function W(){return e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full table-auto border-collapse",children:[e.jsx("thead",{children:e.jsx("tr",{children:["w-24","w-32","w-32","w-24","w-24","w-24"].map((G,X)=>e.jsx("th",{className:"px-4 py-2 border-b",children:e.jsx(Oe,{className:`h-4 ${G}`})},X))})}),e.jsx("tbody",{children:Array.from({length:8}).map((G,X)=>e.jsx("tr",{children:["w-24","w-32","w-32","w-24","w-24","w-24"].map((ee,de)=>e.jsx("td",{className:"px-4 py-2 border-b",children:e.jsx(Oe,{className:`h-4 ${ee}`})},de))},X))})]})})}return e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex flex-row gap-2 items-center mb-4",children:[e.jsx(Xe,{}),e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Google Ads Product Insights"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 pb-2 mb-2",children:[e.jsx("div",{className:"flex space-x-2",role:"tablist",children:a.map(G=>e.jsxs(D,{variant:l===G.id?"default":"ghost",onClick:()=>_(G.id),className:"relative",children:[G.id==="products"&&e.jsx(gr,{className:"w-4 h-4 mr-2"}),G.id==="categories"&&e.jsx(Bt,{className:"w-4 h-4 mr-2"}),G.id==="brands"&&e.jsx(ot,{className:"w-4 h-4 mr-2"}),G.id==="productTypes"&&e.jsx(to,{className:"w-4 h-4 mr-2"}),G.label,l===G.id&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600"})]},G.id))}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(be,{}),e.jsx(D,{variant:"outline",size:"icon",children:e.jsx(ks,{className:`h-4 w-4 ${x?"text-blue-600":"text-gray-600"}`})}),e.jsx(Ga,{children:e.jsxs(_a,{children:[e.jsx(Ba,{asChild:!0,children:e.jsx(D,{variant:"outline",size:"icon",onClick:()=>T(l,{},!1),children:e.jsx(fe,{className:`h-4 w-4 ${p?"animate-spin":""}`})})}),((J=a.find(G=>G.id===l))==null?void 0:J.lastUpdated)&&e.jsx(Va,{children:e.jsxs("p",{children:["Last updated: ",new Date(((se=a.find(G=>G.id===l))==null?void 0:se.lastUpdated)||0).toLocaleString()]})})]})})]})]}),e.jsxs("div",{className:"space-y-4",children:[x&&e.jsxs("div",{className:"flex items-center gap-2 w-fit p-2 bg-blue-50 rounded-full",children:[e.jsx("span",{className:"text-xs font-medium text-blue-700",children:Object.entries(y).map(([G,X])=>`${G}: ${X}`).join(", ")}),e.jsx(D,{variant:"ghost",size:"sm",onClick:()=>{S(!1),b({}),o("products"),$.current.products=null,T("products",{},!1)},className:"text-blue-700 hover:text-blue-800 hover:bg-blue-100 p-1 h-auto",children:e.jsx(rs,{className:"h-3 w-3"})})]}),e.jsxs("div",{className:"rounded-md border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"max-h-[350px] overflow-auto",children:p?e.jsx(W,{}):e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"sticky top-0 z-10 bg-[#4A628A]",children:e.jsx("tr",{children:(l==="categories"?Y:j).map(G=>e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-50 uppercase tracking-wider min-w-[150px] cursor-pointer",onClick:()=>Z(G.id),children:e.jsxs("div",{className:"flex items-center gap-1",children:[G.header,u===G.id?i==="asc"?e.jsx(Ms,{className:"h-4 w-4"}):e.jsx(Ts,{className:"h-4 w-4"}):e.jsx(vt,{className:"h-4 w-4"})]})},G.id))})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[l==="categories"?(Q=a.find(G=>G.id==="categories"))==null?void 0:Q.data.map(G=>V(G)):E.map((G,X)=>e.jsx("tr",{className:"hover:bg-gray-50",children:j.map(ee=>{const de=ee.cell(G[ee.accessorKey]),B=ee.id==="issues",q=ee.id==="Products",me=ee.id==="status",Ne=typeof de=="string"&&de.trim().toLowerCase()==="no issues",we=K=>{switch(K.trim().toUpperCase()){case"UNSPECIFIED":return"bg-gray-100 text-gray-800";case"UNKNOWN":return"bg-yellow-100 text-yellow-800";case"NOT_ELIGIBLE":return"bg-red-100 text-red-800";case"ELIGIBLE_LIMITED":return"bg-orange-100 text-orange-800";case"ELIGIBLE":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-700"}},Be=()=>{if(B)return e.jsxs("div",{className:`flex items-center ${Ne?"text-green-600":"text-red-600"}`,children:[Ne?e.jsx(ao,{className:"w-4 h-4 mr-2"}):e.jsx(Gt,{className:"w-4 h-4 mr-2"}),de]});if(me){const K=de?String(de):"",ne=we(K);return e.jsx("div",{className:`px-2 py-1.5 rounded-full text-xs font-medium w-full ${ne} cursor-pointer`,onClick:()=>f(l,G),children:K})}return ee.cell?ee.cell(de):de};return e.jsx("td",{className:`px-4 py-2.5 text-sm whitespace-nowrap min-w-[150px] ${q?"cursor-pointer text-blue-600 hover:text-blue-800":""}`,onClick:()=>q&&f(l,G),children:Be()},ee.id)})},X)),(l==="categories"?((re=a.find(G=>G.id==="categories"))==null?void 0:re.data.length)===0:E.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:(l==="categories"?Y:j).length,className:"px-4 py-2 text-sm text-gray-500 text-center",children:"No data available"})})]})]})}),e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gray-50 border-t border-gray-200",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",(m-1)*A+1," to ",Math.min(m*A,((xe=a.find(G=>G.id===l))==null?void 0:xe.data.length)||0)," of ",((U=a.find(G=>G.id===l))==null?void 0:U.data.length)||0," entries"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(D,{variant:"outline",size:"sm",onClick:()=>h(G=>Math.max(G-1,1)),disabled:m===1,children:[e.jsx(Ps,{className:"h-4 w-4 mr-1"}),"Previous"]}),e.jsxs("div",{className:"text-sm text-gray-700",children:["Page ",m," of ",R]}),e.jsxs(D,{variant:"outline",size:"sm",onClick:()=>h(G=>Math.min(G+1,R)),disabled:m===R,children:["Next",e.jsx(xs,{className:"h-4 w-4 ml-1"})]})]})]})]})]})]})]})}const Me=()=>e.jsxs(Jt,{className:"text-center min-w-full",children:[e.jsx(Xt,{className:"bg-gray-200 sticky top-0 z-10",children:e.jsx(Us,{children:Array(8).fill(0).map((s,r)=>e.jsx(Ye,{className:"font-bold px-4 text-black min-w-[150px]",children:e.jsx(Oe,{className:"h-6 w-full"})},r))})}),e.jsx(ea,{children:Array(10).fill(0).map((s,r)=>e.jsx(Us,{children:Array(8).fill(0).map((a,n)=>e.jsx(Ye,{className:"px-4 py-2 max-w-[200px]",children:e.jsx(Oe,{className:"h-6 w-full"})},n))},r))})]});function ri(){var se;const s="https://parallels.messold.com",{brandId:r}=ge(),[a,n]=t.useState([]),[l,o]=t.useState(!0),[m,h]=t.useState(1),[d,c]=t.useState(!0),[p,C]=t.useState(0),[x,S]=t.useState(0),[A,y]=t.useState([]),[b,$]=t.useState("all"),[v,w]=t.useState([]),[g,F]=t.useState("all"),[M,N]=t.useState("all"),u=z(Q=>Q.date.from),I=z(Q=>Q.date.to),i=t.useMemo(()=>({from:u,to:I}),[u,I]),L=i!=null&&i.from?H(i.from,"yyyy-MM-dd"):"",_=i!=null&&i.to?H(i.to,"yyyy-MM-dd"):"",T=100,f=[{id:"searchTerm",header:"Search Term",icon:e.jsx(Ws,{className:"w-4 h-4"})},{id:"matchType",header:"Match Type",icon:e.jsx(ro,{className:"w-4 h-4"})},{id:"status",header:"Status",icon:e.jsx(ks,{className:"w-4 h-4"})},{id:"campaignName",header:"Campaign Name",icon:e.jsx(no,{className:"w-4 h-4"})},{id:"adGroupName",header:"Ad Group",icon:e.jsx(_t,{className:"w-4 h-4"})},{id:"cost",header:"Cost",icon:e.jsx(pr,{className:"w-4 h-4"})},{id:"conversions",header:"Conversions",icon:e.jsx(ir,{className:"w-4 h-4"})},{id:"conversionsValue",header:"Conv. Value",icon:e.jsx(tt,{className:"w-4 h-4"})},{id:"conversionsRate",header:"Conv. Rate",icon:e.jsx(oa,{className:"w-4 h-4"})},{id:"clicks",header:"Clicks",icon:e.jsx(oo,{className:"w-4 h-4"})},{id:"ctr",header:"CTR",icon:e.jsx(oa,{className:"w-4 h-4"})},{id:"avg_cpc",header:"Avg. CPC",icon:e.jsx(lo,{className:"w-4 h-4"})}],[P,V]=t.useState(null),[Z,k]=t.useState("asc"),j=Q=>{P===Q?k(re=>re==="asc"?"desc":"asc"):(V(Q),k("asc"))},E=t.useMemo(()=>P?[...a].sort((Q,re)=>{const xe=Q[P],U=re[P];if(typeof xe=="number"&&typeof U=="number")return Z==="asc"?xe-U:U-xe;const G=String(xe).toLowerCase(),X=String(U).toLowerCase();return G<X?Z==="asc"?-1:1:G>X?Z==="asc"?1:-1:0}):a,[a,P,Z]),R=t.useCallback(async()=>{o(!0);try{const Q={limit:T,page:m,startDate:L,endDate:_,...b&&b!=="all"&&{campaign:b},...g&&g!=="all"&&{adGroup:g},...M&&M!=="all"&&{status:M}},{data:re}=await ve.post(`${s}/api/segment/searchTermMetrics/${r}`,Q,{withCredentials:!0});re.success?(n(re.data),C(re.totalRecords),S(re.totalPages),c(m*T<re.totalRecords),y(re.campaignAdGroupPairs),w(re.statusOptions)):console.error("Failed to fetch search term metrics:",re.message)}catch(Q){console.error("Error fetching search term metrics:",Q)}finally{o(!1)}},[s,r,m,T,b,g,M,L,_]);t.useEffect(()=>{R();const Q=setInterval(R,3e5);return()=>clearInterval(Q)},[R]);const Y=Q=>{$(Q),F("all"),h(1)},W=Q=>{F(Q),h(1)},O=Q=>{N(Q),h(1)},J=b!=="all"?((se=A==null?void 0:A.find(Q=>Q.campaignName===b))==null?void 0:se.adGroups)||[]:[];return e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex flex-row gap-2 items-center mb-4",children:[e.jsx(Xe,{}),e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Google Ads Search Term Insights"})]}),e.jsx("div",{className:"bg-white rounded-xl overflow-hidden border border-gray-200 shadow-md",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between mb-4",children:[e.jsxs(Is,{children:[e.jsx(Fs,{asChild:!0,children:e.jsxs(D,{variant:"outline",className:"bg-white border-gray-300 hover:bg-gray-50 transition-colors duration-200",children:[e.jsx(ks,{className:"w-4 h-4 mr-2"}),"Filter"]})}),e.jsx(Cs,{className:"w-80",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Status"}),e.jsxs(qe,{onValueChange:O,value:M,children:[e.jsx(We,{className:"w-full",children:e.jsx(Je,{placeholder:"Select Status"})}),e.jsxs(Ke,{children:[e.jsx(Te,{value:"all",children:"All Status"}),v.map(Q=>e.jsx(Te,{value:Q,children:Q},Q))]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Campaign"}),e.jsxs(qe,{onValueChange:Y,value:b,children:[e.jsx(We,{className:"w-full",children:e.jsx(Je,{placeholder:"Select Campaign"})}),e.jsxs(Ke,{children:[e.jsx(Te,{value:"all",children:"All Campaigns"}),A.map(Q=>e.jsx(Te,{value:Q.campaignName,children:Q.campaignName},Q.campaignName))]})]})]}),b!=="all"&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Ad Group"}),e.jsxs(qe,{disabled:b==="all",onValueChange:W,value:g,children:[e.jsx(We,{className:"w-full",children:e.jsx(Je,{placeholder:"Select Ad Group"})}),e.jsxs(Ke,{children:[e.jsx(Te,{value:"all",children:"All Ad Groups"}),J.map(Q=>e.jsx(Te,{value:Q,children:Q},Q))]})]})]})]})})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(be,{}),e.jsxs(D,{variant:"outline",className:"bg-gray-50 text-gray-600 border-gray-200 hover:bg-gray-100",onClick:R,children:[e.jsx(fe,{className:"w-4 h-4 mr-2"}),"Refresh"]})]})]}),e.jsxs("div",{className:"rounded-md border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"max-h-[380px] overflow-auto rounded-lg",children:l?e.jsx(Me,{}):e.jsxs("table",{className:"w-full text-center",children:[e.jsx("thead",{className:"sticky top-0 z-10 bg-[#4A628A] rounded-t-lg",children:e.jsx("tr",{children:f.map(Q=>e.jsx("th",{className:"px-4 py-3 text-xs font-medium text-gray-50 uppercase tracking-wider min-w-[200px] cursor-pointer",onClick:()=>j(Q.id),children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[Q.icon,Q.header,P===Q.id?Z==="asc"?e.jsx(Ms,{className:"ml-1 w-4 h-6 text-[#ffffff]"}):e.jsx(Ts,{className:"ml-1 w-4 h-6 text-[#ffffff]"}):e.jsx(vt,{className:"ml-1 w-4 h-6 text-gray-300"})]})},Q.id))})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[E.map((Q,re)=>e.jsx("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:f.map(xe=>{const U=Q[xe.id],G=xe.id==="status",X=xe.id==="searchTerm",ee=()=>{if(G){const de=U?String(U):"",q=(me=>{switch(me.trim().toUpperCase()){case"ADDED":return"bg-green-100 text-green-800";case"NONE":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}})(de);return e.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${q}`,children:de})}if(X){const de=U?String(U):"",B=Q.performance,q=B==="Best Performing Keyword";return e.jsxs("div",{className:"px-2 py-1 rounded-full font-medium flex flex-col items-center",children:[e.jsx("span",{className:`text-xs ${q?"text-green-600":"text-red-600"}`,children:B}),e.jsx("span",{className:"text-sm mt-1",children:de})]})}return U};return e.jsx("td",{className:"px-4 py-2.5 text-sm min-w-[200px]",children:ee()},xe.id)})},re)),a.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:f.length,className:"px-4 py-2 text-sm text-gray-500 text-center",children:"No data available"})})]})]})}),e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-gray-50",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",(m-1)*T+1," to"," ",Math.min(m*T,p||0)," of"," ",p||0," entries"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(D,{variant:"outline",size:"sm",onClick:()=>h(Q=>Math.max(Q-1,1)),disabled:m===1,className:"text-gray-600 border-gray-200 hover:bg-gray-50",children:[e.jsx(Ps,{className:"h-4 w-4 mr-1"}),"Previous"]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Page ",m," of ",x]}),e.jsxs(D,{variant:"outline",size:"sm",onClick:()=>h(Q=>Q+1),disabled:!d,className:"text-gray-600 border-gray-200 hover:bg-gray-50",children:["Next",e.jsx(xs,{className:"h-4 w-4 ml-1"})]})]})]})]})]})})]})}const st={totalConversions:"Total Conversions",totalClicks:"Total Clicks",totalCost:"Total Cost",totalCTR:"Total C T R"},ys=100;function ni(){var ee,de;const s="https://parallels.messold.com",{brandId:r}=ge();if(!r)return e.jsx("div",{children:"Error: Brand ID is missing"});const[a,n]=t.useState({campaign:"all",adGroup:"all",ageRange:"all",gender:"all",status:"all",campaignStatus:"all"}),[l,o]=t.useState({campaigns:[],adGroups:[],ageRanges:[],genders:[],campaignAdGroupMap:{},statusOptions:["REMOVED","PAUSED","ENABLED"]}),[m,h]=t.useState([]),[d,c]=t.useState([{id:"age",label:"Age",apiEndpoint:`${s}/api/segment/ageMetrics/${r}`,columns:[],data:[],lastUpdated:null,totalPages:1,currentPage:1},{id:"gender",label:"Gender",apiEndpoint:`${s}/api/segment/genderMetrics/${r}`,columns:[],data:[],lastUpdated:null,totalPages:1,currentPage:1}]),[p,C]=t.useState(1),[x,S]=t.useState(0),[A,y]=t.useState(!0),[b,$]=t.useState(d[0].id),[v,w]=t.useState(1),[g,F]=t.useState(!1),[M,N]=t.useState(!1),[u,I]=t.useState(null),[i,L]=t.useState(["totalClicks","totalCost"]),_=z(B=>B.date.from),T=z(B=>B.date.to),f=t.useMemo(()=>({from:_,to:T}),[_,T]),P=B=>{L(q=>q.includes(B)?q.filter(me=>me!==B):[...q,B])},[V,Z]=t.useState([]),[k,j]=t.useState([]),E=async(B,q,me)=>{var Ne,we,Be;try{F(!0);const K=B==="gender"?`${s}/api/segment/genderMetrics/${r}`:`${s}/api/segment/ageMetrics/${r}`,ne={startDate:(q==null?void 0:q.startDate)||(f!=null&&f.from?H(f.from,"yyyy-MM-dd"):""),endDate:(q==null?void 0:q.endDate)||(f!=null&&f.to?H(f.to,"yyyy-MM-dd"):""),page:(q==null?void 0:q.page)||v,limit:(q==null?void 0:q.limit)||ys,...(q==null?void 0:q.status)&&{status:q.status},...(q==null?void 0:q.campaign)&&q.campaign!=="all"&&{campaign:q.campaign},...(q==null?void 0:q.adGroup)&&q.adGroup!=="all"&&{adGroup:q.adGroup},...b==="age"&&(q==null?void 0:q.agerange)&&q.agerange!=="all"&&{agerange:q.agerange},...b==="gender"&&(q==null?void 0:q.gender)&&q.gender!=="all"&&{gender:q.gender}};console.log("Fetch Request Body:",ne);const te=await ve.post(K,ne,{withCredentials:!0}),oe=((Ne=te.data.genderCampaignAdGroupPairs)==null?void 0:Ne.map(he=>he.campaignName))||[];if(te.data.success){const he=[...((we=te.data.campaignAdGroupPairs)==null?void 0:we.map(ye=>ye.campaignName))||[],...((Be=te.data.campaignAdGroupPairs)==null?void 0:Be.map(ye=>ye.campaignName))||[],...oe],ie={},Ce=[...te.data.campaignAdGroupPairs||[],...te.data.genderCampaignAdGroupPairs||[]];Ce.forEach(ye=>{ie[ye.campaignName]=ye.adGroups||[]});const Ee=Array.from(new Set(Ce.flatMap(ye=>ye.adGroups||[])));o(ye=>({...ye,campaigns:Array.from(new Set(he)),adGroups:Ee,campaignAdGroupMap:ie}));const Ge=B==="gender"?te.data.genderData||[]:te.data.ageData||[];if(B==="age"){const ye=new Set(Ge.map(Fe=>Fe.ageRange));V.length===0&&Z(Array.from(ye)),o(Fe=>({...Fe,ageRanges:V.length>0?V:Array.from(ye),genders:Fe.genders}))}else{const ye=new Set(Ge.map(Fe=>Fe.gender==="MALE"?"MALE":Fe.gender==="FEMALE"?"FEMALE":Fe.gender));k.length===0&&j(Array.from(ye)),o(Fe=>({...Fe,campaigns:[...new Set([...he,...oe])],genders:k.length>0?k:Array.from(ye)}))}h(Ge);const $e=Ge.length>0?Object.keys(Ge[0]||{}).filter(ye=>ye!=="adGroupStatus").map(ye=>({id:ye,header:ye==="campaignStatus"?"Campaign Status":ye.replace(/([A-Z])/g," $1").replace(/^./,Fe=>Fe.toUpperCase()),accessorKey:ye,cell:Fe=>{if(ye==="cost")return`$${Number(Fe).toFixed(2)}`;if(["roas","conversionsRate","ctr"].includes(ye))return`${(Number(Fe)*100).toFixed(2)}%`;if(ye==="campaignStatus"){const Ct={REMOVED:"text-red-600",PAUSED:"text-yellow-600",ENABLED:"text-green-600"}[Fe]||"";return e.jsx("span",{className:`font-medium ${Ct}`,children:Fe==="REMOVED"?"Removed":Fe==="PAUSED"?"Paused":Fe==="ENABLED"?"Enabled":Fe})}return String(Fe)}})):[];c(ye=>ye.map(Fe=>Fe.id===B?{...Fe,columns:$e,data:Ge,lastUpdated:Date.now()}:Fe));const ze=B==="gender"?te.data.aggregatedRecords:te.data.ageRangeAggregatedMetrics;console.log("Aggregated Data:",ze),console.log("Response Data afterfilter test:",te.data);const ms=Object.entries(ze||{}).map(([ye,Fe])=>{const Ct=B==="gender"?ye==="MALE"?"Male":ye==="FEMALE"?"Female":ye:ye,sa={[B==="gender"?"gender":"ageRange"]:Ct};if(Fe&&typeof Fe=="object"&&!Array.isArray(Fe)){const qs=Fe;return{...sa,totalConversions:qs.totalConversions||0,totalClicks:qs.totalClicks||0,totalCost:qs.totalCost||0,totalCTR:qs.totalCTR||0}}return sa});console.log("Processed Graph Data:",ms),I(ms),S(te.data.totalRecords||0),C(te.data.totalPages||1),y(v*ys<te.data.totalRecords)}}catch(K){console.error("Error fetching data:",K),I(null)}finally{F(!1)}},R=(B,q)=>{n(Ne=>{const we={...Ne,[B]:q};return B==="campaign"&&(we.adGroup="all"),we});const me={startDate:f!=null&&f.from?H(f.from,"yyyy-MM-dd"):"",endDate:f!=null&&f.to?H(f.to,"yyyy-MM-dd"):"",page:1,limit:ys,status:a.status==="all"?void 0:a.status,campaign:a.campaign==="all"?void 0:a.campaign,adGroup:a.adGroup==="all"?void 0:a.adGroup,...b==="age"&&a.ageRange!=="all"&&{agerange:a.ageRange},...b==="gender"&&a.gender!=="all"&&{gender:a.gender}};I(null),E(b,me)};t.useEffect(()=>{const B={startDate:f!=null&&f.from?H(f.from,"yyyy-MM-dd"):"",endDate:f!=null&&f.to?H(f.to,"yyyy-MM-dd"):"",page:v,limit:ys,status:a.status==="all"?void 0:a.status,campaign:a.campaign==="all"?void 0:a.campaign,adGroup:a.adGroup==="all"?void 0:a.adGroup,...b==="age"&&a.ageRange!=="all"&&{agerange:a.ageRange},...b==="gender"&&a.gender!=="all"&&{gender:a.gender}};I(null),console.log("UseEffect Fetch Request:",{activeTab:b,filters:a,requestBody:B}),E(b,B);const q=setInterval(()=>{E(b,B)},3e5);return()=>clearInterval(q)},[b,f,v,a.campaign,a.adGroup,a.ageRange,a.gender,a.status]);const Y=B=>{$(B),w(1);const q={startDate:f!=null&&f.from?H(f.from,"yyyy-MM-dd"):"",endDate:f!=null&&f.to?H(f.to,"yyyy-MM-dd"):"",page:1,limit:ys};E(B,q)},W=["campaignName","adGroupName","campaignStatus","ageRange","conversionsValue","conversionsRate","avg_cpc","cost","roas","conversions","clicks","ctr"],[O,J]=t.useState(null),[se,Q]=t.useState("asc"),re=B=>{O===B?Q(q=>q==="asc"?"desc":"asc"):(J(B),Q("asc"))},{columns:xe}=(()=>{const B=d.find(q=>q.id===b);return B?{columns:B.columns}:{columns:[]}})(),U=t.useMemo(()=>O?[...m].sort((B,q)=>{const me=B[O],Ne=q[O];if(typeof me=="number"&&typeof Ne=="number")return se==="asc"?me-Ne:Ne-me;const we=String(me||"").toLowerCase(),Be=String(Ne||"").toLowerCase();return we<Be?se==="asc"?-1:1:we>Be?se==="asc"?1:-1:0}):m,[m,O,se]),G=B=>{const q=Math.min(Math.max(1,B),p);w(q);const me={startDate:f!=null&&f.from?H(f.from,"yyyy-MM-dd"):"",endDate:f!=null&&f.to?H(f.to,"yyyy-MM-dd"):"",page:q,limit:ys};E(b,me)},X=["#8884d8","#82ca9d","#ffc658","#ff7300"];return e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex flex-row gap-2 items-center mb-4",children:[e.jsx(Xe,{}),e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Age and Gender Metrics"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 pb-2 mb-2",children:[e.jsx("div",{className:"flex space-x-2",role:"tablist",children:d.map(B=>e.jsxs(D,{variant:b===B.id?"default":"ghost",onClick:()=>Y(B.id),className:"relative",children:[B.id==="age"?e.jsx(gr,{className:"w-4 h-4 mr-2"}):e.jsx(Bt,{className:"w-4 h-4 mr-2"}),B.label,b===B.id&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600"})]},B.id))}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(be,{}),M&&e.jsx("div",{className:"flex gap-2",children:Object.keys(st).map(B=>e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:i.includes(B),onChange:()=>P(B)}),e.jsx("span",{className:"text-sm text-gray-700",children:st[B]})]},B))}),e.jsx(D,{variant:"outline",size:"icon",onClick:()=>{const B={startDate:f!=null&&f.from?H(f.from,"yyyy-MM-dd"):"",endDate:f!=null&&f.to?H(f.to,"yyyy-MM-dd"):"",page:1,limit:1e3};E(b,B)},disabled:g,children:e.jsx(fe,{className:"h-4 w-4 "})}),e.jsx(D,{variant:"outline",onClick:()=>N(!M),children:M?"Show Table":"Show Graph"}),e.jsxs(Is,{children:[e.jsx(Fs,{asChild:!0,children:e.jsxs(D,{variant:"outline",className:"bg-white border-gray-300 hover:bg-gray-50 transition-colors duration-200",children:[e.jsx(ks,{className:"w-4 h-4 mr-2"}),"Filter"]})}),e.jsx(Cs,{className:"w-80",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Campaign"}),e.jsxs(qe,{onValueChange:B=>R("campaign",B),value:a.campaign,children:[e.jsx(We,{children:e.jsx(Je,{placeholder:"Select campaign"})}),e.jsxs(Ke,{children:[e.jsx(Te,{value:"all",children:"All"}),l.campaigns.map(B=>e.jsx(Te,{value:B,children:B},B))]})]})]}),a.campaign!=="all"&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Ad Group"}),e.jsxs(qe,{onValueChange:B=>R("adGroup",B),value:a.adGroup,children:[e.jsx(We,{children:e.jsx(Je,{placeholder:"Select ad group"})}),e.jsxs(Ke,{children:[e.jsx(Te,{value:"all",children:"All Ad Groups"}),(de=((ee=l.campaignAdGroupMap)==null?void 0:ee[a.campaign])||(b==="gender"?l.adGroups.filter(()=>{if(l&&l.campaignAdGroupMap){const B=Object.keys(l.campaignAdGroupMap).find(()=>{var q,me;return(me=(q=l.campaignAdGroupMap)==null?void 0:q[a.campaign])==null?void 0:me.some(Ne=>{var we,Be;return(Be=(we=l.campaignAdGroupMap)==null?void 0:we[a.campaign])==null?void 0:Be.includes(Ne)})});return B&&l.campaigns.includes(B)}return!1}):l.adGroups))==null?void 0:de.map(B=>e.jsx(Te,{value:B,children:B},B))]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Status"}),e.jsxs(qe,{onValueChange:B=>R("status",B),value:a.status,children:[e.jsx(We,{children:e.jsx(Je,{placeholder:"Select status"})}),e.jsxs(Ke,{children:[e.jsx(Te,{value:"all",children:"All"}),l.statusOptions.map(B=>e.jsx(Te,{value:B,children:B},B))]})]})]}),b==="age"&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Age Range"}),e.jsxs(qe,{onValueChange:B=>R("ageRange",B),value:a.ageRange,children:[e.jsx(We,{children:e.jsx(Je,{placeholder:"Select age range"})}),e.jsxs(Ke,{children:[e.jsx(Te,{value:"all",children:"All"}),l.ageRanges.map(B=>e.jsx(Te,{value:B,children:B.replace("AGE_RANGE_","").replace(/_/g,"-")},B))]})]})]}),b==="gender"&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Gender"}),e.jsxs(qe,{onValueChange:B=>R("gender",B),value:a.gender,children:[e.jsx(We,{children:e.jsx(Je,{placeholder:"Select gender"})}),e.jsxs(Ke,{children:[e.jsx(Te,{value:"all",children:"All"}),l.genders.map(B=>e.jsx(Te,{value:B,children:B==="MALE"?"Male":B==="FEMALE"?"Female":B},B))]})]})]})]})})]})]})]}),e.jsx("div",{className:"space-y-4",children:g?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-blue-500"})}):M?b==="age"&&u?e.jsx(lt,{width:"100%",height:300,children:e.jsxs(It,{data:u,children:[e.jsx(da,{strokeDasharray:"3 3"}),e.jsx(it,{dataKey:"ageRange"}),e.jsx(ct,{}),e.jsx(Ft,{}),e.jsx(ma,{}),i.map((B,q)=>e.jsx(dt,{dataKey:B,fill:X[q%X.length],name:st[B]},B))]})}):b==="gender"&&u?e.jsx(lt,{width:"100%",height:300,children:e.jsxs(It,{data:u,children:[e.jsx(da,{strokeDasharray:"3 3"}),e.jsx(it,{dataKey:"gender"}),e.jsx(ct,{}),e.jsx(Ft,{}),e.jsx(ma,{}),i.map((B,q)=>e.jsx(dt,{dataKey:B,fill:X[q%X.length],name:st[B]},B))]})}):null:e.jsxs("div",{className:"rounded-md border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"max-h-[350px] overflow-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"sticky top-0 z-10 bg-[#4A628A]",children:e.jsx("tr",{children:xe.map(B=>e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-50 uppercase tracking-wider min-w-[150px] cursor-pointer",onClick:()=>W.includes(B.id)&&re(B.id),children:e.jsxs("div",{className:"flex items-center gap-1",children:[B.header,W.includes(B.id)&&(O===B.id?se==="asc"?e.jsx(Ms,{className:"ml-1 w-4 h-6 text-[#ffffff]"}):e.jsx(Ts,{className:"ml-1 w-4 h-6 text-[#ffffff]"}):e.jsx(vt,{className:"ml-1 w-4 h-6 text-gray-300"}))]})},B.id))})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[U.map((B,q)=>e.jsx("tr",{className:"hover:bg-gray-50",children:xe.map(me=>e.jsx("td",{className:"px-4 py-2.5 text-sm whitespace-nowrap min-w-[150px]",children:me.cell(B[me.accessorKey])},me.id))},q)),U.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:xe.length,className:"px-4 py-4 text-center text-gray-500",children:"No data available"})})]})]})}),e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-white border-t border-gray-200",children:[e.jsx("div",{className:"text-sm text-gray-700",children:U.length>0?`Showing ${(v-1)*ys+1} to ${Math.min(v*ys,x)} of ${x} entries`:"Showing 0 entries"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(D,{variant:"outline",size:"sm",onClick:()=>G(v-1),disabled:v===1,children:[e.jsx(Ps,{className:"h-4 w-4 mr-1"}),"Previous"]}),e.jsxs("div",{className:"text-sm text-gray-700",children:["Page ",v," of ",p]}),e.jsxs(D,{variant:"outline",size:"sm",onClick:()=>G(v+1),disabled:!A,children:["Next",e.jsx(xs,{className:"h-4 w-4 ml-1"})]})]})]})]})})]})]})}const cs=An,ds=kn,oi=t.forwardRef(({className:s,inset:r,children:a,...n},l)=>e.jsxs(Ja,{ref:l,className:ae("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r&&"pl-8",s),...n,children:[a,e.jsx(Pa,{className:"ml-auto"})]}));oi.displayName=Ja.displayName;const li=t.forwardRef(({className:s,...r},a)=>e.jsx(Xa,{ref:a,className:ae("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...r}));li.displayName=Xa.displayName;const ns=t.forwardRef(({className:s,sideOffset:r=4,...a},n)=>e.jsx(Cn,{children:e.jsx(er,{ref:n,sideOffset:r,className:ae("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...a})}));ns.displayName=er.displayName;const _e=t.forwardRef(({className:s,inset:r,...a},n)=>e.jsx(sr,{ref:n,className:ae("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",r&&"pl-8",s),...a}));_e.displayName=sr.displayName;const ii=t.forwardRef(({className:s,children:r,checked:a,...n},l)=>e.jsxs(tr,{ref:l,className:ae("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:a,...n,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(ar,{children:e.jsx(Lt,{className:"h-4 w-4"})})}),r]}));ii.displayName=tr.displayName;const ci=t.forwardRef(({className:s,children:r,...a},n)=>e.jsxs(rr,{ref:n,className:ae("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(ar,{children:e.jsx(Sn,{className:"h-2 w-2 fill-current"})})}),r]}));ci.displayName=rr.displayName;const di=t.forwardRef(({className:s,inset:r,...a},n)=>e.jsx(nr,{ref:n,className:ae("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",s),...a}));di.displayName=nr.displayName;const mi=t.forwardRef(({className:s,...r},a)=>e.jsx(or,{ref:a,className:ae("-mx-1 my-1 h-px bg-muted",s),...r}));mi.displayName=or.displayName;const ya=(s,r)=>s>r?"bg-green-100 text-green-800":s<r?"bg-red-50 text-red-800":(Math.abs(s-r)<1e-4,"bg-yellow-100 text-yellow-700"),ui=({columns:s=[],data:r=[],allTimeData:a=[],isFullScreen:n})=>{const[l,o]=t.useState(null),[m,h]=t.useState("asc"),[d,c]=t.useState(null),[p,C]=t.useState(null),[x,S]=t.useState([]),[A,y]=t.useState(null),[b,$]=t.useState(1),[v,w]=t.useState([]),g=30,F=10,M=s[0]==="Date",N=t.useRef(null),u=t.useRef(null),I=t.useRef(!1),i=t.useRef(r),L=t.useRef([]),_=["Add To Cart Rate","Checkout Rate","Purchase Rate","Sessions"],T=U=>parseFloat(U==null?void 0:U.replace("%","").trim())||0;t.useEffect(()=>{if(!I.current&&N.current&&u.current){const U=N.current.querySelectorAll("thead th"),G=Array.from(U).map(X=>Math.max(100,X.clientWidth));S(G),I.current=!0}},[]),t.useEffect(()=>{const U=()=>{if(N.current&&u.current&&I.current){const G=N.current.querySelectorAll("thead th"),X=Array.from(G).map((ee,de)=>Math.max(100,x[de]||ee.clientWidth));S(X)}};return window.addEventListener("resize",U),()=>window.removeEventListener("resize",U)},[x]);const f=t.useMemo(()=>{const U={};return _.forEach(G=>{const X=r.filter(de=>de[G]!==void 0&&!isNaN(T(de[G]||"0"))),ee=X.length>0?X.reduce((de,B)=>de+T(B[G]||"0"),0)/X.length:0;U[G]=G==="Sessions"?Math.round(ee):parseFloat(ee.toFixed(2))}),U},[r]),P=t.useMemo(()=>{const U={};return _.forEach(G=>{if(a){const X=a.filter(ee=>ee[G]!==void 0&&!isNaN(T(ee[G]||"0")));U[G]=X.length>0?X.reduce((ee,de)=>ee+T(de[G]||"0"),0)/X.length:0}else U[G]=0}),U},[a]),V=t.useMemo(()=>s[0]==="Date"?r.map(()=>({currentLabel:null,allTimeLabel:null})):r.map(U=>{if(!U||!_.every(me=>U[me]!==void 0))return{currentLabel:null,allTimeLabel:null};const G=_.some(me=>{const Ne=T(U[me]||"0"),we=f[me];return Ne>we}),X=_.every(me=>{const Ne=T(U[me]||"0"),we=f[me];return Ne<we}),ee=G?"Current Top":X?"Current Worst":"",de=_.some(me=>{const Ne=T(U[me]||"0"),we=P[me];return Ne>we}),B=_.every(me=>{const Ne=T(U[me]||"0"),we=P[me];return Ne<we});return{currentLabel:ee,allTimeLabel:de?"All Time Top":B?"All Time Worst":""}}),[r,a,f,P,s]),Z=(U,G)=>{y(U);const X=G.pageX,ee=x[U],de=q=>{const me=q.pageX-X,Ne=Math.max(100,ee+me),we=[...x];we[U]=Ne,S(we)},B=()=>{y(null),document.removeEventListener("mousemove",de),document.removeEventListener("mouseup",B)};document.addEventListener("mousemove",de),document.addEventListener("mouseup",B)},k=t.useMemo(()=>r.map((U,G)=>{var X,ee;return{...U,currentPerformanceLabel:M?null:((X=V[G])==null?void 0:X.currentLabel)||null,allTimePerformanceLabel:M?null:((ee=V[G])==null?void 0:ee.allTimeLabel)||null,Sessions:Number((U==null?void 0:U.Sessions)||0),"Add To Cart Rate":T((U==null?void 0:U["Add To Cart Rate"])||"0"),"Checkout Rate":T((U==null?void 0:U["Checkout Rate"])||"0"),"Purchase Rate":T((U==null?void 0:U["Purchase Rate"])||"0")}}),[r,V,M]),j=t.useMemo(()=>l?[...k].sort((U,G)=>{const X=U[l],ee=G[l];if(l==="Date")return m==="asc"?new Date(X).getTime()-new Date(ee).getTime():new Date(ee).getTime()-new Date(X).getTime();const de=typeof X=="number"?X:parseFloat((X||"0").toString().replace("%","").trim()),B=typeof ee=="number"?ee:parseFloat((ee||"0").toString().replace("%","").trim());return de<B?m==="asc"?-1:1:de>B?m==="asc"?1:-1:0}):k,[k,l,m]),E=U=>["Date","Add To Cart","Checkouts","Sessions","Purchases","Visitors",..._].includes(U),R=U=>{E(U)&&(l===U?h(m==="asc"?"desc":"asc"):(o(U),h("asc")))},Y=(U,G)=>{d===U&&p===G?(c(null),C(null)):(c(U),C(G))},W=t.useMemo(()=>{const U=M?j:d?j.filter(G=>p==="current"?G.currentPerformanceLabel===d:p==="allTime"?G.allTimePerformanceLabel===d:!1):j;return L.current=U,U},[j,d,p,M]);t.useEffect(()=>{n&&w(L.current.slice(0,g))},[n]),t.useEffect(()=>{n&&(i.current!==r||d!==null||l!==null||m)&&(w(L.current.slice(0,g)),i.current=r)},[r,d,l,m,n]);const O=()=>{if(n&&v.length<L.current.length){const U=L.current.slice(v.length,v.length+g);w(G=>[...G,...U])}},J=U=>{const G=U.currentTarget;G.scrollHeight-G.scrollTop<=G.clientHeight+100&&O()},se=t.useMemo(()=>n?v:W.slice((b-1)*F,b*F),[n,v,W,b,F]),Q=Math.ceil(W.length/F),re=U=>{const G=Math.max(1,Math.min(U,Q));$(G)},xe={"Add To Cart":"Add To Cart Rate",Checkouts:"Checkout Rate",Purchases:"Purchase Rate"};return e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:u,className:"rounded-md overflow-x-auto relative border",style:{width:"100%",maxHeight:n?"calc(100vh - 105px)":"calc(100vh - 200px)",overflowX:"auto"},onScroll:n?J:void 0,children:e.jsxs("table",{ref:N,className:"w-full text-center shadow-lg rounded-lg border border-gray-200",style:{tableLayout:"fixed",width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[s[0]!=="Date"&&a&&e.jsxs("th",{className:"font-bold p-1 text-gray-800 text-sm border-b-2 sticky left-0 bg-gray-100 z-30 border-r border-gray-300",style:{width:`${x[0]}px`,minWidth:"200px",position:"sticky",left:0,top:0},children:["Performance Label",e.jsx("div",{onMouseDown:U=>Z(0,U),className:`absolute right-0 top-0 bottom-0 w-2 cursor-col-resize hover:bg-blue-200 ${A===0?"bg-blue-300":""}`})]}),s.map((U,G)=>{var B;const X=G===0,ee=X&&s[0]==="Date",de=_.includes(U);return e.jsxs("th",{className:`
            font-bold p-1 text-gray-800 text-sm border-b-2 
            capitalize sticky top-0 bg-gray-100 
            border-r border-gray-300 
            ${E(U)?"cursor-pointer":""}
            ${ee?"sticky left-0 z-30":"z-20"}
            ${X&&s[0]!=="Date"&&a?"sticky left-[150px]":""}
          `,style:{width:`${x[G]+1}px`,minWidth:"200px",...X&&{left:ee?0:s[0]!=="Date"&&a?x[0]:0},...ee&&{backgroundColor:"rgb(243 244 246)",zIndex:30}},onClick:()=>R(U),children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"flex items-center justify-center mb-1",children:[e.jsx("span",{children:U}),E(U)&&e.jsx("span",{className:"ml-2",children:l===U?m==="asc"?e.jsx(Ms,{className:"w-4 h-4 text-blue-600"}):e.jsx(Ts,{className:"w-4 h-4 text-blue-600"}):e.jsx(vt,{className:"w-4 h-4 text-gray-500"})})]}),de&&f[U]!==void 0&&e.jsxs("span",{className:"text-xs text-gray-500",children:["avg: ",U==="Sessions"?Math.round(f[U]):(B=f[U])==null?void 0:B.toFixed(2),U!=="Sessions"?"%":""]})]}),e.jsx("div",{onMouseDown:q=>Z(G,q),className:`absolute right-0 top-0 bottom-0 w-2 cursor-col-resize hover:bg-blue-200 ${A===G?"bg-blue-300":""}`})]},U)})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:se.map((U,G)=>e.jsxs("tr",{className:`${G%2===0?"bg-gray-50":"bg-white"} hover:bg-gray-100 transition-colors duration-200 rounded-md`,children:[s[0]!=="Date"&&a&&e.jsx("td",{className:"p-3 text-sm font-normal sticky left-0 bg-white z-20 shadow-[2px_0_0_0_rgba(0,0,0,0.1)] border-r border-gray-300",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.jsxs("div",{className:"flex items-center gap-1 min-w-[150px]",children:[U.currentPerformanceLabel&&e.jsxs("span",{onClick:()=>Y(U.currentPerformanceLabel,"current"),className:`inline-flex items-center px-2 py-1 rounded-md text-xs font-medium ${U.currentPerformanceLabel==="Current Top"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"} ${d===U.currentPerformanceLabel&&p==="current"?"ring-2 ring-offset-1 ring-opacity-60":""} cursor-pointer`,children:[U.currentPerformanceLabel==="Current Top"?e.jsx(Ms,{size:12,className:"mr-1"}):e.jsx(Ts,{size:12,className:"mr-1"}),U.currentPerformanceLabel.split(" ")[1]]}),U.allTimePerformanceLabel&&e.jsxs("span",{onClick:()=>Y(U.allTimePerformanceLabel,"allTime"),className:`inline-flex items-center px-2 py-1 rounded-md text-xs font-medium ${U.allTimePerformanceLabel==="All Time Top"?"bg-blue-100 text-blue-800":"bg-orange-100 text-orange-800"} ${d===U.allTimePerformanceLabel&&p==="allTime"?"ring-2 ring-offset-1 ring-opacity-60":""} cursor-pointer`,children:[U.allTimePerformanceLabel==="All Time Top"?e.jsx(io,{size:12,className:"mr-1"}):e.jsx(co,{size:12,className:"mr-1"}),"All-time"]})]})}),e.jsx("td",{className:"p-3 text-sm font-normal sticky left-[150px] bg-white z-20 shadow-[2px_0_0_0_rgba(0,0,0,0.1)] border-r border-gray-300",style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",left:`${s[0]!=="Date"?x[0]:0}px`},children:U[s[0]]}),s.slice(1).map(X=>{const ee=U[X],de=_.includes(X),B=X in xe;let q="text-gray-800";if(de)q=ya(ee,f[X]);else if(B){const me=xe[X],Ne=U[me];q=ya(Ne,f[me])}return e.jsx("td",{className:`p-3 text-sm font-normal border-r border-gray-300 ${q}`,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.jsx("div",{className:"flex items-center justify-center gap-2",children:X.includes("Rate")?`${ee.toFixed(2)}%`:ee})},X)})]},G))})]})}),!n&&e.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",(b-1)*F+1," to ",Math.min(b*F,W.length)," of ",W.length," entries"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(D,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>re(1),disabled:b===1,children:e.jsx(Vt,{className:"h-4 w-4"})}),e.jsx(D,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>re(b-1),disabled:b===1,children:e.jsx(Ps,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-center justify-center text-sm font-medium",children:["Page ",b," of ",Q]}),e.jsx(D,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>re(b+1),disabled:b===Q,children:e.jsx(xs,{className:"h-4 w-4"})}),e.jsx(D,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>re(Q),disabled:b===Q,children:e.jsx(Ut,{className:"h-4 w-4"})})]})]})]})},Zs=Ze.memo(ui);function Ls({columns:s,onFiltersChange:r,filters:a,setFilters:n}){const[l,o]=t.useState(""),[m,h]=t.useState(">"),[d,c]=t.useState("");t.useEffect(()=>{r(a)},[a,r]);const p=()=>{l&&d&&(n([...a,{column:l,operator:m,value:d}]),o(""),c(""))};return e.jsx("div",{children:e.jsxs(cs,{children:[e.jsx(ds,{asChild:!0,children:e.jsx(D,{variant:"outline",size:"icon",children:e.jsx(ks,{className:"h-4 w-4"})})}),e.jsx(ns,{className:"w-80 p-4",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs(qe,{value:l,onValueChange:C=>{o(C)},children:[e.jsx(We,{children:e.jsx(Je,{placeholder:"Select column"})}),e.jsx(Ke,{children:s.map(C=>e.jsx(Te,{value:C,children:C},C))})]}),e.jsxs(qe,{value:m,onValueChange:C=>h(C),children:[e.jsx(We,{children:e.jsx(Je,{placeholder:"Select operator"})}),e.jsxs(Ke,{children:[e.jsx(Te,{value:">",children:"Greater than"}),e.jsx(Te,{value:"<",children:"Less than"}),e.jsx(Te,{value:"=",children:"Equal to"})]})]}),e.jsx(De,{type:"text",placeholder:"Enter filter value",value:d,onChange:C=>c(C.target.value)}),e.jsx(D,{onClick:p,children:"Add Filter"})]})})]})})}const hi=({dateRange:s})=>{const[r,a]=t.useState(s),[n,l]=t.useState([]),[o,m]=t.useState([]),[h,d]=t.useState([]),[c,p]=t.useState(!1),{brandId:C}=ge(),x=ke(),[S,A]=t.useState([]),[y,b]=t.useState("50"),[$,v]=t.useState([]),[w,g]=t.useState([]),[F,M]=t.useState(!1),{user:N}=Os(),u=["city","country","region","Visitors","Sessions","Add To Cart","Add To Cart Rate","Checkouts","Checkout Rate","Purchases","Purchase Rate"],I=k=>{A(j=>{const E=j.includes(k)?j.filter(R=>R!==k):[...j,k];return g(R=>["city","region","country"].includes(k)?E.includes(k)?R.filter(Y=>Y!==k):[...R,k]:R),u.filter(R=>E.includes(R))})};t.useEffect(()=>{A(u)},[]),t.useEffect(()=>{a(s)},[s]);const i=t.useCallback(async()=>{p(!0);try{const k=r!=null&&r.from?H(r.from,"yyyy-MM-dd"):"",j=r!=null&&r.to?H(r.to,"yyyy-MM-dd"):"",[E,R]=await Promise.all([x.post(`/api/analytics/locationReport/${C}`,{startDate:k||"",endDate:j||"",userId:N==null?void 0:N.id,limit:y,...w.length>0?{filters:{location:w}}:{}},{withCredentials:!0}),x.post(`/api/analytics/locationReport/${C}`,{startDate:"",endDate:"",userId:N==null?void 0:N.id,limit:y,...w.length>0?{filters:{location:w}}:{}},{withCredentials:!0})]),Y=E.data.data||[],W=R.data.data||[];if(d(Y),m(Y),l(W),Y.length>0){const O=Object.keys(Y[0]);A(J=>J.length===0?O:J.filter(se=>O.includes(se)))}}catch(k){console.error("Error fetching metrics:",k)}finally{p(!1)}},[C,w,r,y]);t.useEffect(()=>{i();const k=setInterval(i,5*60*1e3);return()=>clearInterval(k)},[i]);const L=()=>{i()},_=()=>{M(!F)},T=t.useMemo(()=>u.filter(k=>S.includes(k)),[u,S]),f=t.useCallback(k=>{let j=[...h];k.forEach(E=>{j=j.filter(R=>{const Y=R[E.column];if([">","<","="].includes(E.operator)){const W=parseFloat(Y),O=parseFloat(E.value);switch(E.operator){case">":return W>O;case"<":return W<O;case"=":return W===O;default:return!0}}return!0})}),m(j)},[h]),P=t.useMemo(()=>o,[o]),V=["Add To Cart","Checkouts","Sessions","Purchases","Purchase Rate","Add To Cart Rate","Checkout Rate"],Z=k=>{v($.filter((j,E)=>E!==k))};return e.jsx(le,{className:`mx-4 ${F?"fixed inset-0 z-50 m-0":""}`,children:e.jsx(ce,{className:"mt-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Location Analytics"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx(D,{onClick:L,disabled:c,size:"icon",variant:"outline",children:e.jsx(fe,{className:`h-4 w-4 ${c?"animate-spin":""}`})}),e.jsxs(cs,{children:[e.jsx(ds,{asChild:!0,children:e.jsx(D,{variant:"outline",size:"icon",children:e.jsx(Ks,{className:"h-4 w-4"})})}),e.jsx(ns,{className:"w-56",children:u.map(k=>e.jsxs(_e,{className:"flex items-center space-x-2",children:[e.jsx(ps,{id:`column-${k}`,checked:S.includes(k),onCheckedChange:()=>I(k)}),e.jsx("label",{htmlFor:`column-${k}`,className:"flex-1 cursor-pointer",children:k})]},k))})]}),e.jsx(Ls,{columns:V,onFiltersChange:f,filters:$,setFilters:v}),e.jsx(D,{onClick:_,size:"icon",variant:"outline",children:F?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})}),e.jsxs(cs,{children:[e.jsx(ds,{asChild:!0,children:e.jsxs(D,{variant:"outline",children:["Show ",y==="10000"?"all":y," rows",e.jsx(is,{className:"ml-2 h-4 w-4"})]})}),e.jsxs(ns,{children:[e.jsx(_e,{onSelect:()=>b("50"),children:"Show 50 rows"}),e.jsx(_e,{onSelect:()=>b("100"),children:"Show 100 rows"}),e.jsx(_e,{onSelect:()=>b("10000"),children:"Show all rows"})]})]})]})]}),$.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:$.map((k,j)=>e.jsxs("div",{className:"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",children:[e.jsx("span",{children:`${k.column} ${k.operator} ${k.value}`}),e.jsx("button",{onClick:()=>Z(j),className:"ml-1 ring-offset-background rounded-full outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2","aria-label":"Remove filter",children:e.jsx(rs,{className:"h-3 w-3"})})]},j))}),e.jsx("div",{className:"rounded-md overflow-hidden",children:c?e.jsx(Me,{}):e.jsx(Zs,{columns:T,data:P,allTimeData:n,isFullScreen:F})})]})})})},xi=({dateRange:s})=>{const[r,a]=t.useState(s),[n,l]=t.useState([]),[o,m]=t.useState([]),[h,d]=t.useState([]),[c,p]=t.useState([]),[C,x]=t.useState(!1),{brandId:S}=ge(),A=ke(),y=r!=null&&r.from?H(r.from,"yyyy-MM-dd"):"",b=r!=null&&r.to?H(r.to,"yyyy-MM-dd"):"",[$,v]=t.useState([]),[w,g]=t.useState("50"),[F,M]=t.useState(!1),{user:N}=Os();t.useEffect(()=>{a(s)},[s]);const u=k=>{v(j=>{const E=j.includes(k)?j.filter(R=>R!==k):[...j,k];return L.filter(R=>E.includes(R))})},I=t.useCallback(async()=>{x(!0);try{const[k,j]=await Promise.all([A.post(`/api/analytics/landingpageReport/${S}`,{startDate:y||"",endDate:b||"",userId:N==null?void 0:N.id,limit:w},{withCredentials:!0}),A.post(`/api/analytics/landingpageReport/${S}`,{startDate:"",endDate:"",userId:N==null?void 0:N.id,limit:w},{withCredentials:!0})]),E=k.data.data||[],R=j.data.data||[];if(p(E),m(E),l(R),E.length>0){const Y=Object.keys(E[0]);v(W=>W.length===0?Y:W.filter(O=>Y.includes(O)))}}catch(k){console.error("Error fetching data:",k)}finally{x(!1)}},[S,y,b,w]);t.useEffect(()=>{I();const k=setInterval(I,15*60*1e3);return()=>clearInterval(k)},[I]);const i=()=>{I()},L=c.length>0?Object.keys(c[0]):[],_=L.filter(k=>$.includes(k)),T=t.useCallback(k=>{let j=[...c];k.forEach(E=>{j=j.filter(R=>{const Y=R[E.column];if([">","<","="].includes(E.operator)){const W=parseFloat(Y),O=parseFloat(E.value);switch(E.operator){case">":return W>O;case"<":return W<O;case"=":return W===O;default:return!0}}return!0})}),m(j)},[c]),f=t.useMemo(()=>o,[o]),P=["Add To Cart","Checkouts","Sessions","Purchases","Purchase Rate","Add To Cart Rate","Checkout Rate"],V=k=>{d(h.filter((j,E)=>E!==k))},Z=()=>{M(!F)};return e.jsx(le,{className:`mx-4 ${F?"fixed inset-0 z-50 m-0":""}`,children:e.jsx(ce,{className:"mt-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Landing Page Analytics"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx(D,{onClick:i,disabled:C,size:"icon",variant:"outline",children:e.jsx(fe,{className:`h-4 w-4 ${C?"animate-spin":""}`})}),e.jsxs(cs,{children:[e.jsx(ds,{asChild:!0,children:e.jsx(D,{variant:"outline",size:"icon",children:e.jsx(Ks,{className:"h-4 w-4"})})}),e.jsx(ns,{className:"w-56",children:L.map(k=>e.jsxs(_e,{className:"flex items-center space-x-2",children:[e.jsx(ps,{id:`column-${k}`,checked:$.includes(k),onCheckedChange:()=>u(k)}),e.jsx("label",{htmlFor:`column-${k}`,className:"flex-1 cursor-pointer",children:k})]},k))})]}),e.jsx(Ls,{columns:P,onFiltersChange:T,filters:h,setFilters:d}),e.jsx(D,{onClick:Z,size:"icon",variant:"outline",children:F?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})}),e.jsxs(cs,{children:[e.jsx(ds,{asChild:!0,children:e.jsxs(D,{variant:"outline",children:["Show ",w==="10000"?"all":w," rows",e.jsx(is,{className:"ml-2 h-4 w-4"})]})}),e.jsxs(ns,{children:[e.jsx(_e,{onSelect:()=>g("50"),children:"Show 50 rows"}),e.jsx(_e,{onSelect:()=>g("100"),children:"Show 100 rows"}),e.jsx(_e,{onSelect:()=>g("10000"),children:"Show all rows"})]})]})]})]}),h.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:h.map((k,j)=>e.jsxs("div",{className:"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",children:[e.jsx("span",{children:`${k.column} ${k.operator} ${k.value}`}),e.jsx("button",{onClick:()=>V(j),className:"ml-1 ring-offset-background rounded-full outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2","aria-label":"Remove filter",children:e.jsx(rs,{className:"h-3 w-3"})})]},j))}),e.jsx("div",{className:"rounded-md overflow-hidden",children:C?e.jsx(Me,{}):e.jsx(Zs,{columns:_,data:f,allTimeData:n,isFullScreen:F})})]})})})},fi=({dateRange:s})=>{const[r,a]=t.useState(s),[n,l]=t.useState([]),[o,m]=t.useState([]),[h,d]=t.useState([]),[c,p]=t.useState([]),[C,x]=t.useState(!1),{brandId:S}=ge(),A=ke(),y=r!=null&&r.from?H(r.from,"yyyy-MM-dd"):"",b=r!=null&&r.to?H(r.to,"yyyy-MM-dd"):"",[$,v]=t.useState([]),[w,g]=t.useState(!1),[F,M]=t.useState("50"),{user:N}=Os();t.useEffect(()=>{a(s)},[s]);const u=k=>{v(j=>{const E=j.includes(k)?j.filter(R=>R!==k):[...j,k];return L.filter(R=>E.includes(R))})},I=t.useCallback(async()=>{x(!0);try{const[k,j]=await Promise.all([A.post(`/api/analytics/agereport/${S}`,{startDate:y||"",endDate:b||"",userId:N==null?void 0:N.id,limit:F},{withCredentials:!0}),A.post(`/api/analytics/agereport/${S}`,{startDate:"",endDate:"",userId:N==null?void 0:N.id,limit:F},{withCredentials:!0})]),E=k.data.data||[],R=j.data.data||[];if(p(E),l(E),m(R),E.length>0){const Y=Object.keys(E[0]);v(W=>W.length===0?Y:W.filter(O=>Y.includes(O)))}}catch(k){console.error("Error fetching data:",k)}finally{x(!1)}},[S,y,b,F]);t.useEffect(()=>{I();const k=setInterval(I,15*60*1e3);return()=>clearInterval(k)},[I]);const i=()=>{I()},L=c.length>0?Object.keys(c[0]):[],_=L.filter(k=>$.includes(k)),T=t.useCallback(k=>{let j=[...c];k.forEach(E=>{j=j.filter(R=>{const Y=R[E.column];if([">","<","="].includes(E.operator)){const W=parseFloat(Y),O=parseFloat(E.value);switch(E.operator){case">":return W>O;case"<":return W<O;case"=":return W===O;default:return!0}}return!0})}),l(j)},[c]),f=k=>{d(h.filter((j,E)=>E!==k))},P=t.useMemo(()=>n,[n]),V=["Add To Cart","Checkouts","Sessions","Purchases","Purchase Rate","Add To Cart Rate","Checkout Rate"],Z=()=>{g(!w)};return e.jsx(le,{className:`mx-4 ${w?"fixed inset-0 z-50 m-0":""}`,children:e.jsx(ce,{className:"mt-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Age Analytics"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx(D,{onClick:i,disabled:C,size:"icon",variant:"outline",children:e.jsx(fe,{className:`h-4 w-4 ${C?"animate-spin":""}`})}),e.jsxs(cs,{children:[e.jsx(ds,{asChild:!0,children:e.jsx(D,{variant:"outline",size:"icon",children:e.jsx(Ks,{className:"h-4 w-4"})})}),e.jsx(ns,{className:"w-56",children:L.map(k=>e.jsxs(_e,{className:"flex items-center space-x-2",children:[e.jsx(ps,{id:`column-${k}`,checked:$.includes(k),onCheckedChange:()=>u(k)}),e.jsx("label",{htmlFor:`column-${k}`,className:"flex-1 cursor-pointer",children:k})]},k))})]}),e.jsx(Ls,{columns:V,onFiltersChange:T,filters:h,setFilters:d}),e.jsx(D,{onClick:Z,size:"icon",variant:"outline",children:w?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})}),e.jsxs(cs,{children:[e.jsx(ds,{asChild:!0,children:e.jsxs(D,{variant:"outline",children:["Show ",F==="10000"?"all":F," rows",e.jsx(is,{className:"ml-2 h-4 w-4"})]})}),e.jsxs(ns,{children:[e.jsx(_e,{onSelect:()=>M("50"),children:"Show 50 rows"}),e.jsx(_e,{onSelect:()=>M("100"),children:"Show 100 rows"}),e.jsx(_e,{onSelect:()=>M("10000"),children:"Show all rows"})]})]})]})]}),h.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:h.map((k,j)=>e.jsxs("div",{className:"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",children:[e.jsx("span",{children:`${k.column} ${k.operator} ${k.value}`}),e.jsx("button",{onClick:()=>f(j),className:"ml-1 ring-offset-background rounded-full outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2","aria-label":"Remove filter",children:e.jsx(rs,{className:"h-3 w-3"})})]},j))}),e.jsx("div",{className:"rounded-md overflow-hidden",children:C?e.jsx(Me,{}):e.jsx(Zs,{columns:_,data:P,allTimeData:o,isFullScreen:w})})]})})})},gi=({dateRange:s})=>{const[r,a]=t.useState(s),[n,l]=t.useState([]),[o,m]=t.useState([]),[h,d]=t.useState([]),[c,p]=t.useState([]),[C,x]=t.useState(!1),{brandId:S}=ge(),{user:A}=Os(),y=ke(),b=r!=null&&r.from?H(r.from,"yyyy-MM-dd"):"",$=r!=null&&r.to?H(r.to,"yyyy-MM-dd"):"",[v,w]=t.useState([]),[g,F]=t.useState("50"),[M,N]=t.useState(!1);t.useEffect(()=>{a(s)},[s]);const u=k=>{w(j=>{const E=j.includes(k)?j.filter(R=>R!==k):[...j,k];return L.filter(R=>E.includes(R))})},I=t.useCallback(async()=>{x(!0);try{const[k,j]=await Promise.all([y.post(`/api/analytics/genderReport/${S}`,{startDate:b||"",endDate:$||"",userId:A==null?void 0:A.id,limit:g},{withCredentials:!0}),y.post(`/api/analytics/genderReport/${S}`,{startDate:"",endDate:"",userId:A==null?void 0:A.id,limit:g},{withCredentials:!0})]),E=k.data.data||[],R=j.data.data||[];if(p(E),l(E),m(R),E.length>0){const Y=Object.keys(E[0]);w(W=>W.length===0?Y:W.filter(O=>Y.includes(O)))}}catch(k){console.error("Error fetching data:",k)}finally{x(!1)}},[S,b,$,g]);t.useEffect(()=>{I();const k=setInterval(I,15*60*1e3);return()=>clearInterval(k)},[I]);const i=()=>{I()},L=c.length>0?Object.keys(c[0]):[],_=L.filter(k=>v.includes(k)),T=t.useCallback(k=>{let j=[...c];k.forEach(E=>{j=j.filter(R=>{const Y=R[E.column];if([">","<","="].includes(E.operator)){const W=parseFloat(Y),O=parseFloat(E.value);switch(E.operator){case">":return W>O;case"<":return W<O;case"=":return W===O;default:return!0}}return!0})}),l(j)},[c]),f=k=>{d(h.filter((j,E)=>E!==k))},P=t.useMemo(()=>n,[n]),V=["Add To Cart","Checkouts","Sessions","Purchases","Purchase Rate","Add To Cart Rate","Checkout Rate"],Z=()=>{N(!M)};return e.jsx(le,{className:`mx-4 ${M?"fixed inset-0 z-50 m-0":""}`,children:e.jsx(ce,{className:"mt-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Gender Analytics"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx(D,{onClick:i,disabled:C,size:"icon",variant:"outline",children:e.jsx(fe,{className:`h-4 w-4 ${C?"animate-spin":""}`})}),e.jsxs(cs,{children:[e.jsx(ds,{asChild:!0,children:e.jsx(D,{variant:"outline",size:"icon",children:e.jsx(Ks,{className:"h-4 w-4"})})}),e.jsx(ns,{className:"w-56",children:L.map(k=>e.jsxs(_e,{className:"flex items-center space-x-2",children:[e.jsx(ps,{id:`column-${k}`,checked:v.includes(k),onCheckedChange:()=>u(k)}),e.jsx("label",{htmlFor:`column-${k}`,className:"flex-1 cursor-pointer",children:k})]},k))})]}),e.jsx(Ls,{columns:V,onFiltersChange:T,filters:h,setFilters:d}),e.jsx(D,{onClick:Z,size:"icon",variant:"outline",children:M?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})}),e.jsxs(cs,{children:[e.jsx(ds,{asChild:!0,children:e.jsxs(D,{variant:"outline",children:["Show ",g==="10000"?"all":g," rows",e.jsx(is,{className:"ml-2 h-4 w-4"})]})}),e.jsxs(ns,{children:[e.jsx(_e,{onSelect:()=>F("50"),children:"Show 50 rows"}),e.jsx(_e,{onSelect:()=>F("100"),children:"Show 100 rows"}),e.jsx(_e,{onSelect:()=>F("10000"),children:"Show all rows"})]})]})]})]}),h.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:h.map((k,j)=>e.jsxs("div",{className:"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",children:[e.jsx("span",{children:`${k.column} ${k.operator} ${k.value}`}),e.jsx("button",{onClick:()=>f(j),className:"ml-1 ring-offset-background rounded-full outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2","aria-label":"Remove filter",children:e.jsx(rs,{className:"h-3 w-3"})})]},j))}),e.jsx("div",{className:"rounded-md overflow-hidden",children:C?e.jsx(Me,{}):e.jsx(Zs,{columns:_,data:P,allTimeData:o,isFullScreen:M})})]})})})},pi=({dateRange:s})=>{const[r,a]=t.useState(s),[n,l]=t.useState([]),[o,m]=t.useState([]),[h,d]=t.useState([]),[c,p]=t.useState([]),[C,x]=t.useState(!1),{brandId:S}=ge(),A=r!=null&&r.from?H(r.from,"yyyy-MM-dd"):"",y=r!=null&&r.to?H(r.to,"yyyy-MM-dd"):"",[b,$]=t.useState([]),[v,w]=t.useState("50"),[g,F]=t.useState(!1),{user:M}=Os(),N=ke();t.useEffect(()=>{a(s)},[s]);const u=k=>{$(j=>{const E=j.includes(k)?j.filter(R=>R!==k):[...j,k];return L.filter(R=>E.includes(R))})},I=t.useCallback(async()=>{x(!0);try{const[k,j]=await Promise.all([N.post(`/api/analytics/channelReport/${S}`,{startDate:A||"",endDate:y||"",userId:M==null?void 0:M.id,limit:v},{withCredentials:!0}),N.post(`/api/analytics/channelReport/${S}`,{startDate:"",endDate:"",userId:M==null?void 0:M.id,limit:v},{withCredentials:!0})]),E=k.data.data||[],R=j.data.data||[];if(p(E),l(E),m(R),E.length>0){const Y=Object.keys(E[0]);$(W=>W.length===0?Y:W.filter(O=>Y.includes(O)))}}catch(k){console.error("Error fetching data:",k)}finally{x(!1)}},[S,A,y,v]);t.useEffect(()=>{I();const k=setInterval(I,15*60*1e3);return()=>clearInterval(k)},[I]);const i=()=>{I()},L=c.length>0?Object.keys(c[0]):[],_=L.filter(k=>b.includes(k)),T=t.useCallback(k=>{let j=[...c];k.forEach(E=>{j=j.filter(R=>{const Y=R[E.column];if([">","<","="].includes(E.operator)){const W=parseFloat(Y),O=parseFloat(E.value);switch(E.operator){case">":return W>O;case"<":return W<O;case"=":return W===O;default:return!0}}return!0})}),l(j)},[c]),f=t.useMemo(()=>n,[n]),P=["Add To Cart","Checkouts","Sessions","Purchases","Purchase Rate","Add To Cart Rate","Checkout Rate"],V=k=>{d(h.filter((j,E)=>E!==k))},Z=()=>{g?document.exitFullscreen():document.documentElement.requestFullscreen(),F(!g)};return t.useEffect(()=>{const k=()=>{F(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",k),()=>{document.removeEventListener("fullscreenchange",k)}},[]),e.jsx(le,{className:`mx-4 ${g?"fixed inset-0 z-50 m-0":""}`,children:e.jsx(ce,{className:"mt-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Referring Channel Analytics"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx(D,{onClick:i,disabled:C,size:"icon",variant:"outline",children:e.jsx(fe,{className:`h-4 w-4 ${C?"animate-spin":""}`})}),e.jsxs(cs,{children:[e.jsx(ds,{asChild:!0,children:e.jsx(D,{variant:"outline",size:"icon",children:e.jsx(Ks,{className:"h-4 w-4"})})}),e.jsx(ns,{className:"w-56",children:L.map(k=>e.jsxs(_e,{className:"flex items-center space-x-2",children:[e.jsx(ps,{id:`column-${k}`,checked:b.includes(k),onCheckedChange:()=>u(k)}),e.jsx("label",{htmlFor:`column-${k}`,className:"flex-1 cursor-pointer",children:k})]},k))})]}),e.jsx(Ls,{columns:P,onFiltersChange:T,filters:h,setFilters:d}),e.jsx(D,{onClick:Z,size:"icon",variant:"outline",children:g?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})}),e.jsxs(cs,{children:[e.jsx(ds,{asChild:!0,children:e.jsxs(D,{variant:"outline",children:["Show ",v==="10000"?"all":v," rows",e.jsx(is,{className:"ml-2 h-4 w-4"})]})}),e.jsxs(ns,{children:[e.jsx(_e,{onSelect:()=>w("50"),children:"Show 50 rows"}),e.jsx(_e,{onSelect:()=>w("100"),children:"Show 100 rows"}),e.jsx(_e,{onSelect:()=>w("10000"),children:"Show all rows"})]})]})]})]}),h.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:h.map((k,j)=>e.jsxs("div",{className:"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",children:[e.jsx("span",{children:`${k.column} ${k.operator} ${k.value}`}),e.jsx("button",{onClick:()=>V(j),className:"ml-1 ring-offset-background rounded-full outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2","aria-label":"Remove filter",children:e.jsx(rs,{className:"h-3 w-3"})})]},j))}),e.jsx("div",{className:"rounded-md overflow-hidden",children:C?e.jsx(Me,{}):e.jsx(Zs,{columns:_,data:f,allTimeData:o,isFullScreen:g})})]})})})};function ji(){const{brandId:s}=ge();if(!s)return console.error("Brand ID is not defined"),e.jsx("div",{children:"Error: Brand ID is missing"});const r=z(o=>o.date.from),a=z(o=>o.date.to),n=t.useMemo(()=>({from:r,to:a}),[r,a]),l={from:n.from?new Date(n.from):void 0,to:n.to?new Date(n.to):void 0};return e.jsxs("div",{className:"bg-gray-100 min-h-screen overflow-hidden",children:[e.jsx("nav",{className:"sticky top-0 z-10 bg-white border-b border-gray-200 px-4 py-4 md:px-6 lg:px-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Segment Dashboard"}),e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{})})]})}),e.jsxs("div",{className:"flex flex-col p-6 gap-6 overflow-auto",children:[e.jsx(ai,{}),e.jsx(ri,{}),e.jsx(ni,{}),e.jsx("section",{className:"mb-6",children:e.jsx(hi,{dateRange:l})}),e.jsx("section",{className:"mb-6",children:e.jsx(xi,{dateRange:l})}),e.jsx("section",{className:"mb-6",children:e.jsx(pi,{dateRange:l})}),e.jsx("section",{className:"mb-6",children:e.jsx(fi,{dateRange:l})}),e.jsx("section",{className:"mb-6",children:e.jsx(gi,{dateRange:l})})]})]})}const vi=()=>e.jsxs("div",{className:"flex h-screen",children:[e.jsx(ts,{}),e.jsx("div",{className:"flex-1 h-screen overflow-auto",children:e.jsx(ji,{})})]}),bi=()=>{const s=fs(),{toast:r}=bt(),a=Se(),n="https://parallels.messold.com";return t.useEffect(()=>{(async()=>{try{const o=new URLSearchParams(window.location.search),m=o.get("token"),h=o.get("fbToken"),d=o.get("googleRefreshToken"),c=o.get("zohoToken"),p=async(C,x,S)=>(await ve.get(`${n}${C}?${S}=${x}`,{withCredentials:!0})).data.success?(console.log(`${S} token updated successfully, redirecting to /dashboard`),S==="zohoToken"?(console.log("Zoho token updated, redirecting to /profile"),s("/profile")):(console.log(`${S} token updated, redirecting to /dashboard`),s("/dashboard")),!0):(console.error(`Failed to update ${S} token`),r({title:"Update Failed",description:`Unable to update ${S} token.`,variant:"destructive"}),s("/"),!1);if(m){console.log("Token found, proceeding with login");const C=await ve.post(`${n}/api/auth/login/oauth?auth_token=${m}`,{email:null,password:null});if(C.data.success){console.log("Login successful");const x=C.data.user;a(mt(x)),!x.brands||x.brands.length===0?(console.log("No brands found, redirecting to /brand-setup"),s("/brand-setup")):(console.log("Brands found, redirecting to /dashboard"),s("/dashboard"));return}else{console.log("Login failed, redirecting to /"),r({title:"Login Failed",description:"Unable to authenticate with Google.",variant:"destructive"}),s("/");return}}if(h){await p("/api/auth/updateTokens/facebook",h,"fbToken");return}if(d){await p("/api/auth/updateTokens/google",d,"googleRefreshToken");return}if(c){await p("/api/auth/updateTokens/zoho",c,"zohoToken");return}console.log("No token present, redirecting to /"),s("/")}catch(o){console.error("Error during OAuth callback:",o),r({title:"Error",description:"An error occurred while handling the login callback.",variant:"destructive"}),s("/")}})()},[s,mt,r,n]),null},Na=(s,r)=>s>r?"bg-green-100 text-green-800":s<r?"bg-red-50 text-red-800":(Math.abs(s-r)<1e-4,"bg-yellow-100 text-yellow-700"),yi=({columns:s=[],data:r=[],isFullScreen:a})=>{const[n,l]=t.useState(null),[o,m]=t.useState("asc"),[h,d]=t.useState([]),[c,p]=t.useState(1),[C,x]=t.useState([]),[S,A]=t.useState(s),[y,b]=t.useState(null),$=30,v=9,w=a?100:150,g=t.useRef(null),F=t.useRef(null),M=t.useRef([]),N=["Add To Cart Rate","Checkout Rate","Purchase Rate","Sessions"];t.useEffect(()=>{A(s)},[s]);const u=(O,J)=>{b(J),O.dataTransfer.effectAllowed="move"},I=O=>{O.preventDefault(),O.dataTransfer.dropEffect="move"},i=(O,J)=>{if(O.preventDefault(),!y||y===J)return;const se=[...S],Q=se.indexOf(y),re=se.indexOf(J);se.splice(Q,1),se.splice(re,0,y),A(se),b(null)},L=O=>typeof O=="number"?O:O&&parseFloat(O.replace("%","").trim())||0;t.useEffect(()=>{if(F.current){const O=F.current.clientWidth,J=s.length;let se;if(a){const Q=Math.max(w,Math.floor(O/J));se=s.map(()=>Q)}else se=s.map((Q,re)=>re===0?160:150);d(se),M.current=se}},[s.length,a]);const _=t.useMemo(()=>{const O={};return N.forEach(J=>{const se=r.filter(re=>re[J]!==void 0&&!isNaN(L(re[J]||"0"))),Q=se.length>0?se.reduce((re,xe)=>re+L(xe[J]||"0"),0)/se.length:0;O[J]=J==="Sessions"?Math.round(Q):parseFloat(Q.toFixed(2))}),O},[r]),T=t.useMemo(()=>r.map(O=>({...O,Sessions:Number((O==null?void 0:O.Sessions)||0),"Add To Cart Rate":L((O==null?void 0:O["Add To Cart Rate"])||"0"),"Checkout Rate":L((O==null?void 0:O["Checkout Rate"])||"0"),"Purchase Rate":L((O==null?void 0:O["Purchase Rate"])||"0")})),[r]),f=t.useMemo(()=>n?[...T].sort((O,J)=>{const se=O[n],Q=J[n];if(n==="Date"){const U=ee=>{const[de,B,q]=ee.split("-");return new Date(`${q}-${B}-${de}`)},G=U(se),X=U(Q);return o==="asc"?G.getTime()-X.getTime():X.getTime()-G.getTime()}const re=typeof se=="number"?se:parseFloat((se||"0").toString().replace("%","").trim()),xe=typeof Q=="number"?Q:parseFloat((Q||"0").toString().replace("%","").trim());return re<xe?o==="asc"?-1:1:re>xe?o==="asc"?1:-1:0}):T,[T,n,o]),P=O=>["Date"].includes(O),V=O=>{P(O)&&(n===O?m(o==="asc"?"desc":"asc"):(l(O),m("asc")))};t.useEffect(()=>{a&&x(f.slice(0,$))},[a,f,$]);const Z=()=>{if(a&&C.length<f.length){const O=f.slice(C.length,C.length+$);x(J=>[...J,...O])}},k=O=>{const J=O.currentTarget;J.scrollHeight-J.scrollTop<=J.clientHeight+100&&Z()},j=t.useMemo(()=>a?C:f.slice((c-1)*v,c*v),[a,C,f,c,v]),E=Math.ceil(f.length/v),R=O=>{const J=Math.max(1,Math.min(O,E));p(J)},Y={"Add To Cart":"Add To Cart Rate",Checkouts:"Checkout Rate",Purchases:"Purchase Rate"},W=(O,J)=>{var Q;const se=N.includes(O);return e.jsx("th",{className:`
          relative font-bold p-1 text-gray-800 text-sm border-b-2
          capitalize border-r border-gray-300
          ${P(O)?"cursor-pointer":""}
          ${J===0&&!a?"sticky left-0 z-30 bg-gray-100":""}
          ${y===O?"opacity-50":""}
          hover:bg-gray-200 transition-colors duration-200
        `,style:{width:J===0?"180px":`${h[J]}px`},draggable:!0,onDragStart:re=>u(re,O),onDragOver:I,onDrop:re=>i(re,O),children:e.jsxs("div",{onClick:()=>V(O),className:"flex flex-col items-center",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-1",children:[e.jsx(mr,{className:"w-4 h-4 text-gray-400 cursor-grab"}),e.jsx("span",{children:O}),P(O)&&e.jsx("span",{className:"ml-2",children:n===O?o==="asc"?e.jsx(Ms,{className:"w-4 h-4 text-blue-600"}):e.jsx(Ts,{className:"w-4 h-4 text-blue-600"}):""})]}),se&&_[O]!==void 0&&e.jsxs("span",{className:"text-xs text-gray-500",children:["avg: ",O==="Sessions"?Math.round(_[O]):(Q=_[O])==null?void 0:Q.toFixed(2),O!=="Sessions"?"%":""]})]})},O)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:F,className:"rounded-md overflow-x-auto relative border",style:{width:"100%",maxHeight:a?"calc(100vh - 105px)":"calc(100vh - 200px)",overflowX:a?"hidden":"auto"},onScroll:a?k:void 0,children:e.jsxs("table",{ref:g,className:"w-full text-center shadow-lg rounded-lg border border-gray-200",style:{tableLayout:"fixed",width:a?"100%":"auto",borderCollapse:"separate",borderSpacing:0},children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsx("tr",{children:S.map((O,J)=>W(O,J))})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:j.map((O,J)=>e.jsx("tr",{className:`${J%2===0?"bg-gray-50":"bg-white"} hover:bg-gray-100 transition-colors duration-200`,children:S.map((se,Q)=>{const re=O[se],xe=N.includes(se),U=se in Y;let G="text-gray-800";if(xe)G=Na(re,_[se]);else if(U){const X=Y[se],ee=O[X];G=Na(ee,_[X])}return e.jsx("td",{className:`p-3 text-sm font-normal border-r border-gray-300 ${G} ${Q===0&&!a?"sticky left-0 z-20 bg-inherit":""}`,style:{width:Q===0?"150px":`${h[Q]}px`},children:e.jsx("div",{className:"flex items-center justify-center gap-2",children:se.includes("Rate")?`${re.toFixed(2)}%`:re})},`${J}-${se}`)})},J))})]})}),!a&&e.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",(c-1)*v+1," to ",Math.min(c*v,f.length)," of ",f.length," entries"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(D,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>R(1),disabled:c===1,children:e.jsx(Vt,{className:"h-4 w-4"})}),e.jsx(D,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>R(c-1),disabled:c===1,children:e.jsx(Ps,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-center justify-center text-sm font-medium",children:["Page ",c," of ",E]}),e.jsx(D,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>R(c+1),disabled:c===E,children:e.jsx(xs,{className:"h-4 w-4"})}),e.jsx(D,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>R(E),disabled:c===E,children:e.jsx(Ut,{className:"h-4 w-4"})})]})]})]})},Yr=Ze.memo(yi),Ni=({dateRange:s})=>{const r=z(O=>O.date.from),a=z(O=>O.date.to),n=z(O=>O.date.compareFrom),l=z(O=>O.date.compareTo),[o,m]=t.useState([]),[h,d]=t.useState([]),[c,p]=t.useState(!1),{brandId:C}=ge(),x=t.useMemo(()=>({from:r,to:a}),[r,a]),S=t.useMemo(()=>({from:n,to:l}),[n,l]),A=x!=null&&x.from?H(new Date(x.from),"yyyy-MM-dd"):"",y=x!=null&&x.to?H(new Date(x.to),"yyyy-MM-dd"):"",b=S!=null&&S.from?H(new Date(S.from),"yyyy-MM-dd"):"",$=S!=null&&S.to?H(new Date(S.to),"yyyy-MM-dd"):"",[v,w]=t.useState([]),[g,F]=t.useState([]),[M,N]=t.useState(!1),u=z(O=>O.user.user),I=Se(),i=ke();t.useEffect(()=>{s&&I(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s,I]);const L=()=>{N(!M)},_=t.useCallback(async()=>{var O,J,se;p(!0);try{const Q=[];if(A&&y&&Q.push({startDate:A,endDate:y}),b&&$&&Q.push({startDate:b,endDate:$}),Q.length>0){const xe=(await i.post(`/api/analytics/atcreport/${C}`,{dateRanges:Q,userId:u==null?void 0:u.id},{withCredentials:!0})).data.ranges||[];if(xe.length>0){const U=xe[0].Date;U?(d(xe),m(xe)):(d(((O=xe[0])==null?void 0:O.data)||[]),m(((J=xe[0])==null?void 0:J.data)||[]));const G=U?xe:((se=xe[0])==null?void 0:se.data)||[];if(G.length>0){const X=G[0],ee=Object.keys(X);v.length===0?w(ee):w(de=>de.filter(B=>ee.includes(B)))}}}}catch(Q){console.error("Error fetching e-commerce metrics data:",Q)}finally{p(!1)}},[A,y,b,$,C,u==null?void 0:u.id]);t.useEffect(()=>{_();const O=setInterval(_,15*60*1e3);return()=>clearInterval(O)},[_]);const T=()=>{_()},[f,P]=t.useState(v),[V,Z]=t.useState(v),k=O=>{P(O)},j=O=>{Z(O),P(O)};t.useEffect(()=>{P(v),Z(v)},[v]);const E=t.useCallback(O=>{let J=[...h];O.forEach(se=>{J=J.filter(Q=>{const re=Q[se.column];if([">","<","="].includes(se.operator)){const xe=parseFloat(re),U=parseFloat(se.value);switch(se.operator){case">":return xe>U;case"<":return xe<U;case"=":return xe===U;default:return!0}}return!0})}),m(J)},[h]),R=t.useMemo(()=>o,[o]),Y=["Add To Cart","Checkouts","Sessions","Purchases","Purchase Rate","Add To Cart Rate","Checkout Rate"],W=O=>{F(g.filter((J,se)=>se!==O))};return e.jsx(le,{className:`mx-4 ${M?"fixed inset-0 z-50 m-0":""}`,children:e.jsx(ce,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Daily E-Commerce Analytics"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[M&&e.jsx(be,{}),e.jsx(D,{onClick:T,disabled:c,size:"icon",variant:"outline",children:e.jsx(fe,{className:`h-4 w-4 ${c?"animate-spin":""}`})}),e.jsx(yt,{visibleColumns:f,columnOrder:V,onVisibilityChange:k,onOrderChange:j}),e.jsx(Ls,{columns:Y,onFiltersChange:E,filters:g,setFilters:F}),e.jsx(D,{onClick:L,size:"icon",variant:"outline",children:M?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]}),g.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:g.map((O,J)=>e.jsxs("div",{className:"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",children:[e.jsx("span",{children:`${O.column} ${O.operator} ${O.value}`}),e.jsx("button",{onClick:()=>W(J),className:"ml-1 ring-offset-background rounded-full outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2","aria-label":"Remove filter",children:e.jsx(rs,{className:"h-3 w-3"})})]},J))}),e.jsx("div",{className:"rounded-md overflow-hidden",children:c?e.jsx(Me,{}):e.jsx(Yr,{columns:V,data:R,isFullScreen:M})})]})})})};function Nt(){const s=z(n=>n.user.user),r="https://parallels.messold.com",a=async()=>{try{const n=await ve.get(`${r}/api/auth/google?context=brandSetup`,{withCredentials:!0}),{authUrl:l}=n.data;window.location.href=l}catch(n){console.error("Error getting Google Auth URL:",n)}};return e.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-xl p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"bg-red-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Ys,{className:"w-8 h-8 text-red-600"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"No GA4 Access Found"}),e.jsx("p",{className:"text-gray-600",children:"The current Google account doesn't have access to any GA4 properties"})]}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Gt,{className:"w-5 h-5 text-amber-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Currently signed in as:"}),e.jsx("p",{className:"font-medium text-gray-900",children:s==null?void 0:s.email})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Please sign in with a Google account that has access to GA4 properties to continue."}),e.jsxs("button",{className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2 group",onClick:a,children:["Sign in with a different account",e.jsx(jt,{className:"w-4 h-4 group-hover:translate-x-1 transition-transform"})]})]})]})})}function wi({platform:s,open:r,onOpenChange:a,brandId:n,onSuccess:l}){var _;const[o,m]=t.useState(""),[h,d]=t.useState([]),[c,p]=t.useState([]),[C,x]=t.useState([]),[S,A]=t.useState(!1),[y,b]=t.useState(!1),[$,v]=t.useState([]),w="https://parallels.messold.com",g=z(T=>T.user.user),F=g==null?void 0:g.id;console.log(F),t.useEffect(()=>{r&&n&&(async()=>{var f,P;try{const Z=(await ve.get(`${w}/api/brands/${n}`,{withCredentials:!0})).data,k=[];(f=Z.fbAdAccounts)!=null&&f.length&&k.push(...Z.fbAdAccounts),Z.googleAdAccount&&k.push(Z.googleAdAccount),(P=Z.ga4Account)!=null&&P.PropertyID&&k.push(Z.ga4Account.PropertyID),v(k)}catch(V){console.error("Error fetching connected accounts:",V)}})()},[n,r]),t.useEffect(()=>{(async()=>{var f;if(r){b(!0);try{let P="",V=null;switch(s.toLowerCase()){case"google ads":P="/api/setup/google-accounts",V=d;break;case"google analytics":P="/api/setup/ga4-propertyIds",V=p;break;case"facebook":P="/api/setup/fb-ad-accounts",V=x;break}if(console.log(`Calling API: ${w}${P} with userId: ${F}`),!P)throw new Error("Invalid platform");const Z=await ve.post(`${w}${P}`,{userId:F},{withCredentials:!0});Z.status===200&&(A(!1),s.toLowerCase()==="google ads"?V((f=Z.data)==null?void 0:f.clientAccounts.filter(k=>!k.hidden)):s.toLowerCase()==="google analytics"?V(Z.data.propertiesList||[]):s.toLowerCase()==="facebook"&&V(Z.data.adAccounts||[]))}catch(P){M(P,A)}finally{b(!1)}}})()},[s,F,r]);const M=(T,f)=>{const P=T;if(P.response){const{status:V,data:Z}=P.response,k=P.code;V===400||V===403?f(!0):V===401||k==="TOKEN_EXPIRED"?(alert("Your Google session has expired. Please log in again."),f(!0)):(console.error("Unhandled Error Status:",V),console.error("Error Message:",Z))}else P.request?console.error("No response received:",P.request):console.error("Unexpected Error:",P.message)},N=async(T,f)=>{try{let P={};switch(s.toLowerCase()){case"facebook":P={fbAdAccounts:[T]};break;case"google ads":P={googleAdAccount:T};break;case"google analytics":P={ga4Account:{PropertyID:T}};break}(await ve.patch(`${w}/api/brands/update/${n}`,P,{withCredentials:!0})).status===200&&(l==null||l(s,f,T),a(!1))}catch(P){console.error("Error updating brand:",P)}},u=async T=>{let f,P;if("clientId"in T)f=T.clientId,P=`${T.name} (${f})`;else if("propertyId"in T)f=T.propertyId,P=`${T.propertyName} (${f})`;else if("id"in T)f=T.id,P=`${T.adname}`;else return;await N(f,P)},I=async()=>{try{const T=await ve.get(`${w}/api/auth/google?context=brandSetup`,{withCredentials:!0}),{authUrl:f}=T.data;window.location.href=f}catch(T){console.error("Error getting Google Auth URL:",T)}},i=async()=>{try{const T=await ve.get(`${w}/api/auth/facebook`,{withCredentials:!0});T.data.success&&(window.location.href=T.data.authURL)}catch(T){console.error("Error getting Facebook Auth URL:",T)}},L=()=>{let T=[];switch(s.toLowerCase()){case"google ads":T=h;break;case"google analytics":T=c;break;case"facebook":T=C;break}return T.filter(f=>("clientId"in f?f.name:"propertyName"in f?f.propertyName:f.adname).toLowerCase().includes(o.toLowerCase()))};return e.jsx(Dr,{open:r,onOpenChange:a,children:e.jsxs(Qt,{className:"sm:max-w-[600px]",children:[e.jsx(Zt,{children:e.jsxs(qt,{children:["Connect ",s," Account"]})}),e.jsx("div",{className:"space-y-4",children:y?e.jsx("div",{className:"flex justify-center py-4",children:"Loading..."}):S?e.jsxs(D,{size:"sm",onClick:s.toLowerCase()==="facebook"?i:I,className:"flex items-center gap-2 bg-white text-black border border-green-800 hover:bg-green-50",children:[s.toLowerCase()==="google ads"&&e.jsxs(e.Fragment,{children:[e.jsx(Xe,{height:"1rem",width:"1rem"}),"Connect to your Google Ads account"]}),s.toLowerCase()==="google analytics"&&e.jsxs(e.Fragment,{children:[e.jsx(Re,{height:"1rem",width:"1rem"}),"Connect to your GA4 account"]}),s.toLowerCase()==="facebook"&&e.jsxs(e.Fragment,{children:[e.jsx(Qe,{height:"1rem",width:"1rem"}),"Connect to your Facebook account"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ws,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx(De,{type:"text",placeholder:"Search accounts...",className:"pl-10",value:o,onChange:T=>m(T.target.value)})]}),e.jsx("div",{className:"max-h-[50vh] overflow-auto",children:(_=L())==null?void 0:_.map(T=>{const f=s.toLowerCase()==="google ads",P=s.toLowerCase()==="facebook",V=f?T.clientId:P?T.id:T.propertyId,Z=f?T.name:P?T.adname:T.propertyName,k=f?e.jsx(Xe,{height:"1rem",width:"1rem"}):P?e.jsx(Qe,{height:"1rem",width:"1rem"}):e.jsx(Re,{height:"1rem",width:"1rem"}),j=$.includes(V);return e.jsxs("div",{className:"flex items-center justify-between p-2 rounded hover:bg-gray-50",children:[e.jsx("span",{children:e.jsxs("div",{className:"flex flex-row items-center gap-3",children:[k,P?`${Z}`:`${Z} (${V})`]})}),e.jsxs(D,{size:"sm",onClick:()=>u(T),disabled:j,className:j?"bg-gray-400":"bg-blue-600",children:[j&&e.jsx(Ss,{className:"h-4 w-4 mr-2"}),j?"Connected":"Connect"]})]},V)})})]})})]})})}const Ci={"google analytics":{title:"Google analytics",description:"Unlock powerful insights for your store",icon:e.jsx(mo,{className:"h-16 w-16 text-blue-500 animate-bounce"}),benefits:[{icon:e.jsx(at,{className:"h-8 w-8 text-primary"}),title:"Real-time Analytics",description:"Track visitor behavior as it happens"},{icon:e.jsx(Rs,{className:"h-8 w-8 text-primary"}),title:"Performance Metrics",description:"Monitor your store's key metrics"},{icon:e.jsx(tt,{className:"h-8 w-8 text-primary"}),title:"Growth Insights",description:"Make data-driven decisions"}],buttonText:"Connect GA4 Now",guideText:"Need help setting up GA4?"},"google ads":{title:"Google Ads",description:"Supercharge your advertising performance",icon:e.jsx(uo,{className:"h-16 w-16 text-red-500 animate-bounce"}),benefits:[{icon:e.jsx(at,{className:"h-8 w-8 text-primary"}),title:"Campaign Tracking",description:"Monitor ad performance in real-time"},{icon:e.jsx(Rs,{className:"h-8 w-8 text-primary"}),title:"Conversion Analytics",description:"Track ROI and conversions"},{icon:e.jsx(tt,{className:"h-8 w-8 text-primary"}),title:"Budget Optimization",description:"Optimize spending across campaigns"}],buttonText:"Connect Google Ads",guideText:"New to Google Ads?"},facebook:{title:"Facebook Ads",description:"Scale your social media advertising",icon:e.jsx(ho,{className:"h-16 w-16 text-blue-600 animate-bounce"}),benefits:[{icon:e.jsx(at,{className:"h-8 w-8 text-primary"}),title:"Audience Insights",description:"Understand your target audience"},{icon:e.jsx(Rs,{className:"h-8 w-8 text-primary"}),title:"Ad Performance",description:"Track engagement and reach"},{icon:e.jsx(tt,{className:"h-8 w-8 text-primary"}),title:"ROAS Tracking",description:"Measure advertising return"}],buttonText:"Connect Facebook Ads",guideText:"First time with Facebook Ads?"}},wt=({platform:s="google analytics",brandId:r,onSuccess:a})=>{const[n,l]=t.useState(!1),o=Ci[s],m=()=>{l(!0)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-background to-secondary/20 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-3xl mx-auto w-full space-y-8",children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"flex justify-center",children:o.icon}),e.jsxs("h1",{className:"text-4xl font-bold tracking-tight",children:["Connect ",o.title]}),e.jsx("p",{className:"text-xl text-muted-foreground",children:o.description})]}),e.jsx(le,{className:"p-6 bg-card/50 backdrop-blur-sm",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("p",{className:"text-lg text-center",children:["You haven't connected ",o.title," yet. You're missing out on valuable insights about your store's performance!"]}),e.jsx("div",{className:"grid md:grid-cols-3 gap-4 my-8",children:o.benefits.map((h,d)=>e.jsxs("div",{className:"flex flex-col items-center text-center p-4 space-y-2",children:[h.icon,e.jsx("h3",{className:"font-semibold",children:h.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:h.description})]},d))}),e.jsx("div",{className:"flex justify-center",children:e.jsxs(D,{size:"lg",className:"group",onClick:m,children:[o.buttonText,e.jsx(jt,{className:"ml-2 h-4 w-4 group-hover:translate-x-1 transition-transform"})]})})]})}),e.jsxs("p",{className:"text-center text-sm text-muted-foreground",children:[o.guideText," ",e.jsx("a",{href:"#",className:"text-primary hover:underline",children:"Check out our guide"})]})]})}),e.jsx(wi,{platform:o.title,open:n,onOpenChange:l,brandId:r,onSuccess:a})]})},Si=({dateRange:s})=>{const r=z(j=>j.date.from),a=z(j=>j.date.to),n=t.useMemo(()=>({from:r,to:a}),[r,a]),[l,o]=t.useState([]),[m,h]=t.useState([]),[d,c]=t.useState(!1),{brandId:p}=ge(),C=n!=null&&n.from?H(n.from,"yyyy-MM-dd"):"",x=n!=null&&n.to?H(n.to,"yyyy-MM-dd"):"",[S,A]=t.useState([]),[y,b]=t.useState([]),[$,v]=t.useState(!1),w=z(j=>j.user.user),g=Se(),F=ke();t.useEffect(()=>{s&&g(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),t.useEffect(()=>{$||s&&g(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[$,s]);const M=()=>{v(!$)},[N,u]=t.useState(S),[I,i]=t.useState(S),L=j=>{u(j)},_=j=>{i(j),u(j)};t.useEffect(()=>{u(S),i(S)},[S]);const T=t.useCallback(async()=>{c(!0);try{const E=(await F.post(`/api/analytics/dayAtcReport/${p}`,{startDate:C,endDate:x,userId:w==null?void 0:w.id},{withCredentials:!0})).data.data||[];if(h(E),o(E),E.length>0)if(S.length===0){const R=Object.keys(E[0]);A(R)}else{const R=Object.keys(E[0]);A(Y=>Y.filter(W=>R.includes(W)))}}catch(j){console.error("Error fetching day wise metrics data:",j)}finally{c(!1)}},[C,x,p]);t.useEffect(()=>{T();const j=setInterval(T,15*60*1e3);return()=>clearInterval(j)},[T]);const f=()=>{T()},P=t.useCallback(j=>{let E=[...m];j.forEach(R=>{E=E.filter(Y=>{const W=Y[R.column];if([">","<","="].includes(R.operator)){const O=parseFloat(W),J=parseFloat(R.value);switch(R.operator){case">":return O>J;case"<":return O<J;case"=":return O===J;default:return!0}}return!0})}),o(E)},[m]),V=t.useMemo(()=>l,[l]),Z=["Add To Cart","Checkouts","Sessions","Purchases","Purchase Rate","Add To Cart Rate","Checkout Rate"],k=j=>{b(y.filter((E,R)=>R!==j))};return e.jsx(le,{className:`mx-4 ${$?"fixed inset-0 z-50 m-0":""}`,children:e.jsx(ce,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Day wise E-Commerce Analytics"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[$&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{})}),e.jsx(D,{onClick:f,disabled:d,size:"icon",variant:"outline",children:e.jsx(fe,{className:`h-4 w-4 ${d?"animate-spin":""}`})}),e.jsx(yt,{visibleColumns:N,columnOrder:I,onVisibilityChange:L,onOrderChange:_}),e.jsx(Ls,{columns:Z,onFiltersChange:P,filters:y,setFilters:b}),e.jsx(D,{onClick:M,size:"icon",variant:"outline",children:$?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]}),y.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:y.map((j,E)=>e.jsxs("div",{className:"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",children:[e.jsx("span",{children:`${j.column} ${j.operator} ${j.value}`}),e.jsx("button",{onClick:()=>k(E),className:"ml-1 ring-offset-background rounded-full outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2","aria-label":"Remove filter",children:e.jsx(rs,{className:"h-3 w-3"})})]},E))}),e.jsx("div",{className:"rounded-md overflow-hidden",children:d?e.jsx(Me,{}):e.jsx(Yr,{columns:I,data:V,isFullScreen:$})})]})})})},Ai=()=>{const{brandId:s}=ge(),a=z(S=>S.brand.brands).find(S=>S._id===s),n=(a==null?void 0:a.ga4Account)??!1,{tokenError:l}=Qs(),o=z(S=>S.date.from),m=z(S=>S.date.to),h=t.useMemo(()=>({from:o,to:m}),[o,m]),d={from:h.from?new Date(h.from):void 0,to:h.to?new Date(h.to):void 0},[c,p]=t.useState("daily"),C=[{label:"Daily Metrics",value:"daily"},{label:"Day wise Metrics",value:"day wise"}],x=S=>{p(S)};return e.jsxs("div",{className:"flex h-screen bg-gray-100",children:[e.jsx(ts,{}),e.jsx("div",{className:"flex-1 h-screen overflow-auto",children:l?e.jsx(Nt,{}):n?e.jsxs(e.Fragment,{children:[e.jsx(js,{title:"E-Commerce Insighhts",Icon:Dt,showDatePicker:!0}),e.jsx("div",{className:"bg-white px-6 sticky top-0 z-10",children:e.jsx(zs,{tabs:C,activeTab:c,onTabChange:x})}),e.jsxs("section",{className:"my-3",children:[c==="daily"&&e.jsx(Ni,{dateRange:d}),c==="day wise"&&e.jsx(Si,{dateRange:d})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(wt,{platform:"google analytics",brandId:s??"",onSuccess:(S,A,y)=>{console.log(`Successfully connected ${S} account: ${A} (${y})`)}})," "]})}),e.jsx(gs,{})]})};function Ie({data:s,primaryColumn:r,secondaryColumns:a,monthlyDataKey:n,monthlyMetrics:l,isFullScreen:o,rows:m,isAdsTable:h}){const[d,c]=t.useState(1),[p,C]=t.useState([]),x=m||8,S=30,A=()=>o?h?"max-h-[calc(100vh-90px)]":"max-h-[calc(100vh-130px)]":"max-h-[400px]",y=t.useMemo(()=>{if(!Array.isArray(s))return console.error("Data is not an array:",s),[];const f=V=>["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][parseInt(V)-1],P=new Set;return s.forEach(V=>{const Z=V[n];Array.isArray(Z)&&Z.forEach(k=>{if(k!=null&&k.Month){const j=k.Month.slice(0,4),E=k.Month.slice(4);P.add(`${f(E)}-${j}`)}})}),Array.from(P).reverse()},[s,n]),b=t.useMemo(()=>{const f=[];return s.forEach((P,V)=>{l.forEach((Z,k)=>{f.push({dataIndex:V,metricIndex:k})})}),f},[s,l]),$=()=>{C(f=>[...f,...b.slice(f.length,f.length+S)])};t.useEffect(()=>{o&&C(b.slice(0,S))},[o,b]);const v=f=>{const{scrollTop:P,scrollHeight:V,clientHeight:Z}=f.currentTarget;V-P<=Z+100&&$()},w=t.useMemo(()=>o?p:b.slice((d-1)*x,d*x),[o,b,p,d]),g=t.useMemo(()=>{let f=0,P=0,V=0,Z=0,k=0,j=0,E=0,R=0,Y=0;return s.forEach(W=>{typeof W["Total Sessions"]=="number"&&typeof W["Avg Conv. Rate"]=="number"&&(f+=Number(W["Total Sessions"]),P+=Number(W["Avg Conv. Rate"]),V++),typeof W["Total Spend"]=="number"&&typeof W["Total Purchase ROAS"]=="number"&&(Z+=Number(W["Total Spend"]),k+=Number(W["Total Purchase ROAS"]),j++),typeof W["Total Cost"]=="number"&&typeof W["Conv. Value / Cost"]=="number"&&(E+=Number(W["Total Cost"]),R+=Number(W["Conv. Value / Cost"]),Y++)}),{avgSessions:V>0?f/V:0,avgConvRate:V>0?P/V:0,avgSpend:j>0?Z/j:0,avgPurchaseROAS:j>0?k/j:0,avgCost:Y>0?E/Y:0,avgConvValuePerCost:Y>0?R/Y:0}},[s]);t.useEffect(()=>{o||c(1)},[o]);const F=({sessions:f,convRate:P,spend:V,purchaseROAS:Z,cost:k,convValuePerCost:j})=>{const E=f!==void 0&&f>=g.avgSessions,R=P!==void 0&&P>=g.avgConvRate,Y=V!==void 0&&V>=g.avgSpend,W=Z!==void 0&&Z>=g.avgPurchaseROAS,O=k!==void 0&&k>=g.avgCost,J=j!==void 0&&j>=g.avgConvValuePerCost;return E&&R?"bg-green-100":E&&!R?"bg-[#E0F4FF]":!E&&R?"bg-yellow-100":Y&&W?"bg-green-100":Y&&!W?"bg-[#E0F4FF]":!Y&&W?"bg-yellow-100":O&&J?"bg-green-100":O&&!J?"bg-[#E0F4FF]":!O&&J?"bg-yellow-100":"bg-red-50"},M=(f,P)=>{if(typeof f=="number")switch(P){case"spend":return Math.round(f).toLocaleString();case"percentage":return`${f.toFixed(2)} %`;default:return f.toFixed(2)}return f},N=(f,P)=>{if(!f)return e.jsx("td",{className:"w-[100px] text-right whitespace-nowrap p-2 text-xs border-r border-slate-300 bg-background",children:"-"});const V=f[P];let Z="bg-background";return(P==="Sessions"||P==="Conv. Rate")&&typeof f.Sessions=="number"&&typeof f["Conv. Rate"]=="number"&&(Z=F({sessions:Number(f.Sessions),convRate:Number(f["Conv. Rate"])})),(P==="Spend"||P==="Purchase ROAS")&&typeof f.Spend=="number"&&typeof f["Purchase ROAS"]=="number"&&(Z=F({spend:Number(f.Spend),purchaseROAS:Number(f["Purchase ROAS"])})),(P==="Cost"||P==="Conv. Value/ Cost")&&typeof f.Cost=="number"&&typeof f["Conv. Value/ Cost"]=="number"&&(Z=F({cost:Number(f.Cost),convValuePerCost:Number(f["Conv. Value/ Cost"])})),e.jsxs("td",{className:`w-[100px]  text-right whitespace-nowrap p-2 text-xs border-r border-slate-300 ${Z}`,children:[M(V,P.toLowerCase().includes("rate")?"percentage":P.toLowerCase().includes("spend")||P.toLowerCase().includes("cost")?"spend":"default"),P==="Conv. Rate"&&e.jsx("div",{className:"text-xs text-muted-foreground",children:`Purchases: ${f.Purchases??0}`}),P==="Cost"&&e.jsx("div",{className:"text-xs text-muted-foreground",children:`clicks: ${f.Clicks??0}`}),P==="Conv. Value/ Cost"&&e.jsx("div",{className:"text-xs text-muted-foreground",children:`conv. rate: ${Number(f["Conversion Rate"]).toFixed(2)??0} %`}),P==="Purchase ROAS"&&e.jsx("div",{className:"text-xs text-muted-foreground",children:`PCV: ${Number(f["Purchase Conversion Value"]).toFixed(2)??0}`})]})},u=(f,P,V,Z)=>{const k=f[P];if(typeof k!="number")return e.jsx("td",{className:"sticky top-0 min-w-[130px] p-2 text-xs border-r border-slate-300 bg-background",style:{left:`${230+Z*130}px`},children:""});let j="bg-background";if(V&&P&&(P.includes("Sessions")||P.includes("Rate"))){const W=f["Total Sessions"],O=f["Avg Conv. Rate"];j=F({sessions:W,convRate:O})}if(V&&P&&(P.includes("Spend")||P.includes("ROAS"))){const W=f["Total Spend"],O=f["Total Purchase ROAS"];j=F({spend:W,purchaseROAS:O})}if(V&&P&&(P.includes("Cost")||P.includes("Conv. Value / Cost"))){const W=f["Total Cost"],O=f["Conv. Value / Cost"];j=F({cost:W,convValuePerCost:O})}const E=typeof f["Total Purchases"]=="number"?f["Total Purchases"].toLocaleString():null,R=typeof f["Total Conv. Value"]=="number"?f["Total Conv. Value"].toFixed(2):null,Y=typeof f["Total PCV"]=="number"?f["Total PCV"].toFixed(2):null;return e.jsx("td",{className:`sticky top-0 min-w-[130px] p-2 text-xs border-r border-slate-300 ${j}`,style:{left:`${230+Z*130}px`},children:V.toLowerCase()==="cost"&&P==="Total Cost"?e.jsx("div",{className:"flex flex-col",children:e.jsx("span",{children:M(k,"spend")})}):V.toLowerCase()==="conv. value/ cost"&&P==="Conv. Value / Cost"?e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:M(k)}),R&&e.jsxs("span",{className:"text-xs text-gray-500 mt-1",children:["Total Conv. Value: ",R]})]}):V.toLowerCase()==="sessions"&&P.includes("Sessions")?M(k):V.toLowerCase()==="conv. rate"&&P.includes("Rate")?e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:M(k,"percentage")}),E&&e.jsxs("span",{className:"text-xs text-gray-500 mt-1",children:["Total Purchases: ",E]})]}):V.toLowerCase()==="spend"&&P.includes("Total Spend")?M(k,"spend"):V.toLowerCase()=="purchase roas"&&P.includes("Total Purchase ROAS")?e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:M(k)}),Y&&e.jsxs("span",{className:"text-xs text-gray-500 mt-1",children:["Total PCV: ",Y]})]}):""})},I=(f,P)=>{const V=l[P];let Z="bg-background";if(a){const k=f["Total Sessions"],j=f["Avg Conv. Rate"],E=f["Total Spend"],R=f["Total Purchase ROAS"],Y=f["Total Cost"],W=f["Conv. Value / Cost"];V==="Sessions"||V==="Conv. Rate"?Z=F({sessions:k,convRate:j}):V==="Spend"||V==="Purchase ROAS"?Z=F({spend:E,purchaseROAS:R}):(V==="Cost"||V==="Conv. Value/ Cost")&&(Z=F({cost:Y,convValuePerCost:W}))}return e.jsxs("tr",{children:[e.jsx("td",{className:`sticky left-0 min-w-[130px] max-w-[200px] p-2 text-xs border-r border-slate-300 ${Z}`,children:P===0&&(typeof f[r]=="string"||typeof f[r]=="number")?M(f[r]):""}),e.jsx("td",{className:`sticky left-[130px] min-w-[100px] whitespace-nowrap p-2 text-xs border-r border-slate-300 ${Z}`,children:V}),a==null?void 0:a.map((k,j)=>u(f,k,V,j)),y.map(k=>{const j=J=>["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].indexOf(J)+1,[E,R]=k.split("-"),Y=j(E),W=`${R}${Y.toString().padStart(2,"0")}`,O=f[n].find(J=>J.Month===W);return N(O,V)})]},`${f[r]}-${V}`)},i=b.length,L=Math.ceil(i/x),_=f=>{const P=Math.max(1,Math.min(f,L));c(P)},T=(f,P)=>{let V="";return f==="Total Sessions"?V=`(avg: ${Math.round(g.avgSessions).toLocaleString()})`:f==="Avg Conv. Rate"?V=`(avg: ${g.avgConvRate.toFixed(2)}%)`:f==="Total Spend"?V=`(avg: ${Math.round(g.avgSpend).toLocaleString()})`:f==="Total Purchase ROAS"?V=`(avg: ${g.avgPurchaseROAS.toFixed(2)})`:f==="Total Cost"?V=`(avg: ${Math.round(g.avgCost).toLocaleString()})`:f==="Conv. Value / Cost"&&(V=`(avg: ${Math.round(g.avgConvValuePerCost).toFixed(2)})`),e.jsx("th",{className:"sticky top-0 min-w-[130px] w-[150px] z-20 px-2 py-2.5 text-left text-sm font-semibold text-black/70 border-r border-b border-slate-300 bg-slate-100",style:{left:`${230+P*130}px`},children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:f}),V&&e.jsx("span",{className:"text-xs text-muted-foreground font-normal",children:V})]})},f)};return e.jsxs("div",{id:"age-report-table",className:"w-full rounded-lg border flex flex-col",children:[e.jsx("div",{className:`relative overflow-x-auto ${A()}`,onScroll:o?v:void 0,children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"sticky left-0 top-0 min-w-[130px]  w-[150px] z-20 px-2 py-2.5 text-left text-sm font-semibold text-black/70 border-r border-b border-slate-300 bg-slate-100",children:r}),e.jsx("th",{className:"sticky left-[130px] top-0 min-w-[100px] w-[150px] z-20 px-2 py-2.5 text-left text-sm font-semibold text-black/70 border-r border-b border-slate-300 bg-slate-100",children:"Metric"}),a==null?void 0:a.map((f,P)=>T(f,P)),y.map(f=>e.jsx("th",{className:"sticky top-0 min-w-[100px] z-10 px-2 py-2.5 text-right text-sm font-semibold text-black/70 whitespace-nowrap border-r border-b border-slate-300  bg-zinc-50",children:f},f))]})}),e.jsx("tbody",{className:"divide-y divide-slate-300",children:w.map(({dataIndex:f,metricIndex:P})=>I(s[f],P))})]})}),!o&&e.jsxs("div",{className:"border-t border-slate-300 p-2.5 flex items-center justify-between bg-background",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",(d-1)*x+1,"-",Math.min(d*x,i)," of ",i," rows"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(D,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>_(1),disabled:d===1,children:e.jsx(Vt,{className:"h-4 w-4"})}),e.jsx(D,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>_(d-1),disabled:d===1,children:e.jsx(Ps,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-center justify-center text-sm",children:["Page ",d," of ",L]}),e.jsx(D,{variant:"outline",className:"h-8 w-8 p-0",onClick:()=>_(d+1),disabled:d===L,children:e.jsx(xs,{className:"h-4 w-4"})}),e.jsx(D,{variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>_(L),disabled:d===L,children:e.jsx(Ut,{className:"h-4 w-4"})})]})]})]})}const Pe=({data:s,primaryColumn:r,metricConfig:a})=>{var h,d,c;const[n,l]=t.useState(null),o=t.useMemo(()=>{const p={[a.primary.key]:0,[a.secondary.key]:0};let C=0;return s.forEach(x=>{const S=x[a.primary.key],A=x[a.secondary.key];typeof S=="number"&&typeof A=="number"&&(p[a.primary.key]+=Number(S),p[a.secondary.key]+=Number(A),C++)}),{[a.primary.key]:p[a.primary.key]/C,[a.secondary.key]:p[a.secondary.key]/C}},[s,a]),m=t.useMemo(()=>{const p={"Top Performers":[],[`High ${a.primary.name}`]:[],[`High ${a.secondary.name}`]:[],Underperformers:[]};return s.forEach(C=>{const x=Number(C[a.primary.key]),S=Number(C[a.secondary.key]),A=String(C[r]),y=x>=o[a.primary.key],b=S>=o[a.secondary.key];y&&b?p["Top Performers"].push(A):y&&!b?p[`High ${a.primary.name}`].push(A):!y&&b?p[`High ${a.secondary.name}`].push(A):p.Underperformers.push(A)}),[{name:"Top Performers",color:"text-green-700",bgColor:"bg-green-100",count:p["Top Performers"].length,items:p["Top Performers"],description:`Above average in both ${a.primary.name} (>${o[a.primary.key].toFixed(2)}) and ${a.secondary.name} (>${o[a.secondary.key].toFixed(2)})`},{name:`High ${a.primary.name}`,color:"text-blue-700",bgColor:"bg-[#E0F4FF]",count:p[`High ${a.primary.name}`].length,items:p[`High ${a.primary.name}`],description:`High ${a.primary.name} (>${o[a.primary.key].toFixed(2)}) but below average ${a.secondary.name} (<${o[a.secondary.key].toFixed(2)})`},{name:`High ${a.secondary.name}`,color:"text-yellow-700",bgColor:"bg-yellow-100",count:p[`High ${a.secondary.name}`].length,items:p[`High ${a.secondary.name}`],description:`High ${a.secondary.name} (>${o[a.secondary.key].toFixed(2)}) but below average ${a.primary.name} (<${o[a.primary.key].toFixed(2)})`},{name:"Underperformers",color:"text-red-700",bgColor:"bg-red-50",count:p.Underperformers.length,items:p.Underperformers,description:`Below average in both ${a.primary.name} (<${o[a.primary.key].toFixed(2)}) and ${a.secondary.name} (<${o[a.secondary.key].toFixed(2)})`}]},[s,o,r,a]);return e.jsx(Ds,{children:e.jsx("div",{id:"age-report-performance",className:"space-y-4 py-2.5",children:e.jsxs("div",{className:"border border-gray-300 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"flex items-stretch h-9",children:m.map(p=>e.jsxs(os,{children:[e.jsx(ls,{asChild:!0,children:e.jsx("div",{className:`relative flex-grow ${p.bgColor} border-r last:border-r-0 border-gray-300 cursor-pointer transition-all duration-300 ease-in-out hover:opacity-90`,onClick:()=>l(n===p.name?null:p.name),children:e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("span",{className:`text-xs font-medium ${p.color} ${n===p.name?"underline":""}`,children:[p.name," (",p.count,")"]})})})}),e.jsx(as,{className:"max-w-xs p-4 bg-gray-900 text-white border-0 shadow-lg",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-lg ${p.bgColor} border border-white/20 flex items-center justify-center`,children:e.jsx("div",{className:`w-4 h-4 rounded-md ${p.color.replace("text-","bg-")}`})}),e.jsx("p",{className:"font-medium text-lg text-white",children:p.name})]}),e.jsx("p",{className:"text-sm text-gray-200",children:p.description})]})})]},p.name))}),n&&e.jsxs("div",{className:"p-4 bg-white border-t border-gray-200",children:[e.jsxs("h3",{className:`text-lg font-semibold mb-2 flex items-center gap-2 ${(h=m.find(p=>p.name===n))==null?void 0:h.color}`,children:[n,e.jsx("span",{className:`w-3 h-3 rounded-lg ${(d=m.find(p=>p.name===n))==null?void 0:d.bgColor} border border-gray-200`})]}),e.jsx("ul",{className:"grid grid-cols-4 list-disc pl-5 max-h-40 overflow-y-auto gap-4",children:(c=m.find(p=>p.name===n))==null?void 0:c.items.map((p,C)=>e.jsx("li",{className:"text-sm mb-1 break-words w-full",children:p},C))})]})]})})})},Le={sessionsAndConversion:{primary:{key:"Total Sessions",name:"Sessions"},secondary:{key:"Avg Conv. Rate",name:"Conversion"}},spendAndRoas:{primary:{key:"Total Spend",name:"Spend"},secondary:{key:"Total Purchase ROAS",name:"Purchase ROAS"}}},ki={green:{patternType:"solid",fgColor:{rgb:"DCFCE7"}},blue:{patternType:"solid",fgColor:{rgb:"DBEAFE"}},yellow:{patternType:"solid",fgColor:{rgb:"FEF9C3"}},red:{patternType:"solid",fgColor:{rgb:"FEF2F2"}},header:{patternType:"solid",fgColor:{rgb:"F1F5F9"}}},Mi=s=>{let r=0,a=0,n=0;return s.forEach(l=>{typeof l["Total Sessions"]=="number"&&typeof l["Avg Conv. Rate"]=="number"&&(r+=Number(l["Total Sessions"]),a+=Number(l["Avg Conv. Rate"]),n++)}),{avgSessions:r/n,avgConvRate:a/n}},Ti=(s,r,a,n,l)=>{if((s==="Sessions"||s==="Conv. Rate")&&typeof r=="number"&&typeof a=="number"){const o=r>=n.avgSessions,m=a>=n.avgConvRate;return o&&m?l.green:o&&!m?l.blue:!o&&m?l.yellow:l.red}},Ii=(s,r,a,n,l,o,m,h)=>{const d=As.utils.decode_range(s["!ref"]||"A1");for(let c=d.s.c;c<=d.e.c;c++){const p=As.utils.encode_cell({r:0,c});s[p]||(s[p]={v:""}),s[p].s={fill:m.header,font:{bold:!0,color:{rgb:"64748B"}},alignment:{horizontal:"left"}}}r.forEach((c,p)=>{o.forEach((C,x)=>{const S=p*o.length+x+2,A=2,y=a.length+n.length+1;for(let b=A;b<=y;b++){const $=As.utils.encode_cell({r:S-1,c:b});s[$]||(s[$]={v:""});let v={font:{color:{rgb:"000000"}},alignment:{horizontal:"right"},format:C==="Conv. Rate"?"0.00%":"#,##0"},w,g;if(b<A+n.length)w=c["Total Sessions"],g=c["Avg Conv. Rate"];else{const M=b-(A+n.length),N=a[M],u=c[l].find(I=>`${I.Month.slice(0,4)}-${I.Month.slice(4)}`===N);u&&(w=u.Sessions,g=u["Conv. Rate"])}const F=Ti(C,w,g,h,m);F&&(v.fill=F),s[$].s=v}})})},es=({data:s,fileName:r,primaryColumn:a,secondaryColumns:n,monthlyDataKey:l,monthlyMetrics:o,buttonClassName:m="",disabled:h=!1})=>{const d=()=>{const c=As.utils.book_new(),p=[],C=Mi(s),x=Array.from(new Set(s.flatMap(b=>b[l].map($=>`${$.Month.slice(0,4)}-${$.Month.slice(4)}`)))).sort().reverse(),S=[a,"Metric",...n,...x];p.push(S),s.forEach(b=>{o.forEach($=>{const v=[];v.push($===o[0]?b[a]:""),v.push($),n.forEach(w=>{const g=b[w];v.push(typeof g=="number"?Number(g.toFixed(2)):null)}),x.forEach(w=>{const g=b[l].find(M=>`${M.Month.slice(0,4)}-${M.Month.slice(4)}`===w),F=g?g[$]:null;v.push(typeof F=="number"?Number(F.toFixed(2)):null)}),p.push(v)})});const A=As.utils.aoa_to_sheet(p);Ii(A,s,x,n,l,o,ki,C);const y=[{wch:20},{wch:12},...n.map(()=>({wch:15})),...x.map(()=>({wch:12}))];A["!cols"]=y,As.utils.book_append_sheet(c,A,"Conversion Data"),As.writeFile(c,`${r}.xlsx`)};return e.jsx(D,{id:"download-button",onClick:d,size:"icon",variant:"outline",className:m,disabled:h,children:e.jsx(xo,{className:"h-4 w-4"})})},Fi={},Wr=$s({name:"conversionFilters",initialState:Fi,reducers:{setFilter:(s,r)=>{const{componentId:a,column:n,filter:l}=r.payload;s[a]||(s[a]={}),JSON.stringify(s[a][n])!==JSON.stringify(l)&&(s[a][n]=l)},clearFilters:(s,r)=>{const a=r.payload;Object.keys(s[a]||{}).length>0&&(s[a]={})}}}),{setFilter:$i,clearFilters:Pi}=Wr.actions,Li=Wr.reducer,Ei=["Total Sessions","Avg Conv Rate","Total Cost","Conv. Value / Cost"];function Ve({componentId:s,availableColumns:r=Ei}){const a=Se(),n=z(b=>b.conversionFilters[s]||{}),[l,o]=t.useState(r[0]),[m,h]=t.useState(">"),[d,c]=t.useState(void 0),[p,C]=t.useState(!1),x=()=>{if(d===void 0||isNaN(d)){alert("Please enter a valid value");return}a($i({componentId:s,column:l,filter:{value:d,operator:m}})),C(!1)},S=()=>{a(Pi(s)),o(r[0]),h(">"),c(void 0),C(!1)},A=Object.values(n).some(b=>b!==null),y=Object.entries(n).filter(([b,$])=>$!==null).map(([b,$])=>`${b}: ${$==null?void 0:$.operator} ${$==null?void 0:$.value}`).join(", ");return e.jsx(Ds,{children:e.jsxs(os,{open:A,children:[e.jsxs(cs,{open:p,onOpenChange:C,children:[e.jsx(ds,{asChild:!0,children:e.jsx(ls,{children:e.jsx(D,{variant:"outline",size:"icon",children:e.jsx(ks,{className:`h-4 w-4 ${A?"text-blue-500":""}`})})})}),e.jsxs(ns,{className:"w-80 p-4 flex flex-col gap-4",children:[e.jsxs(qe,{onValueChange:b=>o(b),value:l,children:[e.jsx(We,{children:e.jsx(Je,{placeholder:"Select Column"})}),e.jsx(Ke,{id:"metric-dropdown",children:r.map(b=>e.jsx(Te,{value:b,children:b},b))})]}),e.jsxs(qe,{onValueChange:h,value:m,children:[e.jsx(We,{children:e.jsx(Je,{placeholder:"Select Operator"})}),e.jsxs(Ke,{id:"condition-dropdown",children:[e.jsx(Te,{value:">",children:"Greater Than ( > )"}),e.jsx(Te,{value:">=",children:"Greater Than or Equal To ( >= )"}),e.jsx(Te,{value:"<",children:"Less Than ( < )"}),e.jsx(Te,{value:"<=",children:"Less Than or Equal To ( <= )"}),e.jsx(Te,{value:"==",children:"Equal To ( == )"})]})]}),e.jsx(De,{id:"value-input",type:"number",placeholder:"Enter Value",value:d===void 0?"":d,onChange:b=>c(parseFloat(b.target.value)),className:"w-full"}),e.jsxs("div",{id:"Apply the Filter",className:"flex flex-row gap-2 items-center justify-center w-full",children:[e.jsx(D,{onClick:x,className:"w-full",children:"Add Filter"}),e.jsx(D,{id:"clear-button",variant:"destructive",className:"w-full",onClick:S,children:"Clear"})]})]})]}),e.jsx(as,{children:y})]})})}const Ri=({dateRange:s})=>{const r=z(i=>i.date.from),a=z(i=>i.date.to),n=t.useMemo(()=>({from:r,to:a}),[r,a]),l=Se(),[o,m]=t.useState(null),[h,d]=t.useState(!0),[c,p]=t.useState(!1),C="device-conversion",x=z(i=>i.user.user,Ae),{brandId:S}=ge(),A=()=>{p(!c)},y=ke(),b=n!=null&&n.from?H(n.from,"yyyy-MM-dd"):"",$=n!=null&&n.to?H(n.to,"yyyy-MM-dd"):"",v=z(i=>i.conversionFilters[C]||{},Ae),w=t.useMemo(()=>Object.entries(v).reduce((i,[L,_])=>{if(_){const T={"Total Sessions":"sessionsFilter","Avg Conv Rate":"convRateFilter"}[L]||L;i[T]=_}return i},{}),[v]),g=t.useCallback(async()=>{d(!0);try{const L=(await y.post(`/api/analytics/deviceTypeConversionReport/${S}`,{userId:x==null?void 0:x.id,startDate:b,endDate:$,...w})).data||[];m(L)}catch(i){console.error("Error fetching data:",i)}finally{d(!1)}},[S,b,$,w,x==null?void 0:x.id]);t.useEffect(()=>{g();const i=setInterval(g,15*60*1e3);return()=>clearInterval(i)},[g]),t.useEffect(()=>{s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),t.useEffect(()=>{c||s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[c,s]);const F=()=>{g()},M="Device",N=["Total Sessions","Avg Conv. Rate"],u="MonthlyData",I=["Sessions","Conv. Rate"];return e.jsx(le,{className:`${c?"fixed inset-0 z-50 m-0":""}`,children:e.jsxs(ce,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Device based Conversion"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[c&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{defaultDate:{from:new Date(new Date().getFullYear(),new Date().getMonth(),1),to:new Date}})}),e.jsx(D,{onClick:F,disabled:h,size:"icon",variant:"outline",children:e.jsx(fe,{className:`h-4 w-4 ${h?"animate-spin":""}`})}),e.jsx(Ve,{componentId:C}),e.jsx(es,{data:(o==null?void 0:o.data)||[],fileName:`${M}_Conversion_Report`,primaryColumn:M,secondaryColumns:N,monthlyDataKey:u,monthlyMetrics:I,disabled:h}),e.jsx(D,{onClick:A,size:"icon",variant:"outline",children:c?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"rounded-md overflow-hidden",children:h?e.jsx(Me,{}):e.jsxs("div",{children:[e.jsx(Pe,{data:(o==null?void 0:o.data)||[],primaryColumn:M,metricConfig:Le.sessionsAndConversion||{}}),e.jsx(Ie,{data:(o==null?void 0:o.data)||[],primaryColumn:M,secondaryColumns:N,monthlyDataKey:u,monthlyMetrics:I,isFullScreen:c})]})})]})})},Oi=({dateRange:s})=>{const r=z(i=>i.date.from),a=z(i=>i.date.to),n=t.useMemo(()=>({from:r,to:a}),[r,a]),l=Se(),[o,m]=t.useState(null),[h,d]=t.useState(!0),[c,p]=t.useState(!1),C="gender-conversion",x=z(i=>i.user.user,Ae),{brandId:S}=ge(),A=()=>{p(!c)},y=n!=null&&n.from?H(n.from,"yyyy-MM-dd"):"",b=n!=null&&n.to?H(n.to,"yyyy-MM-dd"):"",$=ke(),v=z(i=>i.conversionFilters[C]||{},Ae),w=t.useMemo(()=>Object.entries(v).reduce((i,[L,_])=>{if(_){const T={"Total Sessions":"sessionsFilter","Avg Conv Rate":"convRateFilter"}[L]||L;i[T]=_}return i},{}),[v]),g=t.useCallback(async()=>{d(!0);try{const L=(await $.post(`/api/analytics/genderConversionReport/${S}`,{userId:x==null?void 0:x.id,startDate:y,endDate:b,...w})).data||[];m(L)}catch(i){console.error("Error fetching data:",i)}finally{d(!1)}},[S,y,b,w,x==null?void 0:x.id]);t.useEffect(()=>{g();const i=setInterval(g,15*60*1e3);return()=>clearInterval(i)},[g]),t.useEffect(()=>{s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),t.useEffect(()=>{c||s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[c,s]);const F=()=>{g()},M="Gender",N=["Total Sessions","Avg Conv. Rate"],u="MonthlyData",I=["Sessions","Conv. Rate"];return e.jsx(le,{className:`${c?"fixed inset-0 z-50 m-0":""}`,children:e.jsxs(ce,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Gender based Conversion"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[c&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{defaultDate:{from:new Date(new Date().getFullYear(),new Date().getMonth(),1),to:new Date}})}),e.jsx(D,{onClick:F,disabled:h,size:"icon",variant:"outline",children:e.jsx(fe,{className:`h-4 w-4 ${h?"animate-spin":""}`})}),e.jsx(Ve,{componentId:C}),e.jsx(es,{data:(o==null?void 0:o.data)||[],fileName:`${M}_Conversion_Report`,primaryColumn:M,secondaryColumns:N,monthlyDataKey:u,monthlyMetrics:I,disabled:h}),e.jsx(D,{onClick:A,size:"icon",variant:"outline",children:c?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"rounded-md overflow-hidden",children:h?e.jsx(Me,{}):e.jsxs("div",{children:[e.jsx(Pe,{data:(o==null?void 0:o.data)||[],primaryColumn:M,metricConfig:Le.sessionsAndConversion||{}}),e.jsx(Ie,{data:(o==null?void 0:o.data)||[],primaryColumn:M,secondaryColumns:N,monthlyDataKey:u,monthlyMetrics:I,isFullScreen:c})]})})]})})},Di=({dateRange:s})=>{const r=z(i=>i.date.from),a=z(i=>i.date.to),n=t.useMemo(()=>({from:r,to:a}),[r,a]),[l,o]=t.useState(null),[m,h]=t.useState(!0),[d,c]=t.useState(!1),p=Se(),C="age-conversion",x=z(i=>i.conversionFilters[C]||{},Ae),S=z(i=>i.user.user,Ae),{brandId:A}=ge(),y=()=>{c(!d)},b=n!=null&&n.from?H(n.from,"yyyy-MM-dd"):"",$=n!=null&&n.to?H(n.to,"yyyy-MM-dd"):"",v=ke(),w=t.useMemo(()=>Object.entries(x).reduce((i,[L,_])=>{if(_){const T={"Total Sessions":"sessionsFilter","Avg Conv Rate":"convRateFilter"}[L]||L;i[T]=_}return i},{}),[x]),g=t.useCallback(async()=>{h(!0);try{const L=(await v.post(`/api/analytics/ageConversionReport/${A}`,{userId:S==null?void 0:S.id,startDate:b,endDate:$,...w},{withCredentials:!0})).data||[];o(L)}catch(i){console.error("Error fetching data:",i)}finally{h(!1)}},[A,b,$,w,S==null?void 0:S.id]);t.useEffect(()=>{g();const i=setInterval(g,15*60*1e3);return()=>clearInterval(i)},[g]),t.useEffect(()=>{s&&p(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),t.useEffect(()=>{d||s&&p(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[d,s]);const F=()=>{g()},M="Age",N=["Total Sessions","Avg Conv. Rate"],u="MonthlyData",I=["Sessions","Conv. Rate"];return e.jsx(le,{id:"age-report",className:`${d?"fixed inset-0 z-50 m-0":""}`,children:e.jsxs(ce,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Age based Conversion"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[d&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{defaultDate:{from:new Date(new Date().getFullYear(),new Date().getMonth(),1),to:new Date}})}),e.jsx(D,{id:"refresh",onClick:F,disabled:m,size:"icon",variant:"outline",children:e.jsx(fe,{className:`h-4 w-4 ${m?"animate-spin":""}`})}),e.jsx("div",{id:"filters",children:e.jsx(Ve,{componentId:C})}),e.jsx(es,{data:(l==null?void 0:l.data)||[],fileName:`${M}_Conversion_Report`,primaryColumn:M,secondaryColumns:N,monthlyDataKey:u,monthlyMetrics:I,disabled:m}),e.jsx(D,{id:"expand-button",onClick:y,size:"icon",variant:"outline",children:d?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"rounded-md overflow-hidden",children:m?e.jsx(Me,{}):e.jsxs("div",{children:[e.jsx(Pe,{data:(l==null?void 0:l.data)||[],primaryColumn:M,metricConfig:Le.sessionsAndConversion||{}}),e.jsx(Ie,{data:(l==null?void 0:l.data)||[],primaryColumn:M,secondaryColumns:N,monthlyDataKey:u,monthlyMetrics:I,isFullScreen:d})]})})]})})},zi=({dateRange:s})=>{const r=z(i=>i.date.from),a=z(i=>i.date.to),n=t.useMemo(()=>({from:r,to:a}),[r,a]),l=Se(),[o,m]=t.useState(null),[h,d]=t.useState(!0),[c,p]=t.useState(!1),C="interest-conversion",x=z(i=>i.user.user,Ae),{brandId:S}=ge(),A=()=>{p(!c)},y=n!=null&&n.from?H(n.from,"yyyy-MM-dd"):"",b=n!=null&&n.to?H(n.to,"yyyy-MM-dd"):"",$=ke(),v=z(i=>i.conversionFilters[C]||{},Ae),w=t.useMemo(()=>Object.entries(v).reduce((i,[L,_])=>{if(_){const T={"Total Sessions":"sessionsFilter","Avg Conv Rate":"convRateFilter"}[L]||L;i[T]=_}return i},{}),[v]),g=t.useCallback(async()=>{d(!0);try{const L=(await $.post(`/api/analytics/interestConversionReport/${S}`,{userId:x==null?void 0:x.id,startDate:y,endDate:b,...w})).data||[];m(L)}catch(i){console.error("Error fetching data:",i)}finally{d(!1)}},[S,y,b,w,x==null?void 0:x.id]);t.useEffect(()=>{g();const i=setInterval(g,15*60*1e3);return()=>clearInterval(i)},[g]),t.useEffect(()=>{s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),t.useEffect(()=>{c||s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[c,s]);const F=()=>{g()},M="Interest",N=["Total Sessions","Avg Conv. Rate"],u="MonthlyData",I=["Sessions","Conv. Rate"];return e.jsx(le,{className:`${c?"fixed inset-0 z-50 m-0":""}`,children:e.jsxs(ce,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Interest based Conversion"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[c&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{defaultDate:{from:new Date(new Date().getFullYear(),new Date().getMonth(),1),to:new Date}})}),e.jsx(D,{onClick:F,disabled:h,size:"icon",variant:"outline",children:e.jsx(fe,{className:`h-4 w-4 ${h?"animate-spin":""}`})}),e.jsx(Ve,{componentId:C}),e.jsx(es,{data:(o==null?void 0:o.data)||[],fileName:`${M}_Conversion_Report`,primaryColumn:M,secondaryColumns:N,monthlyDataKey:u,monthlyMetrics:I,disabled:h}),e.jsx(D,{onClick:A,size:"icon",variant:"outline",children:c?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"rounded-md overflow-hidden",children:h?e.jsx(Me,{}):e.jsxs("div",{children:[e.jsx(Pe,{data:(o==null?void 0:o.data)||[],primaryColumn:M,metricConfig:Le.sessionsAndConversion||{}}),e.jsx(Ie,{data:(o==null?void 0:o.data)||[],primaryColumn:M,secondaryColumns:N,monthlyDataKey:u,monthlyMetrics:I,isFullScreen:c})]})})]})})},Gi=({dateRange:s})=>{const r=z(i=>i.date.from),a=z(i=>i.date.to),n=t.useMemo(()=>({from:r,to:a}),[r,a]),l=Se(),[o,m]=t.useState(null),[h,d]=t.useState(!0),[c,p]=t.useState(!1),C="operatingSystem-conversion",x=z(i=>i.user.user,Ae),{brandId:S}=ge(),A=()=>{p(!c)},y=n!=null&&n.from?H(n.from,"yyyy-MM-dd"):"",b=n!=null&&n.to?H(n.to,"yyyy-MM-dd"):"",$=ke(),v=z(i=>i.conversionFilters[C]||{},Ae),w=t.useMemo(()=>Object.entries(v).reduce((i,[L,_])=>{if(_){const T={"Total Sessions":"sessionsFilter","Avg Conv Rate":"convRateFilter"}[L]||L;i[T]=_}return i},{}),[v]),g=t.useCallback(async()=>{d(!0);try{const L=(await $.post(`/api/analytics/operatingSystemConversionReport/${S}`,{userId:x==null?void 0:x.id,startDate:y,endDate:b,...w})).data||[];m(L)}catch(i){console.error("Error fetching data:",i)}finally{d(!1)}},[S,y,b,w,x==null?void 0:x.id]);t.useEffect(()=>{g();const i=setInterval(g,15*60*1e3);return()=>clearInterval(i)},[g]),t.useEffect(()=>{s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),t.useEffect(()=>{c||s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[c,s]);const F=()=>{g()},M="Operating System",N=["Total Sessions","Avg Conv. Rate"],u="MonthlyData",I=["Sessions","Conv. Rate"];return e.jsx(le,{className:`${c?"fixed inset-0 z-50 m-0":""} overflow-auto`,children:e.jsxs(ce,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Operating System based Conversion"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[c&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{defaultDate:{from:new Date(new Date().getFullYear(),new Date().getMonth(),1),to:new Date}})}),e.jsx(D,{onClick:F,disabled:h,size:"icon",variant:"outline",children:e.jsx(fe,{className:`h-4 w-4 ${h?"animate-spin":""}`})}),e.jsx(Ve,{componentId:C}),e.jsx(es,{data:(o==null?void 0:o.data)||[],fileName:`${M}_Conversion_Report`,primaryColumn:M,secondaryColumns:N,monthlyDataKey:u,monthlyMetrics:I,disabled:h}),e.jsx(D,{onClick:A,size:"icon",variant:"outline",children:c?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"rounded-md overflow-hidden",children:h?e.jsx(Me,{}):e.jsxs("div",{children:[e.jsx(Pe,{data:(o==null?void 0:o.data)||[],primaryColumn:M,metricConfig:Le.sessionsAndConversion||{}}),e.jsx(Ie,{data:(o==null?void 0:o.data)||[],primaryColumn:M,secondaryColumns:N,monthlyDataKey:u,monthlyMetrics:I,isFullScreen:c})]})})]})})},_i=({dateRange:s})=>{const r=z(_=>_.date.from),a=z(_=>_.date.to),n=t.useMemo(()=>({from:r,to:a}),[r,a]),l=Se(),[o,m]=t.useState(null),[h,d]=t.useState(!0),[c,p]=t.useState(!1),C="browser-conversion",x=z(_=>_.user.user),{brandId:S}=ge(),A=()=>{p(!c)},{sessionsFilter:y,convRateFilter:b}=z(_=>_.conversionFilters[C]||{sessionsFilter:null,convRateFilter:null}),$=n!=null&&n.from?H(n.from,"yyyy-MM-dd"):"",v=n!=null&&n.to?H(n.to,"yyyy-MM-dd"):"",w=ke(),g=z(_=>_.conversionFilters[C]||{},Ae),F=t.useMemo(()=>Object.entries(g).reduce((_,[T,f])=>{if(f){const P={"Total Sessions":"sessionsFilter","Avg Conv Rate":"convRateFilter"}[T]||T;_[P]=f}return _},{}),[g]),M=t.useCallback(async()=>{d(!0);try{const T=(await w.post(`/api/analytics/browserConversionReport/${S}`,{userId:x==null?void 0:x.id,startDate:$,endDate:v,sessionsFilter:y,convRateFilter:b})).data||[];m(T)}catch(_){console.error("Error fetching data:",_)}finally{d(!1)}},[S,$,v,F,x==null?void 0:x.id]);t.useEffect(()=>{M();const _=setInterval(M,15*60*1e3);return()=>clearInterval(_)},[M]),t.useEffect(()=>{s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),t.useEffect(()=>{c||s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[c,s]);const N=()=>{M()},u="Browser",I=["Total Sessions","Avg Conv. Rate"],i="MonthlyData",L=["Sessions","Conv. Rate"];return e.jsx(le,{className:`${c?"fixed inset-0 z-50 m-0":""}`,children:e.jsxs(ce,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Browser based Conversion"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[c&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{defaultDate:{from:new Date(new Date().getFullYear(),new Date().getMonth(),1),to:new Date}})}),e.jsx(D,{onClick:N,disabled:h,size:"icon",variant:"outline",children:e.jsx(fe,{className:`h-4 w-4 ${h?"animate-spin":""}`})}),e.jsx(Ve,{componentId:C}),e.jsx(es,{data:(o==null?void 0:o.data)||[],fileName:`${u}_Conversion_Report`,primaryColumn:u,secondaryColumns:I,monthlyDataKey:i,monthlyMetrics:L,disabled:h}),e.jsx(D,{onClick:A,size:"icon",variant:"outline",children:c?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"rounded-md overflow-hidden",children:h?e.jsx(Me,{}):e.jsxs("div",{children:[e.jsx(Pe,{data:(o==null?void 0:o.data)||[],primaryColumn:u,metricConfig:Le.sessionsAndConversion||{}}),e.jsx(Ie,{data:(o==null?void 0:o.data)||[],primaryColumn:u,secondaryColumns:I,monthlyDataKey:i,monthlyMetrics:L,isFullScreen:c})]})})]})})},Bi=({dateRange:s})=>{const r=z(i=>i.date.from),a=z(i=>i.date.to),n=t.useMemo(()=>({from:r,to:a}),[r,a]),l=Se(),[o,m]=t.useState(null),[h,d]=t.useState(!0),[c,p]=t.useState(!1),C="source-conversion",x=z(i=>i.user.user,Ae),{brandId:S}=ge(),A=()=>{p(!c)},y=n!=null&&n.from?H(n.from,"yyyy-MM-dd"):"",b=n!=null&&n.to?H(n.to,"yyyy-MM-dd"):"",$=ke(),v=z(i=>i.conversionFilters[C]||{},Ae),w=t.useMemo(()=>Object.entries(v).reduce((i,[L,_])=>{if(_){const T={"Total Sessions":"sessionsFilter","Avg Conv Rate":"convRateFilter"}[L]||L;i[T]=_}return i},{}),[v]),g=t.useCallback(async()=>{d(!0);try{const L=(await $.post(`/api/analytics/sourceConversionReport/${S}`,{userId:x==null?void 0:x.id,startDate:y,endDate:b,...w})).data||[];m(L)}catch(i){console.error("Error fetching data:",i)}finally{d(!1)}},[S,y,b,w,x==null?void 0:x.id]);t.useEffect(()=>{g();const i=setInterval(g,15*60*1e3);return()=>clearInterval(i)},[g]),t.useEffect(()=>{s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),t.useEffect(()=>{c||s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[c,s]);const F=()=>{g()},M="Source",N=["Total Sessions","Avg Conv. Rate"],u="MonthlyData",I=["Sessions","Conv. Rate"];return e.jsx(le,{className:`${c?"fixed inset-0 z-50 m-0":""}`,children:e.jsxs(ce,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Source based Conversion"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[c&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{defaultDate:{from:new Date(new Date().getFullYear(),new Date().getMonth(),1),to:new Date}})}),e.jsx(D,{onClick:F,disabled:h,size:"icon",variant:"outline",children:e.jsx(fe,{className:`h-4 w-4 ${h?"animate-spin":""}`})}),e.jsx(Ve,{componentId:C}),e.jsx(es,{data:(o==null?void 0:o.data)||[],fileName:`${M}_Conversion_Report`,primaryColumn:M,secondaryColumns:N,monthlyDataKey:u,monthlyMetrics:I,disabled:h}),e.jsx(D,{onClick:A,size:"icon",variant:"outline",children:c?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"rounded-md overflow-hidden",children:h?e.jsx(Me,{}):e.jsxs("div",{children:[e.jsx(Pe,{data:(o==null?void 0:o.data)||[],primaryColumn:M,metricConfig:Le.sessionsAndConversion||{}}),e.jsx(Ie,{data:(o==null?void 0:o.data)||[],primaryColumn:M,secondaryColumns:N,monthlyDataKey:u,monthlyMetrics:I,isFullScreen:c})]})})]})})},Vi=()=>{const s=z(A=>A.date.from),r=z(A=>A.date.to),a=t.useMemo(()=>({from:s,to:r}),[s,r]),{brandId:n}=ge(),o=z(A=>A.brand.brands).find(A=>A._id===n),m=(o==null?void 0:o.ga4Account)??!1,{tokenError:h}=Qs(),[d,c]=t.useState("age"),p=t.useRef(null),C=[{label:"Age",value:"age"},{label:"Gender",value:"gender"},{label:"Interest",value:"interest"},{label:"Device",value:"device"},{label:"Operating System",value:"operatingSystem"},{label:"Browser",value:"browser"},{label:"Source",value:"source"}],x={age:t.useRef(null),gender:t.useRef(null),interest:t.useRef(null),device:t.useRef(null),operatingSystem:t.useRef(null),browser:t.useRef(null),source:t.useRef(null)};t.useEffect(()=>{if(!p.current)return;const A=new IntersectionObserver(y=>{y.forEach(b=>{if(b.isIntersecting){const $=b.target.id;c($)}})},{root:p.current,threshold:.7,rootMargin:"0px 0px 0px 0px"});return Object.keys(x).forEach(y=>{const b=x[y].current;b&&A.observe(b)}),()=>A.disconnect()},[]);const S=A=>{c(A);const y=x[A];if(y.current&&p.current){const v=y.current.getBoundingClientRect().top-140;p.current.scrollBy({top:v,behavior:"smooth"})}};return h?e.jsx(Nt,{}):!m&&!m?e.jsx(wt,{platform:"google analytics",brandId:n??"",onSuccess:(A,y,b)=>{console.log(`Successfully connected ${A} account: ${y} (${b})`)}}):e.jsxs("div",{className:"flex h-screen bg-gray-100",children:[e.jsx(ts,{}),e.jsxs("div",{className:"flex-1 h-screen overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex-none",children:[e.jsx(js,{title:"Audience & Traffic sources",Icon:zt,showDatePicker:!0}),e.jsx("div",{id:"report-tab",className:"bg-white px-6 sticky top-0 z-10",children:e.jsx(zs,{tabs:C,activeTab:d,onTabChange:S})})]}),e.jsx("div",{ref:p,className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"px-6 py-4 space-y-6",children:[e.jsx("div",{id:"age-conversion-report",ref:x.age,children:e.jsx(Di,{dateRange:{from:a.from?new Date(a.from):void 0,to:a.to?new Date(a.to):void 0}})}),e.jsx("div",{id:"gender",ref:x.gender,children:e.jsx(Oi,{dateRange:{from:a.from?new Date(a.from):void 0,to:a.to?new Date(a.to):void 0}})}),e.jsx("div",{id:"interest",ref:x.interest,children:e.jsx(zi,{dateRange:{from:a.from?new Date(a.from):void 0,to:a.to?new Date(a.to):void 0}})}),e.jsx("div",{id:"device",ref:x.device,children:e.jsx(Ri,{dateRange:{from:a.from?new Date(a.from):void 0,to:a.to?new Date(a.to):void 0}})}),e.jsx("div",{id:"operatingSystem",ref:x.operatingSystem,children:e.jsx(Gi,{dateRange:{from:a.from?new Date(a.from):void 0,to:a.to?new Date(a.to):void 0}})}),e.jsx("div",{id:"browser",ref:x.browser,children:e.jsx(_i,{dateRange:{from:a.from?new Date(a.from):void 0,to:a.to?new Date(a.to):void 0}})}),e.jsx("div",{id:"source",ref:x.source,children:e.jsx(Bi,{dateRange:{from:a.from?new Date(a.from):void 0,to:a.to?new Date(a.to):void 0}})})]})}),e.jsx(gs,{})]})]})},Ui=({dateRange:s})=>{const r=z(i=>i.date.from),a=z(i=>i.date.to),n=t.useMemo(()=>({from:r,to:a}),[r,a]),l=Se(),[o,m]=t.useState(null),[h,d]=t.useState(!0),[c,p]=t.useState(!1),C="city-conversion",x=z(i=>i.user.user,Ae),{brandId:S}=ge(),A=()=>{p(!c)},y=n!=null&&n.from?H(n.from,"yyyy-MM-dd"):"",b=n!=null&&n.to?H(n.to,"yyyy-MM-dd"):"",$=ke(),v=z(i=>i.conversionFilters[C]||{},Ae),w=t.useMemo(()=>Object.entries(v).reduce((i,[L,_])=>{if(_){const T={"Total Sessions":"sessionsFilter","Avg Conv Rate":"convRateFilter"}[L]||L;i[T]=_}return i},{}),[v]),g=t.useCallback(async()=>{d(!0);try{const L=(await $.post(`/api/analytics/cityConversionReport/${S}`,{userId:x==null?void 0:x.id,startDate:y,endDate:b,...w})).data||[];m(L)}catch(i){console.error("Error fetching data:",i)}finally{d(!1)}},[S,y,b,w,x==null?void 0:x.id]);t.useEffect(()=>{g();const i=setInterval(g,15*60*1e3);return()=>clearInterval(i)},[g]),t.useEffect(()=>{s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),t.useEffect(()=>{c||s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[c,s]);const F=()=>{g()},M="City",N=["Total Sessions","Avg Conv. Rate"],u="MonthlyData",I=["Sessions","Conv. Rate"];return e.jsx(le,{className:`${c?"fixed inset-0 z-50 m-0":""} overflow-auto`,children:e.jsxs(ce,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"City based Conversion"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[c&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{defaultDate:{from:new Date(new Date().getFullYear(),new Date().getMonth(),1),to:new Date}})}),e.jsx(D,{onClick:F,disabled:h,size:"icon",variant:"outline",children:e.jsx(fe,{className:`h-4 w-4 ${h?"animate-spin":""}`})}),e.jsx(Ve,{componentId:C}),e.jsx(es,{data:(o==null?void 0:o.data)||[],fileName:`${M}_Conversion_Report`,primaryColumn:M,secondaryColumns:N,monthlyDataKey:u,monthlyMetrics:I,disabled:h}),e.jsx(D,{onClick:A,size:"icon",variant:"outline",children:c?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"rounded-md overflow-hidden",children:h?e.jsx(Me,{}):e.jsxs("div",{children:[e.jsx(Pe,{data:(o==null?void 0:o.data)||[],primaryColumn:M,metricConfig:Le.sessionsAndConversion||{}}),e.jsx(Ie,{data:(o==null?void 0:o.data)||[],primaryColumn:M,secondaryColumns:N,monthlyDataKey:u,monthlyMetrics:I,isFullScreen:c})]})})]})})},Hi=({dateRange:s})=>{const r=z(i=>i.date.from),a=z(i=>i.date.to),n=t.useMemo(()=>({from:r,to:a}),[r,a]),l=Se(),[o,m]=t.useState(null),[h,d]=t.useState(!0),[c,p]=t.useState(!1),C="channel-conversion",x=z(i=>i.user.user,Ae),{brandId:S}=ge(),A=()=>{p(!c)},y=n!=null&&n.from?H(n.from,"yyyy-MM-dd"):"",b=n!=null&&n.to?H(n.to,"yyyy-MM-dd"):"",$=ke(),v=z(i=>i.conversionFilters[C]||{},Ae),w=t.useMemo(()=>Object.entries(v).reduce((i,[L,_])=>{if(_){const T={"Total Sessions":"sessionsFilter","Avg Conv Rate":"convRateFilter"}[L]||L;i[T]=_}return i},{}),[v]),g=t.useCallback(async()=>{d(!0);try{const L=(await $.post(`/api/analytics/channelConversionReport/${S}`,{userId:x==null?void 0:x.id,startDate:y,endDate:b,...w})).data||[];m(L)}catch(i){console.error("Error fetching data:",i)}finally{d(!1)}},[S,y,b,w,x==null?void 0:x.id]);t.useEffect(()=>{g();const i=setInterval(g,15*60*1e3);return()=>clearInterval(i)},[g]),t.useEffect(()=>{s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),t.useEffect(()=>{c||s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[c,s]);const F=()=>{g()},M="Channel",N=["Total Sessions","Avg Conv. Rate"],u="MonthlyData",I=["Sessions","Conv. Rate"];return e.jsx(le,{className:`${c?"fixed inset-0 z-50 m-0":""}`,children:e.jsxs(ce,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Channel based Conversion"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[c&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{defaultDate:{from:new Date(new Date().getFullYear(),new Date().getMonth(),1),to:new Date}})}),e.jsx(D,{onClick:F,disabled:h,size:"icon",variant:"outline",children:e.jsx(fe,{className:`h-4 w-4 ${h?"animate-spin":""}`})}),e.jsx(Ve,{componentId:C}),e.jsx(es,{data:(o==null?void 0:o.data)||[],fileName:`${M}_Conversion_Report`,primaryColumn:M,secondaryColumns:N,monthlyDataKey:u,monthlyMetrics:I,disabled:h}),e.jsx(D,{onClick:A,size:"icon",variant:"outline",children:c?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"rounded-md overflow-hidden",children:h?e.jsx(Me,{}):e.jsxs("div",{children:[e.jsx(Pe,{data:(o==null?void 0:o.data)||[],primaryColumn:M,metricConfig:Le.sessionsAndConversion||{}}),e.jsx(Ie,{data:(o==null?void 0:o.data)||[],primaryColumn:M,secondaryColumns:N,monthlyDataKey:u,monthlyMetrics:I,isFullScreen:c})]})})]})})},Yi=({dateRange:s})=>{const r=z(i=>i.date.from),a=z(i=>i.date.to),n=t.useMemo(()=>({from:r,to:a}),[r,a]),l=Se(),[o,m]=t.useState(null),[h,d]=t.useState(!0),[c,p]=t.useState(!1),C="region-conversion",x=z(i=>i.user.user,Ae),{brandId:S}=ge(),A=()=>{p(!c)},y=n!=null&&n.from?H(n.from,"yyyy-MM-dd"):"",b=n!=null&&n.to?H(n.to,"yyyy-MM-dd"):"",$=ke(),v=z(i=>i.conversionFilters[C]||{},Ae),w=t.useMemo(()=>Object.entries(v).reduce((i,[L,_])=>{if(_){const T={"Total Sessions":"sessionsFilter","Avg Conv Rate":"convRateFilter"}[L]||L;i[T]=_}return i},{}),[v]),g=t.useCallback(async()=>{d(!0);try{const L=(await $.post(`/api/analytics/regionConversionReport/${S}`,{userId:x==null?void 0:x.id,startDate:y,endDate:b,...w})).data||[];m(L)}catch(i){console.error("Error fetching data:",i)}finally{d(!1)}},[S,y,b,w,x==null?void 0:x.id]);t.useEffect(()=>{g();const i=setInterval(g,15*60*1e3);return()=>clearInterval(i)},[g]),t.useEffect(()=>{s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),t.useEffect(()=>{c||s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[c,s]);const F=()=>{g()},M="Region",N=["Total Sessions","Avg Conv. Rate"],u="MonthlyData",I=["Sessions","Conv. Rate"];return e.jsx(le,{className:`${c?"fixed inset-0 z-50 m-0":""}`,children:e.jsxs(ce,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Region based Conversion"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[c&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{defaultDate:{from:new Date(new Date().getFullYear(),new Date().getMonth(),1),to:new Date}})}),e.jsx(D,{onClick:F,disabled:h,size:"icon",variant:"outline",children:e.jsx(fe,{className:`h-4 w-4 ${h?"animate-spin":""}`})}),e.jsx(Ve,{componentId:C}),e.jsx(es,{data:(o==null?void 0:o.data)||[],fileName:`${M}_Conversion_Report`,primaryColumn:M,secondaryColumns:N,monthlyDataKey:u,monthlyMetrics:I,disabled:h}),e.jsx(D,{onClick:A,size:"icon",variant:"outline",children:c?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"rounded-md overflow-hidden",children:h?e.jsx(Me,{}):e.jsxs("div",{children:[e.jsx(Pe,{data:(o==null?void 0:o.data)||[],primaryColumn:M,metricConfig:Le.sessionsAndConversion||{}}),e.jsx(Ie,{data:(o==null?void 0:o.data)||[],primaryColumn:M,secondaryColumns:N,monthlyDataKey:u,monthlyMetrics:I,isFullScreen:c})]})})]})})},Wi=({dateRange:s})=>{const r=z(i=>i.date.from),a=z(i=>i.date.to),n=t.useMemo(()=>({from:r,to:a}),[r,a]),l=Se(),[o,m]=t.useState(null),[h,d]=t.useState(!0),[c,p]=t.useState(!1),C="landingPage-conversion",x=z(i=>i.user.user,Ae),{brandId:S}=ge(),A=()=>{p(!c)},y=n!=null&&n.from?H(n.from,"yyyy-MM-dd"):"",b=n!=null&&n.to?H(n.to,"yyyy-MM-dd"):"",$=ke(),v=z(i=>i.conversionFilters[C]||{},Ae),w=t.useMemo(()=>Object.entries(v).reduce((i,[L,_])=>{if(_){const T={"Total Sessions":"sessionsFilter","Avg Conv Rate":"convRateFilter"}[L]||L;i[T]=_}return i},{}),[v]),g=t.useCallback(async()=>{d(!0);try{const L=(await $.post(`/api/analytics/pageConversionReport/${S}`,{userId:x==null?void 0:x.id,startDate:y,endDate:b,...w})).data||[];m(L)}catch(i){console.error("Error fetching data:",i)}finally{d(!1)}},[S,y,b,w,x==null?void 0:x.id]);t.useEffect(()=>{g();const i=setInterval(g,15*60*1e3);return()=>clearInterval(i)},[g]),t.useEffect(()=>{s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),t.useEffect(()=>{c||s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[c,s]);const F=()=>{g()},M="Landing Page",N=["Total Sessions","Avg Conv. Rate"],u="MonthlyData",I=["Sessions","Conv. Rate"];return e.jsx(le,{className:`${c?"fixed inset-0 z-50 m-0":""} overflow-auto`,children:e.jsxs(ce,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Landing Page based Conversion"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[c&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{defaultDate:{from:new Date(new Date().getFullYear(),new Date().getMonth(),1),to:new Date}})}),e.jsx(D,{onClick:F,disabled:h,size:"icon",variant:"outline",children:e.jsx(fe,{className:`h-4 w-4 ${h?"animate-spin":""}`})}),e.jsx(Ve,{componentId:C}),e.jsx(es,{data:(o==null?void 0:o.data)||[],fileName:`${M}_Conversion_Report`,primaryColumn:M,secondaryColumns:N,monthlyDataKey:u,monthlyMetrics:I,disabled:h}),e.jsx(D,{onClick:A,size:"icon",variant:"outline",children:c?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"rounded-md overflow-hidden",children:h?e.jsx(Me,{}):e.jsxs("div",{children:[e.jsx(Pe,{data:(o==null?void 0:o.data)||[],primaryColumn:M,metricConfig:Le.sessionsAndConversion||{}}),e.jsx(Ie,{data:(o==null?void 0:o.data)||[],primaryColumn:M,secondaryColumns:N,monthlyDataKey:u,monthlyMetrics:I,isFullScreen:c})]})})]})})},Ki=({dateRange:s})=>{const r=z(i=>i.date.from),a=z(i=>i.date.to),n=t.useMemo(()=>({from:r,to:a}),[r,a]),l=Se(),[o,m]=t.useState(null),[h,d]=t.useState(!0),[c,p]=t.useState(!1),C="campaign-conversion",x=z(i=>i.user.user,Ae),{brandId:S}=ge(),A=()=>{p(!c)},y=n!=null&&n.from?H(n.from,"yyyy-MM-dd"):"",b=n!=null&&n.to?H(n.to,"yyyy-MM-dd"):"",$=ke(),v=z(i=>i.conversionFilters[C]||{},Ae),w=t.useMemo(()=>Object.entries(v).reduce((i,[L,_])=>{if(_){const T={"Total Sessions":"sessionsFilter","Avg Conv Rate":"convRateFilter"}[L]||L;i[T]=_}return i},{}),[v]),g=t.useCallback(async()=>{d(!0);try{const L=(await $.post(`/api/analytics/campaignConversionReport/${S}`,{userId:x==null?void 0:x.id,startDate:y,endDate:b,...w})).data||[];m(L)}catch(i){console.error("Error fetching data:",i)}finally{d(!1)}},[S,y,b,w,x==null?void 0:x.id]);t.useEffect(()=>{g();const i=setInterval(g,15*60*1e3);return()=>clearInterval(i)},[g]),t.useEffect(()=>{s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),t.useEffect(()=>{c||s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[c,s]);const F=()=>{g()},M="Campaign",N=["Total Sessions","Avg Conv. Rate"],u="MonthlyData",I=["Sessions","Conv. Rate"];return e.jsx(le,{className:`${c?"fixed inset-0 z-50 m-0":""}`,children:e.jsxs(ce,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Campaign based Conversion"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[c&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{defaultDate:{from:new Date(new Date().getFullYear(),new Date().getMonth(),1),to:new Date}})}),e.jsx(D,{onClick:F,disabled:h,size:"icon",variant:"outline",children:e.jsx(fe,{className:`h-4 w-4 ${h?"animate-spin":""}`})}),e.jsx(Ve,{componentId:C}),e.jsx(es,{data:(o==null?void 0:o.data)||[],fileName:`${M}_Conversion_Report`,primaryColumn:M,secondaryColumns:N,monthlyDataKey:u,monthlyMetrics:I,disabled:h}),e.jsx(D,{onClick:A,size:"icon",variant:"outline",children:c?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"rounded-md overflow-hidden",children:h?e.jsx(Me,{}):e.jsxs("div",{children:[e.jsx(Pe,{data:(o==null?void 0:o.data)||[],primaryColumn:M,metricConfig:Le.sessionsAndConversion||{}}),e.jsx(Ie,{data:(o==null?void 0:o.data)||[],primaryColumn:M,secondaryColumns:N,monthlyDataKey:u,monthlyMetrics:I,isFullScreen:c})]})})]})})},Qi=({dateRange:s})=>{const r=z(i=>i.date.from),a=z(i=>i.date.to),n=t.useMemo(()=>({from:r,to:a}),[r,a]),l=Se(),[o,m]=t.useState(null),[h,d]=t.useState(!0),[c,p]=t.useState(!1),C="pagePath-conversion",x=z(i=>i.user.user,Ae),{brandId:S}=ge(),A=()=>{p(!c)},y=n!=null&&n.from?H(n.from,"yyyy-MM-dd"):"",b=n!=null&&n.to?H(n.to,"yyyy-MM-dd"):"",$=ke(),v=z(i=>i.conversionFilters[C]||{},Ae),w=t.useMemo(()=>Object.entries(v).reduce((i,[L,_])=>{if(_){const T={"Total Sessions":"sessionsFilter","Avg Conv Rate":"convRateFilter"}[L]||L;i[T]=_}return i},{}),[v]),g=t.useCallback(async()=>{d(!0);try{const L=(await $.post(`/api/analytics/pagePathConversionReport/${S}`,{userId:x==null?void 0:x.id,startDate:y,endDate:b,...w})).data||[];m(L)}catch(i){console.error("Error fetching data:",i)}finally{d(!1)}},[S,y,b,w,x==null?void 0:x.id]);t.useEffect(()=>{g();const i=setInterval(g,5*60*1e3);return()=>clearInterval(i)},[g]),t.useEffect(()=>{s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),t.useEffect(()=>{c||s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[c,s]);const F=()=>{g()},M="Page Path",N=["Total Sessions","Avg Conv. Rate"],u="MonthlyData",I=["Sessions","Conv. Rate"];return e.jsx(le,{className:`${c?"fixed inset-0 z-50 m-0":""} overflow-auto`,children:e.jsxs(ce,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Page path based Conversion"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[c&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{defaultDate:{from:new Date(new Date().getFullYear(),new Date().getMonth(),1),to:new Date}})}),e.jsx(D,{onClick:F,disabled:h,size:"icon",variant:"outline",children:e.jsx(fe,{className:`h-4 w-4 ${h?"animate-spin":""}`})}),e.jsx(Ve,{componentId:C}),e.jsx(es,{data:(o==null?void 0:o.data)||[],fileName:`${M}_Conversion_Report`,primaryColumn:M,secondaryColumns:N,monthlyDataKey:u,monthlyMetrics:I,disabled:h}),e.jsx(D,{onClick:A,size:"icon",variant:"outline",children:c?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"rounded-md overflow-hidden",children:h?e.jsx(Me,{}):e.jsxs("div",{children:[e.jsx(Pe,{data:(o==null?void 0:o.data)||[],primaryColumn:M,metricConfig:Le.sessionsAndConversion||{}}),e.jsx(Ie,{data:(o==null?void 0:o.data)||[],primaryColumn:M,secondaryColumns:N,monthlyDataKey:u,monthlyMetrics:I,isFullScreen:c})]})})]})})},Zi=({dateRange:s})=>{const r=z(i=>i.date.from),a=z(i=>i.date.to),n=t.useMemo(()=>({from:r,to:a}),[r,a]),l=Se(),[o,m]=t.useState(null),[h,d]=t.useState(!0),[c,p]=t.useState(!1),C="pageTitle-conversion",x=z(i=>i.user.user,Ae),{brandId:S}=ge(),A=()=>{p(!c)},y=n!=null&&n.from?H(n.from,"yyyy-MM-dd"):"",b=n!=null&&n.to?H(n.to,"yyyy-MM-dd"):"",$=ke(),v=z(i=>i.conversionFilters[C]||{},Ae),w=t.useMemo(()=>Object.entries(v).reduce((i,[L,_])=>{if(_){const T={"Total Sessions":"sessionsFilter","Avg Conv Rate":"convRateFilter"}[L]||L;i[T]=_}return i},{}),[v]),g=t.useCallback(async()=>{d(!0);try{const L=(await $.post(`/api/analytics/pageTitleConversionReport/${S}`,{userId:x==null?void 0:x.id,startDate:y,endDate:b,...w},{withCredentials:!0})).data||[];m(L)}catch(i){console.error("Error fetching data:",i)}finally{d(!1)}},[S,y,b,w,x==null?void 0:x.id]);t.useEffect(()=>{g();const i=setInterval(g,15*60*1e3);return()=>clearInterval(i)},[g]),t.useEffect(()=>{s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),t.useEffect(()=>{c||s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[c,s]);const F=()=>{g()},M="Page Title",N=["Total Sessions","Avg Conv. Rate"],u="MonthlyData",I=["Sessions","Conv. Rate"];return e.jsx(le,{className:`${c?"fixed inset-0 z-50 m-0":""} overflow-auto`,children:e.jsxs(ce,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Page Title based Conversion"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[c&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{defaultDate:{from:new Date(new Date().getFullYear(),new Date().getMonth(),1),to:new Date}})}),e.jsx(D,{onClick:F,disabled:h,size:"icon",variant:"outline",children:e.jsx(fe,{className:`h-4 w-4 ${h?"animate-spin":""}`})}),e.jsx(Ve,{componentId:C}),e.jsx(es,{data:(o==null?void 0:o.data)||[],fileName:`${M}_Conversion_Report`,primaryColumn:M,secondaryColumns:N,monthlyDataKey:u,monthlyMetrics:I,disabled:h}),e.jsx(D,{onClick:A,size:"icon",variant:"outline",children:c?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"rounded-md overflow-hidden",children:h?e.jsx(Me,{}):e.jsxs("div",{children:[e.jsx(Pe,{data:(o==null?void 0:o.data)||[],primaryColumn:M,metricConfig:Le.sessionsAndConversion||{}}),e.jsx(Ie,{data:(o==null?void 0:o.data)||[],primaryColumn:M,secondaryColumns:N,monthlyDataKey:u,monthlyMetrics:I,isFullScreen:c})]})})]})})},qi=({dateRange:s})=>{const r=z(i=>i.date.from),a=z(i=>i.date.to),n=t.useMemo(()=>({from:r,to:a}),[r,a]),l=Se(),[o,m]=t.useState(null),[h,d]=t.useState(!0),[c,p]=t.useState(!1),C="country-conversion",x=z(i=>i.user.user,Ae),{brandId:S}=ge(),A=()=>{p(!c)},y=n!=null&&n.from?H(n.from,"yyyy-MM-dd"):"",b=n!=null&&n.to?H(n.to,"yyyy-MM-dd"):"",$=ke(),v=z(i=>i.conversionFilters[C]||{},Ae),w=t.useMemo(()=>Object.entries(v).reduce((i,[L,_])=>{if(_){const T={"Total Sessions":"sessionsFilter","Avg Conv Rate":"convRateFilter"}[L]||L;i[T]=_}return i},{}),[v]),g=t.useCallback(async()=>{d(!0);try{const L=(await $.post(`/api/analytics/countryConversionReport/${S}`,{userId:x==null?void 0:x.id,startDate:y,endDate:b,...w})).data||[];m(L)}catch(i){console.error("Error fetching data:",i)}finally{d(!1)}},[S,y,b,w,x==null?void 0:x.id]);t.useEffect(()=>{g();const i=setInterval(g,15*60*1e3);return()=>clearInterval(i)},[g]),t.useEffect(()=>{s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),t.useEffect(()=>{c||s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[c,s]);const F=()=>{g()},M="Country",N=["Total Sessions","Avg Conv. Rate"],u="MonthlyData",I=["Sessions","Conv. Rate"];return e.jsx(le,{className:`${c?"fixed inset-0 z-50 m-0":""}`,children:e.jsxs(ce,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h2",{className:"text-lg font-medium",children:"Country based Conversion"}),e.jsx(Re,{})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[c&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{defaultDate:{from:new Date(new Date().getFullYear(),new Date().getMonth(),1),to:new Date}})}),e.jsx(D,{onClick:F,disabled:h,size:"icon",variant:"outline",children:e.jsx(fe,{className:`h-4 w-4 ${h?"animate-spin":""}`})}),e.jsx(Ve,{componentId:C}),e.jsx(es,{data:(o==null?void 0:o.data)||[],fileName:`${M}_Conversion_Report`,primaryColumn:M,secondaryColumns:N,monthlyDataKey:u,monthlyMetrics:I,disabled:h}),e.jsx(D,{onClick:A,size:"icon",variant:"outline",children:c?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"rounded-md overflow-hidden",children:h?e.jsx(Me,{}):e.jsxs("div",{children:[e.jsx(Pe,{data:(o==null?void 0:o.data)||[],primaryColumn:M,metricConfig:Le.sessionsAndConversion||{}}),e.jsx(Ie,{data:(o==null?void 0:o.data)||[],primaryColumn:M,secondaryColumns:N,monthlyDataKey:u,monthlyMetrics:I,isFullScreen:c})]})})]})})},Ji=()=>{const s=z(A=>A.date.from),r=z(A=>A.date.to),a=t.useMemo(()=>({from:s,to:r}),[s,r]),{brandId:n}=ge(),o=z(A=>A.brand.brands).find(A=>A._id===n),m=(o==null?void 0:o.ga4Account)??!1,{tokenError:h}=Qs(),[d,c]=t.useState("channel"),p=t.useRef(null),C=[{label:"Channel",value:"channel"},{label:"Campaign",value:"campaign"},{label:"Country",value:"country"},{label:"City",value:"city"},{label:"Region",value:"region"},{label:"Landing Page",value:"landingPage"},{label:"Page Path",value:"pagePath"},{label:"Page Title",value:"pageTitle"}],x={country:t.useRef(null),city:t.useRef(null),region:t.useRef(null),channel:t.useRef(null),campaign:t.useRef(null),landingPage:t.useRef(null),pagePath:t.useRef(null),pageTitle:t.useRef(null)};t.useEffect(()=>{if(!p.current)return;const A=new IntersectionObserver(y=>{y.forEach(b=>{if(b.isIntersecting){const $=b.target.id;c($)}})},{root:p.current,threshold:.7,rootMargin:"0px 0px 0px 0px"});return Object.keys(x).forEach(y=>{const b=x[y].current;b&&A.observe(b)}),()=>A.disconnect()},[]);const S=A=>{c(A);const y=x[A];if(y.current&&p.current){const v=y.current.getBoundingClientRect().top-140;p.current.scrollBy({top:v,behavior:"smooth"})}};return h?e.jsx(Nt,{}):!m&&!m?e.jsx(wt,{platform:"google analytics",brandId:n??"",onSuccess:(A,y,b)=>{console.log(`Successfully connected ${A} account: ${y} (${b})`)}}):e.jsxs("div",{className:"flex h-screen bg-gray-100",children:[e.jsx(ts,{}),e.jsxs("div",{className:"flex-1 h-screen overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex-none",children:[e.jsx(js,{title:"Campaign and Website Performance",Icon:zt,showDatePicker:!0}),e.jsx("div",{className:"bg-white px-6 sticky top-0 z-10",children:e.jsx(zs,{tabs:C,activeTab:d,onTabChange:S})})]}),e.jsx("div",{ref:p,className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"px-6 py-4 space-y-6",children:[e.jsx("div",{id:"channel",ref:x.channel,children:e.jsx(Hi,{dateRange:{from:a.from?new Date(a.from):void 0,to:a.to?new Date(a.to):void 0}})}),e.jsx("div",{id:"campaign",ref:x.campaign,children:e.jsx(Ki,{dateRange:{from:a.from?new Date(a.from):void 0,to:a.to?new Date(a.to):void 0}})}),e.jsx("div",{id:"country",ref:x.country,children:e.jsx(qi,{dateRange:{from:a.from?new Date(a.from):void 0,to:a.to?new Date(a.to):void 0}})}),e.jsx("div",{id:"city",ref:x.city,children:e.jsx(Ui,{dateRange:{from:a.from?new Date(a.from):void 0,to:a.to?new Date(a.to):void 0}})}),e.jsx("div",{id:"region",ref:x.region,children:e.jsx(Yi,{dateRange:{from:a.from?new Date(a.from):void 0,to:a.to?new Date(a.to):void 0}})}),e.jsx("div",{id:"landingPage",ref:x.landingPage,children:e.jsx(Wi,{dateRange:{from:a.from?new Date(a.from):void 0,to:a.to?new Date(a.to):void 0}})}),e.jsx("div",{id:"pagePath",ref:x.pagePath,children:e.jsx(Qi,{dateRange:{from:a.from?new Date(a.from):void 0,to:a.to?new Date(a.to):void 0}})}),e.jsx("div",{id:"pageTitle",ref:x.pageTitle,children:e.jsx(Zi,{dateRange:{from:a.from?new Date(a.from):void 0,to:a.to?new Date(a.to):void 0}})})]})}),e.jsx(gs,{})]})]})},Xi=({dateRange:s})=>{const r=z(i=>i.date.from),a=z(i=>i.date.to),n=t.useMemo(()=>({from:r,to:a}),[r,a]),l=Se(),[o,m]=t.useState(null),[h,d]=t.useState(!0),[c,p]=t.useState(!1),C=z(i=>i.user.user,Ae),{brandId:x}=ge(),S=()=>{p(!c)},A=n!=null&&n.from?H(n.from,"yyyy-MM-dd"):"",y=n!=null&&n.to?H(n.to,"yyyy-MM-dd"):"",b=ke(),$="google-ads-search-term",v=z(i=>i.conversionFilters[$]||{},Ae),w=t.useMemo(()=>Object.entries(v).reduce((i,[L,_])=>{if(_){const T={"Total Cost":"costFilter","Conv. Value / Cost":"convValuePerCostFilter"}[L]||L;i[T]=_}return i},{}),[v]),g=t.useCallback(async()=>{var i;d(!0);try{const L=await b.post(`/api/segment/searchTerm/${x}`,{userId:C==null?void 0:C.id,startDate:A,endDate:y,...w});m({reportType:"Search Term",data:((i=L.data)==null?void 0:i.data)||[]})}catch(L){console.error("Error fetching data:",L)}finally{d(!1)}},[x,A,y,C==null?void 0:C.id,w]);t.useEffect(()=>{g();const i=setInterval(g,15*60*1e3);return()=>clearInterval(i)},[g]),t.useEffect(()=>{s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s,l]),t.useEffect(()=>{!c&&s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[c,s,l]);const F=()=>{g()},M="Search Term",N=["Total Cost","Conv. Value / Cost"],u="MonthlyData",I=["Cost","Conv. Value/ Cost"];return e.jsxs(e.Fragment,{children:[h?e.jsx(Me,{}):(o==null?void 0:o.data)&&o.data.map((i,L)=>e.jsx("div",{className:`${c?"fixed inset-0 z-50 m-0 overflow-auto bg-white":""}`,children:e.jsx(le,{className:"mb-4",children:e.jsxs(ce,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 mt-2 flex items-center",children:[e.jsx("span",{className:"mr-2",children:e.jsx(Xe,{})}),e.jsx("span",{className:"",children:i.accountName})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[c&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{})}),e.jsx(D,{onClick:F,disabled:h,size:"icon",variant:"outline",children:e.jsx(fe,{className:`h-4 w-4 ${h?"animate-spin":""}`})}),e.jsx(Ve,{componentId:$,availableColumns:["Total Cost","Conv. Value / Cost"]}),e.jsx(D,{onClick:S,size:"icon",variant:"outline",children:c?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]}),i.error?e.jsxs("p",{className:"text-red-500",children:["Error: ",i.error]}):i.searchTerms.length===0?e.jsx("p",{className:"text-gray-500",children:"No search term data available for this account"}):e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsx(Ie,{data:i.searchTerms,primaryColumn:M,secondaryColumns:N,monthlyDataKey:u,monthlyMetrics:I,isFullScreen:c})})]})},i.accountId)})),(o==null?void 0:o.data)&&o.data.length===0&&!h&&e.jsx(le,{children:e.jsx(ce,{children:e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No search term data available"})})})]})},ec=({dateRange:s})=>{const r=z(i=>i.date.from),a=z(i=>i.date.to),n=t.useMemo(()=>({from:r,to:a}),[r,a]),[l,o]=t.useState(null),[m,h]=t.useState(!0),[d,c]=t.useState(!1),p=Se(),C=z(i=>i.user.user,Ae),{brandId:x}=ge(),S=()=>{c(!d)},A=n!=null&&n.from?H(n.from,"yyyy-MM-dd"):"",y=n!=null&&n.to?H(n.to,"yyyy-MM-dd"):"",b=ke(),$="google-ads-age",v=z(i=>i.conversionFilters[$]||{},Ae),w=t.useMemo(()=>Object.entries(v).reduce((i,[L,_])=>{if(_){const T={"Total Cost":"costFilter","Conv. Value / Cost":"convValuePerCostFilter"}[L]||L;i[T]=_}return i},{}),[v]),g=t.useCallback(async()=>{h(!0);try{const L=(await b.post(`/api/segment/age/${x}`,{userId:C==null?void 0:C.id,startDate:A,endDate:y,...w},{withCredentials:!0})).data||[];o(L)}catch(i){console.error("Error fetching data:",i)}finally{h(!1)}},[x,A,y,w,C==null?void 0:C.id]);t.useEffect(()=>{g();const i=setInterval(g,15*60*1e3);return()=>clearInterval(i)},[g]),t.useEffect(()=>{s&&p(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),t.useEffect(()=>{d||s&&p(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[d,s]);const F=()=>{g()},M="Age Range",N="MonthlyData",u=["Total Cost","Conv. Value / Cost"],I=["Cost","Conv. Value/ Cost"];return e.jsxs(e.Fragment,{children:[m?e.jsx(Me,{}):(l==null?void 0:l.data)&&l.data.map((i,L)=>e.jsx("div",{className:`${d?"fixed inset-0 z-50 m-0 overflow-auto bg-white":""}`,children:e.jsx(le,{className:"mb-4",children:e.jsxs(ce,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 mt-2 flex items-center",children:[e.jsx("span",{className:"mr-2",children:e.jsx(Xe,{})}),e.jsx("span",{className:"",children:i.accountName})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[d&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{})}),e.jsx(D,{onClick:F,disabled:m,size:"icon",variant:"outline",children:e.jsx(fe,{className:`h-4 w-4 ${m?"animate-spin":""}`})}),e.jsx(Ve,{componentId:$,availableColumns:["Total Cost","Conv. Value / Cost"]}),e.jsx(D,{onClick:S,size:"icon",variant:"outline",children:d?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]}),i.error?e.jsxs("p",{className:"text-red-500",children:["Error: ",i.error]}):i.ageRanges.length===0?e.jsx("p",{className:"text-gray-500",children:"No Age data available for this account"}):e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsx(Ie,{data:i.ageRanges,primaryColumn:M,secondaryColumns:u,monthlyDataKey:N,monthlyMetrics:I,isFullScreen:d})})]})},i.accountId)})),(l==null?void 0:l.data)&&l.data.length===0&&!m&&e.jsx(le,{children:e.jsx(ce,{children:e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No Age data available"})})})]})},sc=({dateRange:s})=>{const r=z(i=>i.date.from),a=z(i=>i.date.to),n=t.useMemo(()=>({from:r,to:a}),[r,a]),[l,o]=t.useState(null),[m,h]=t.useState(!0),[d,c]=t.useState(!1),p=Se(),C=z(i=>i.user.user),{brandId:x}=ge(),S=()=>{c(!d)},A=n!=null&&n.from?H(n.from,"yyyy-MM-dd"):"",y=n!=null&&n.to?H(n.to,"yyyy-MM-dd"):"",b=ke(),$="google-ads-gender",v=z(i=>i.conversionFilters[$]||{},Ae),w=t.useMemo(()=>Object.entries(v).reduce((i,[L,_])=>{if(_){const T={"Total Cost":"costFilter","Conv. Value / Cost":"convValuePerCostFilter"}[L]||L;i[T]=_}return i},{}),[v]),g=t.useCallback(async()=>{h(!0);try{const L=(await b.post(`/api/segment/gender/${x}`,{userId:C==null?void 0:C.id,startDate:A,endDate:y,...w},{withCredentials:!0})).data||[];o(L)}catch(i){console.error("Error fetching data:",i)}finally{h(!1)}},[x,A,y,w,C==null?void 0:C.id]);t.useEffect(()=>{g();const i=setInterval(g,15*60*1e3);return()=>clearInterval(i)},[g]),t.useEffect(()=>{s&&p(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),t.useEffect(()=>{d||s&&p(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[d,s]);const F=()=>{g()},M="Gender",N="MonthlyData",u=["Total Cost","Conv. Value / Cost"],I=["Cost","Conv. Value/ Cost"];return e.jsxs(e.Fragment,{children:[m?e.jsx(Me,{}):(l==null?void 0:l.data)&&l.data.map((i,L)=>e.jsx("div",{className:`${d?"fixed inset-0 z-50 m-0 overflow-auto bg-white":""}`,children:e.jsx(le,{className:"mb-4",children:e.jsxs(ce,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 mt-2 flex items-center",children:[e.jsx("span",{className:"mr-2",children:e.jsx(Xe,{})}),e.jsx("span",{className:"",children:i.accountName})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[d&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{})}),e.jsx(D,{onClick:F,disabled:m,size:"icon",variant:"outline",children:e.jsx(fe,{className:`h-4 w-4 ${m?"animate-spin":""}`})}),e.jsx(Ve,{componentId:$,availableColumns:["Total Cost","Conv. Value / Cost"]}),e.jsx(D,{onClick:S,size:"icon",variant:"outline",children:d?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]}),i.error?e.jsxs("p",{className:"text-red-500",children:["Error: ",i.error]}):i.genders.length===0?e.jsx("p",{className:"text-gray-500",children:"No gender data available for this account"}):e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsx(Ie,{data:i.genders,primaryColumn:M,secondaryColumns:u,monthlyDataKey:N,monthlyMetrics:I,isFullScreen:d})})]})},i.accountId)})),(l==null?void 0:l.data)&&l.data.length===0&&!m&&e.jsx(le,{children:e.jsx(ce,{children:e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No gender data available"})})})]})},tc=({dateRange:s})=>{const r=z(i=>i.date.from),a=z(i=>i.date.to),n=t.useMemo(()=>({from:r,to:a}),[r,a]),[l,o]=t.useState(null),[m,h]=t.useState(!0),[d,c]=t.useState(!1),p=Se(),C=z(i=>i.user.user),{brandId:x}=ge(),S=()=>{c(!d)},A=n!=null&&n.from?H(n.from,"yyyy-MM-dd"):"",y=n!=null&&n.to?H(n.to,"yyyy-MM-dd"):"",b=ke(),$="google-ads-keyword",v=z(i=>i.conversionFilters[$]||{},Ae),w=t.useMemo(()=>Object.entries(v).reduce((i,[L,_])=>{if(_){const T={"Total Cost":"costFilter","Conv. Value / Cost":"convValuePerCostFilter"}[L]||L;i[T]=_}return i},{}),[v]),g=t.useCallback(async()=>{h(!0);try{const L=(await b.post(`/api/segment/keyword/${x}`,{userId:C==null?void 0:C.id,startDate:A,endDate:y,...w},{withCredentials:!0})).data||[];o(L)}catch(i){console.error("Error fetching data:",i)}finally{h(!1)}},[x,A,y,w,C==null?void 0:C.id]);t.useEffect(()=>{g();const i=setInterval(g,15*60*1e3);return()=>clearInterval(i)},[g]),t.useEffect(()=>{s&&p(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),t.useEffect(()=>{d||s&&p(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[d,s]);const F=()=>{g()},M="Keyword",N="MonthlyData",u=["Total Cost","Conv. Value / Cost"],I=["Cost","Conv. Value/ Cost"];return e.jsxs(e.Fragment,{children:[m?e.jsx(Me,{}):(l==null?void 0:l.data)&&l.data.map((i,L)=>e.jsx("div",{className:`${d?"fixed inset-0 z-50 m-0 overflow-auto bg-white":""}`,children:e.jsx(le,{className:"mb-4",children:e.jsxs(ce,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 mt-2 flex items-center",children:[e.jsx("span",{className:"mr-2",children:e.jsx(Xe,{})}),e.jsx("span",{className:"",children:i.accountName})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[d&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{})}),e.jsx(D,{onClick:F,disabled:m,size:"icon",variant:"outline",children:e.jsx(fe,{className:`h-4 w-4 ${m?"animate-spin":""}`})}),e.jsx(Ve,{componentId:$,availableColumns:["Total Cost","Conv. Value / Cost"]}),e.jsx(D,{onClick:S,size:"icon",variant:"outline",children:d?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]}),i.error?e.jsxs("p",{className:"text-red-500",children:["Error: ",i.error]}):i.keywords.length===0?e.jsx("p",{className:"text-gray-500",children:"No keyword data available for this account"}):e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsx(Ie,{data:i.keywords,primaryColumn:M,secondaryColumns:u,monthlyDataKey:N,monthlyMetrics:I,isFullScreen:d})})]})},i.accountId)})),(l==null?void 0:l.data)&&l.data.length===0&&!m&&e.jsx(le,{children:e.jsx(ce,{children:e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No keyword data available"})})})]})},ac=({dateRange:s})=>{const[r,a]=t.useState(s),[n,l]=t.useState(null),[o,m]=t.useState(!0),[h,d]=t.useState(!1),c=z(M=>M.user.user),{brandId:p}=ge(),C=()=>{d(!h)},x=r!=null&&r.from?H(r.from,"yyyy-MM-dd"):"",S=r!=null&&r.to?H(r.to,"yyyy-MM-dd"):"",A=ke(),y=t.useCallback(async()=>{m(!0);try{const N=(await A.post(`/api/segment/product/${p}`,{userId:c==null?void 0:c.id,startDate:x,endDate:S},{withCredentials:!0})).data||[];l(N)}catch(M){console.error("Error fetching data:",M)}finally{m(!1)}},[p,x,S]);t.useEffect(()=>{y();const M=setInterval(y,15*60*1e3);return()=>clearInterval(M)},[y]),t.useEffect(()=>{a(s)},[s]);const b=()=>{y()},$="Product",v="MonthlyData",w=["Total Cost","Conv. Value / Cost"],g=["Cost","Conv. Value/ Cost"],F="google-ads-product";return e.jsxs(e.Fragment,{children:[o?e.jsx(Me,{}):(n==null?void 0:n.data)&&n.data.map((M,N)=>e.jsx("div",{className:`${h?"fixed inset-0 z-50 m-0 overflow-auto bg-white":""}`,children:e.jsx(le,{className:"mb-4",children:e.jsxs(ce,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 mt-2 flex items-center",children:[e.jsx("span",{className:"mr-2",children:e.jsx(Xe,{})}),e.jsx("span",{className:"",children:M.accountName})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[h&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{})}),e.jsx(D,{onClick:b,disabled:o,size:"icon",variant:"outline",children:e.jsx(fe,{className:`h-4 w-4 ${o?"animate-spin":""}`})}),e.jsx(Ve,{componentId:F,availableColumns:["Total Cost","Conv. Value / Cost"]}),e.jsx(D,{onClick:C,size:"icon",variant:"outline",children:h?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]}),M.error?e.jsxs("p",{className:"text-red-500",children:["Error: ",M.error]}):M.products.length===0?e.jsx("p",{className:"text-gray-500",children:"No product data available for this account"}):e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsx(Ie,{data:M.products,primaryColumn:$,secondaryColumns:w,monthlyDataKey:v,monthlyMetrics:g,isFullScreen:h})})]})},M.accountId)})),(n==null?void 0:n.data)&&n.data.length===0&&!o&&e.jsx(le,{children:e.jsx(ce,{children:e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No product data available"})})})]})},rc=()=>{const s=z(S=>S.date.from),r=z(S=>S.date.to),a=t.useMemo(()=>({from:s,to:r}),[s,r]),[n,l]=t.useState("searchterm"),o=t.useRef(null),m=z(S=>S.brand.brands),{brandId:h}=ge(),d=m.find(S=>S._id===h),c=!!(d!=null&&d.googleAdAccount&&(d==null?void 0:d.googleAdAccount.length)>0),{tokenError:p}=Qs(),C=[{label:"Search Term",value:"searchterm"},{label:"Age",value:"age"},{label:"Gender",value:"gender"},{label:"Keyword",value:"keyword"},{label:"Product",value:"product"}],x=S=>{l(S)};return e.jsxs("div",{className:"flex h-screen bg-gray-100",children:[e.jsx(ts,{}),e.jsx("div",{className:"flex-1 h-screen overflow-hidden flex flex-col",children:p?e.jsx(Nt,{}):c?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex-none",children:[e.jsx(js,{showDatePicker:!0,Icon:fo,title:"Google Ads Reports"}),e.jsx("div",{className:"bg-white px-6 sticky top-0 z-10",children:e.jsx(zs,{tabs:C,activeTab:n,onTabChange:x})})]}),e.jsx("div",{ref:o,className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"px-6 py-4 space-y-6",children:[n==="searchterm"&&e.jsx("div",{id:"searchterm",children:e.jsx(Xi,{dateRange:{from:a.from?new Date(a.from):void 0,to:a.to?new Date(a.to):void 0}})}),n==="age"&&e.jsx("div",{id:"age",children:e.jsx(ec,{dateRange:{from:a.from?new Date(a.from):void 0,to:a.to?new Date(a.to):void 0}})}),n==="gender"&&e.jsx("div",{id:"gender",children:e.jsx(sc,{dateRange:{from:a.from?new Date(a.from):void 0,to:a.to?new Date(a.to):void 0}})}),n==="keyword"&&e.jsx("div",{id:"keyword",children:e.jsx(tc,{dateRange:{from:a.from?new Date(a.from):void 0,to:a.to?new Date(a.to):void 0}})}),n==="product"&&e.jsx("div",{id:"product",children:e.jsx(ac,{dateRange:{from:a.from?new Date(a.from):void 0,to:a.to?new Date(a.to):void 0}})})]})})]}):e.jsx(e.Fragment,{children:e.jsx(wt,{platform:"google ads",brandId:h??"",onSuccess:(S,A,y)=>{console.log(`Successfully connected ${S} account: ${A} (${y})`)}})})}),e.jsx(gs,{})]})},nc=({dateRange:s})=>{const r=z(u=>u.date.from),a=z(u=>u.date.to),n=t.useMemo(()=>({from:r,to:a}),[r,a]),[l,o]=t.useState(null),[m,h]=t.useState(!0),[d,c]=t.useState(""),p=Se(),C=z(u=>u.user.user),{brandId:x}=ge(),S=u=>{c(d===u?"":u)},A=n!=null&&n.from?H(n.from,"yyyy-MM-dd"):"",y=n!=null&&n.to?H(n.to,"yyyy-MM-dd"):"",b=ke(),$=t.useCallback(async()=>{h(!0);try{const I=(await b.post(`/api/fbReport/audience/${x}`,{userId:C==null?void 0:C.id,startDate:A,endDate:y},{withCredentials:!0})).data||[];o(I)}catch(u){console.error("Error fetching data:",u)}finally{h(!1)}},[x,A,y]);t.useEffect(()=>{$();const u=setInterval($,15*60*1e3);return()=>clearInterval(u)},[$]),t.useEffect(()=>{s&&p(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),t.useEffect(()=>{d||s&&p(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[d,s]);const v=()=>{$()},w=l==null?void 0:l.blendedAudienceData,g="Audience Segments",F="MonthlyData",M=["Total Spend","Total Purchase ROAS"],N=["Spend","Purchase ROAS"];return e.jsxs("div",{children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Qe,{}),e.jsx("div",{children:e.jsx("h2",{className:"text-xl font-semibold tracking-tight",children:"Audience Segments Insights"})})]})}),m?e.jsx("div",{className:"grid grid-cols-1 gap-6",children:e.jsx(Me,{})}):e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[w&&w.length>0&&e.jsxs(le,{className:`${d==="blended-summary"?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 bg-blue-500 rounded-full"}),e.jsx("div",{className:"text-lg font-medium",children:"Blended Summary"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[d&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{})}),e.jsx(D,{onClick:v,disabled:m,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx(fe,{className:`h-4 w-4 ${m?"animate-spin":""}`})}),e.jsx(D,{onClick:()=>S("blended-summary"),size:"sm",variant:"outline",className:"hover:bg-muted",children:d==="blended-summary"?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]})}),e.jsx(ce,{className:"p-0",children:e.jsxs("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:[e.jsx(Pe,{data:w||[],primaryColumn:g,metricConfig:Le.spendAndRoas||{}}),e.jsx(Ie,{data:Array.isArray(w)?w:[w],primaryColumn:g,secondaryColumns:M,monthlyDataKey:F,monthlyMetrics:N,isFullScreen:d==="blended-summary"})]})})]}),l==null?void 0:l.data.map((u,I)=>e.jsxs(le,{className:`${d===u.account_name?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 bg-blue-500 rounded-full"}),e.jsx("div",{className:"text-lg font-medium",children:u.account_name})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[d&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{})}),e.jsx(D,{onClick:v,disabled:m,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx(fe,{className:`h-4 w-4 ${m?"animate-spin":""}`})}),e.jsx(D,{onClick:()=>S(u.account_name),size:"sm",variant:"outline",className:"hover:bg-muted",children:d===u.account_name?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]})}),e.jsx(ce,{className:"p-0",children:e.jsxs("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:[e.jsx(Pe,{data:u.audienceData||[],primaryColumn:g,metricConfig:Le.spendAndRoas||{}}),e.jsx(Ie,{data:u.audienceData,primaryColumn:g,secondaryColumns:M,monthlyDataKey:F,monthlyMetrics:N,isFullScreen:d===u.account_name})]})})]},I))]})]})},oc=({dateRange:s})=>{const r=z(u=>u.date.from),a=z(u=>u.date.to),n=t.useMemo(()=>({from:r,to:a}),[r,a]),l=Se(),[o,m]=t.useState(null),[h,d]=t.useState(!0),[c,p]=t.useState(""),C=z(u=>u.user.user),{brandId:x}=ge(),S=u=>{p(c===u?"":u)},A=n!=null&&n.from?H(n.from,"yyyy-MM-dd"):"",y=n!=null&&n.to?H(n.to,"yyyy-MM-dd"):"",b=ke(),$=t.useCallback(async()=>{d(!0);try{const I=(await b.post(`/api/fbReport/placement/${x}`,{userId:C==null?void 0:C.id,startDate:A,endDate:y},{withCredentials:!0})).data||[];m(I)}catch(u){console.error("Error fetching data:",u)}finally{d(!1)}},[x,A,y]);t.useEffect(()=>{$();const u=setInterval($,15*60*1e3);return()=>clearInterval(u)},[$]),t.useEffect(()=>{s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),t.useEffect(()=>{c||s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[c,s]);const v=()=>{$()},w=o==null?void 0:o.blendedPlacementData,g="Placements",F="MonthlyData",M=["Total Spend","Total Purchase ROAS"],N=["Spend","Purchase ROAS"];return e.jsxs("div",{children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Qe,{}),e.jsx("div",{children:e.jsx("h2",{className:"text-xl font-semibold tracking-tight",children:"Placements Insights"})})]})}),h?e.jsx("div",{className:"grid grid-cols-1 gap-6",children:e.jsx(Me,{})}):e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[w&&w.length>0&&e.jsxs(le,{className:`${c==="blended-summary"?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 bg-blue-500 rounded-full"}),e.jsx("div",{className:"text-lg font-medium",children:"Blended Summary"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[c&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{})}),e.jsx(D,{onClick:v,disabled:h,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx(fe,{className:`h-4 w-4 ${h?"animate-spin":""}`})}),e.jsx(D,{onClick:()=>S("blended-summary"),size:"sm",variant:"outline",className:"hover:bg-muted",children:c==="blended-summary"?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]})}),e.jsx(ce,{className:"p-0",children:e.jsxs("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:[e.jsx(Pe,{data:w||[],primaryColumn:g,metricConfig:Le.spendAndRoas||{}}),e.jsx(Ie,{data:Array.isArray(w)?w:[w],primaryColumn:g,secondaryColumns:M,monthlyDataKey:F,monthlyMetrics:N,isFullScreen:c==="blended-summary"})]})})]}),o==null?void 0:o.data.map((u,I)=>e.jsxs(le,{className:`${c===u.account_name?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 bg-blue-500 rounded-full"}),e.jsx("div",{className:"text-lg font-medium",children:u.account_name})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[c&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{})}),e.jsx(D,{onClick:v,disabled:h,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx(fe,{className:`h-4 w-4 ${h?"animate-spin":""}`})}),e.jsx(D,{onClick:()=>S(u.account_name),size:"sm",variant:"outline",className:"hover:bg-muted",children:c===u.account_name?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]})}),e.jsx(ce,{className:"p-0",children:e.jsxs("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:[e.jsx(Pe,{data:u.placementData||[],primaryColumn:g,metricConfig:Le.spendAndRoas||{}}),e.jsx(Ie,{data:u.placementData,primaryColumn:g,secondaryColumns:M,monthlyDataKey:F,monthlyMetrics:N,isFullScreen:c===u.account_name})]})})]},I))]})]})},lc=({dateRange:s})=>{const r=z(u=>u.date.from),a=z(u=>u.date.to),n=t.useMemo(()=>({from:r,to:a}),[r,a]),[l,o]=t.useState(null),[m,h]=t.useState(!0),[d,c]=t.useState(""),p=Se(),C=z(u=>u.user.user),{brandId:x}=ge(),S=u=>{c(d===u?"":u)},A=n!=null&&n.from?H(n.from,"yyyy-MM-dd"):"",y=n!=null&&n.to?H(n.to,"yyyy-MM-dd"):"",b=ke(),$=t.useCallback(async()=>{h(!0);try{const I=(await b.post(`/api/fbReport/platform/${x}`,{userId:C==null?void 0:C.id,startDate:A,endDate:y},{withCredentials:!0})).data||[];o(I)}catch(u){console.error("Error fetching data:",u)}finally{h(!1)}},[x,A,y]);t.useEffect(()=>{$();const u=setInterval($,15*60*1e3);return()=>clearInterval(u)},[$]),t.useEffect(()=>{s&&p(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),t.useEffect(()=>{d||s&&p(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[d,s]);const v=()=>{$()},w=l==null?void 0:l.blendedPlatformData,g="Platforms",F="MonthlyData",M=["Total Spend","Total Purchase ROAS"],N=["Spend","Purchase ROAS"];return e.jsxs("div",{children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Qe,{}),e.jsx("div",{children:e.jsx("h2",{className:"text-xl font-semibold tracking-tight",children:"Platform Insights"})})]})}),m?e.jsx("div",{className:"grid grid-cols-1 gap-6",children:e.jsx(Me,{})}):e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[w&&w.length>0&&e.jsxs(le,{className:`${d==="blended-summary"?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 bg-blue-500 rounded-full"}),e.jsx("div",{className:"text-lg font-medium",children:"Blended Summary"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[d&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{})}),e.jsx(D,{onClick:v,disabled:m,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx(fe,{className:`h-4 w-4 ${m?"animate-spin":""}`})}),e.jsx(D,{onClick:()=>S("blended-summary"),size:"sm",variant:"outline",className:"hover:bg-muted",children:d==="blended-summary"?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]})}),e.jsx(ce,{className:"p-0",children:e.jsxs("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:[e.jsx(Pe,{data:w||[],primaryColumn:g,metricConfig:Le.spendAndRoas||{}}),e.jsx(Ie,{data:Array.isArray(w)?w:[w],primaryColumn:g,secondaryColumns:M,monthlyDataKey:F,monthlyMetrics:N,isFullScreen:d==="blended-summary"})]})})]}),l==null?void 0:l.data.map((u,I)=>e.jsxs(le,{className:`${d===u.account_name?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md px-3 pt-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 bg-blue-500 rounded-full"}),e.jsx("div",{className:"text-lg font-medium",children:u.account_name})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[d&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{})}),e.jsx(D,{onClick:v,disabled:m,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx(fe,{className:`h-4 w-4 ${m?"animate-spin":""}`})}),e.jsx(D,{onClick:()=>S(u.account_name),size:"sm",variant:"outline",className:"hover:bg-muted",children:d===u.account_name?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]})}),e.jsx(ce,{className:"p-0",children:e.jsxs("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:[e.jsx(Pe,{data:u.platformData,primaryColumn:g,metricConfig:Le.spendAndRoas||{}}),e.jsx(Ie,{data:u.platformData,primaryColumn:g,secondaryColumns:M,monthlyDataKey:F,monthlyMetrics:N,isFullScreen:d===u.account_name})]})})]},I))]})]})},ic=({dateRange:s})=>{const r=z(u=>u.date.from),a=z(u=>u.date.to),n=t.useMemo(()=>({from:r,to:a}),[r,a]),l=Se(),[o,m]=t.useState(null),[h,d]=t.useState(!0),[c,p]=t.useState(""),C=z(u=>u.user.user),{brandId:x}=ge(),S=u=>{p(c===u?"":u)},A=n!=null&&n.from?H(n.from,"yyyy-MM-dd"):"",y=n!=null&&n.to?H(n.to,"yyyy-MM-dd"):"",b=ke(),$=t.useCallback(async()=>{d(!0);try{const I=(await b.post(`/api/fbReport/country/${x}`,{userId:C==null?void 0:C.id,startDate:A,endDate:y},{withCredentials:!0})).data||[];m(I)}catch(u){console.error("Error fetching data:",u)}finally{d(!1)}},[x,A,y]);t.useEffect(()=>{$();const u=setInterval($,15*60*1e3);return()=>clearInterval(u)},[$]),t.useEffect(()=>{s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),t.useEffect(()=>{c||s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[c,s]);const v=o==null?void 0:o.blendedCountryData,w=()=>{$()},g="Country",F="MonthlyData",M=["Total Spend","Total Purchase ROAS"],N=["Spend","Purchase ROAS"];return e.jsxs("div",{children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Qe,{}),e.jsx("div",{children:e.jsx("h2",{className:"text-xl font-semibold tracking-tight",children:"Country Insights"})})]})}),h?e.jsx("div",{className:"grid grid-cols-1 gap-6",children:e.jsx(Me,{})}):e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[v&&v.length>0&&e.jsxs(le,{className:`${c==="blended-summary"?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 bg-blue-500 rounded-full"}),e.jsx("div",{className:"text-lg font-medium",children:"Blended Summary"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[c&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{})}),e.jsx(D,{onClick:w,disabled:h,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx(fe,{className:`h-4 w-4 ${h?"animate-spin":""}`})}),e.jsx(D,{onClick:()=>S("blended-summary"),size:"sm",variant:"outline",className:"hover:bg-muted",children:c==="blended-summary"?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]})}),e.jsx(ce,{className:"p-0",children:e.jsxs("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:[e.jsx(Pe,{data:v||[],primaryColumn:g,metricConfig:Le.spendAndRoas||{}}),e.jsx(Ie,{data:Array.isArray(v)?v:[v],primaryColumn:g,secondaryColumns:M,monthlyDataKey:F,monthlyMetrics:N,isFullScreen:c==="blended-summary"})]})})]}),o==null?void 0:o.data.map((u,I)=>e.jsxs(le,{className:`${c===u.account_name?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 bg-blue-500 rounded-full"}),e.jsx("div",{className:"text-lg font-medium",children:u.account_name})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[c&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{})}),e.jsx(D,{onClick:w,disabled:h,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx(fe,{className:`h-4 w-4 ${h?"animate-spin":""}`})}),e.jsx(D,{onClick:()=>S(u.account_name),size:"sm",variant:"outline",className:"hover:bg-muted",children:c===u.account_name?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]})}),e.jsx(ce,{className:"p-0",children:e.jsxs("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:[e.jsx(Pe,{data:u.countryData||[],primaryColumn:g,metricConfig:Le.spendAndRoas||{}}),e.jsx(Ie,{data:u.countryData,primaryColumn:g,secondaryColumns:M,monthlyDataKey:F,monthlyMetrics:N,isFullScreen:c===u.account_name})]})})]},I))]})]})},cc=({dateRange:s})=>{const r=z(u=>u.date.from),a=z(u=>u.date.to),n=t.useMemo(()=>({from:r,to:a}),[r,a]),l=Se(),[o,m]=t.useState(null),[h,d]=t.useState(!0),[c,p]=t.useState(""),C=z(u=>u.user.user),{brandId:x}=ge(),S=u=>{p(c===u?"":u)},A=n!=null&&n.from?H(n.from,"yyyy-MM-dd"):"",y=n!=null&&n.to?H(n.to,"yyyy-MM-dd"):"",b=ke(),$=t.useCallback(async()=>{d(!0);try{const I=(await b.post(`/api/fbReport/device/${x}`,{userId:C==null?void 0:C.id,startDate:A,endDate:y},{withCredentials:!0})).data||[];m(I)}catch(u){console.error("Error fetching data:",u)}finally{d(!1)}},[x,A,y]);t.useEffect(()=>{$();const u=setInterval($,15*60*1e3);return()=>clearInterval(u)},[$]),t.useEffect(()=>{s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),t.useEffect(()=>{c||s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[c,s]);const v=()=>{$()},w=o==null?void 0:o.blendedDeviceData,g="Device",F="MonthlyData",M=["Total Spend","Total Purchase ROAS"],N=["Spend","Purchase ROAS"];return e.jsxs("div",{children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Qe,{}),e.jsx("div",{children:e.jsx("h2",{className:"text-xl font-semibold tracking-tight",children:"Device Insights"})})]})}),h?e.jsx("div",{className:"grid grid-cols-1 gap-6",children:e.jsx(Me,{})}):e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[w&&w.length>0&&e.jsxs(le,{className:`${c==="blended-summary"?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 bg-blue-500 rounded-full"}),e.jsx("div",{className:"text-lg font-medium",children:"Blended Summary"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[c&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{})}),e.jsx(D,{onClick:v,disabled:h,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx(fe,{className:`h-4 w-4 ${h?"animate-spin":""}`})}),e.jsx(D,{onClick:()=>S("blended-summary"),size:"sm",variant:"outline",className:"hover:bg-muted",children:c==="blended-summary"?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]})}),e.jsx(ce,{className:"p-0",children:e.jsxs("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:[e.jsx(Pe,{data:w||[],primaryColumn:g,metricConfig:Le.spendAndRoas||{}}),e.jsx(Ie,{data:Array.isArray(w)?w:[w],primaryColumn:g,secondaryColumns:M,monthlyDataKey:F,monthlyMetrics:N,isFullScreen:c==="blended-summary"})]})})]}),o==null?void 0:o.data.map((u,I)=>e.jsxs(le,{className:`${c===u.account_name?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 bg-blue-500 rounded-full"}),e.jsx("div",{className:"text-lg font-medium",children:u.account_name})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[c&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{})}),e.jsx(D,{onClick:v,disabled:h,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx(fe,{className:`h-4 w-4 ${h?"animate-spin":""}`})}),e.jsx(D,{onClick:()=>S(u.account_name),size:"sm",variant:"outline",className:"hover:bg-muted",children:c===u.account_name?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]})}),e.jsx(ce,{className:"p-0",children:e.jsxs("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:[e.jsx(Pe,{data:u.deviceData||[],primaryColumn:g,metricConfig:Le.spendAndRoas||{}}),e.jsx(Ie,{data:u.deviceData,primaryColumn:g,secondaryColumns:M,monthlyDataKey:F,monthlyMetrics:N,isFullScreen:c===u.account_name})]})})]},I))]})]})},dc=({dateRange:s})=>{const r=z(u=>u.date.from),a=z(u=>u.date.to),n=t.useMemo(()=>({from:r,to:a}),[r,a]),l=Se(),[o,m]=t.useState(null),[h,d]=t.useState(!0),[c,p]=t.useState(""),C=z(u=>u.user.user),{brandId:x}=ge(),S=u=>{p(c===u?"":u)},A=n!=null&&n.from?H(n.from,"yyyy-MM-dd"):"",y=n!=null&&n.to?H(n.to,"yyyy-MM-dd"):"",b=ke(),$=t.useCallback(async()=>{d(!0);try{const I=(await b.post(`/api/fbReport/gender/${x}`,{userId:C==null?void 0:C.id,startDate:A,endDate:y},{withCredentials:!0})).data||[];m(I)}catch(u){console.error("Error fetching data:",u)}finally{d(!1)}},[x,A,y]);t.useEffect(()=>{$();const u=setInterval($,15*60*1e3);return()=>clearInterval(u)},[$]),t.useEffect(()=>{s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),t.useEffect(()=>{c||s&&l(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[c,s]);const v=()=>{$()},w=o==null?void 0:o.blendedGenderData,g="Gender",F="MonthlyData",M=["Total Spend","Total Purchase ROAS"],N=["Spend","Purchase ROAS"];return e.jsxs("div",{children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Qe,{}),e.jsx("div",{children:e.jsx("h2",{className:"text-xl font-semibold tracking-tight",children:"Gender Insights"})})]})}),h?e.jsx("div",{className:"grid grid-cols-1 gap-6",children:e.jsx(Me,{})}):e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[w&&w.length>0&&e.jsxs(le,{className:`${c==="blended-summary"?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md px-3 pt-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 bg-blue-500 rounded-full"}),e.jsx("div",{className:"text-lg font-medium",children:"Blended Summary"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[c&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{})}),e.jsx(D,{onClick:v,disabled:h,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx(fe,{className:`h-4 w-4 ${h?"animate-spin":""}`})}),e.jsx(D,{onClick:()=>S("blended-summary"),size:"sm",variant:"outline",className:"hover:bg-muted",children:c==="blended-summary"?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]})}),e.jsx(ce,{className:"p-0",children:e.jsxs("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:[e.jsx(Pe,{data:w||[],primaryColumn:g,metricConfig:Le.spendAndRoas||{}}),e.jsx(Ie,{data:Array.isArray(w)?w:[w],primaryColumn:g,secondaryColumns:M,monthlyDataKey:F,monthlyMetrics:N,isFullScreen:c==="blended-summary"})]})})]}),o==null?void 0:o.data.map((u,I)=>e.jsxs(le,{className:`${c===u.account_name?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 bg-blue-500 rounded-full"}),e.jsx("div",{className:"text-lg font-medium",children:u.account_name})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[c&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{})}),e.jsx(D,{onClick:v,disabled:h,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx(fe,{className:`h-4 w-4 ${h?"animate-spin":""}`})}),e.jsx(D,{onClick:()=>S(u.account_name),size:"sm",variant:"outline",className:"hover:bg-muted",children:c===u.account_name?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]})}),e.jsx(ce,{className:"p-0",children:e.jsxs("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:[e.jsx(Pe,{data:u.genderData||[],primaryColumn:g,metricConfig:Le.spendAndRoas||{}}),e.jsx(Ie,{data:u.genderData,primaryColumn:g,secondaryColumns:M,monthlyDataKey:F,monthlyMetrics:N,isFullScreen:c===u.account_name,isAdsTable:!0})]})})]},I))]})]})},mc=({dateRange:s})=>{const r=z(u=>u.date.from),a=z(u=>u.date.to),n=t.useMemo(()=>({from:r,to:a}),[r,a]),[l,o]=t.useState(null),[m,h]=t.useState(!0),[d,c]=t.useState(""),p=Se(),C=z(u=>u.user.user),{brandId:x}=ge(),S=u=>{c(d===u?"":u)},A=n!=null&&n.from?H(n.from,"yyyy-MM-dd"):"",y=n!=null&&n.to?H(n.to,"yyyy-MM-dd"):"",b=ke(),$=t.useCallback(async()=>{h(!0);try{const I=(await b.post(`/api/fbReport/age/${x}`,{userId:C==null?void 0:C.id,startDate:A,endDate:y},{withCredentials:!0})).data||[];o(I)}catch(u){console.error("Error fetching data:",u)}finally{h(!1)}},[x,A,y]);t.useEffect(()=>{$();const u=setInterval($,15*60*1e3);return()=>clearInterval(u)},[$]),t.useEffect(()=>{s&&p(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[s]),t.useEffect(()=>{d||s&&p(ue({from:s.from?s.from.toISOString():void 0,to:s.to?s.to.toISOString():void 0}))},[d,s]);const v="Age",w="MonthlyData",g=["Total Spend","Total Purchase ROAS"],F=["Spend","Purchase ROAS"],M=()=>{$()},N=l==null?void 0:l.blendedAgeData;return e.jsxs("div",{children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Qe,{}),e.jsx("div",{children:e.jsx("h2",{className:"text-xl font-semibold tracking-tight",children:"Age Insights"})})]})}),m?e.jsx("div",{className:"grid grid-cols-1 gap-6",children:e.jsx(Me,{})}):e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[N&&N.length>0&&e.jsxs(le,{className:`${d==="blended-summary"?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md pt-2 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 bg-blue-500 rounded-full"}),e.jsx("div",{className:"text-lg font-medium",children:"Blended Summary"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[d&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{})}),e.jsx(D,{onClick:M,disabled:m,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx(fe,{className:`h-4 w-4 ${m?"animate-spin":""}`})}),e.jsx(D,{onClick:()=>S("blended-summary"),size:"sm",variant:"outline",className:"hover:bg-muted",children:d==="blended-summary"?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]})}),e.jsx(ce,{className:"p-0",children:e.jsxs("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:[e.jsx(Pe,{data:N||[],primaryColumn:v,metricConfig:Le.spendAndRoas||{}}),e.jsx(Ie,{data:Array.isArray(N)?N:[N],primaryColumn:v,secondaryColumns:g,monthlyDataKey:w,monthlyMetrics:F,isFullScreen:d==="blended-summary"})]})})]}),l==null?void 0:l.data.map((u,I)=>e.jsxs(le,{className:`${d===u.account_name?"fixed inset-0 z-50 m-0 bg-background p-2 overflow-auto":"rounded-md"}`,children:[e.jsx("div",{className:"bg-white rounded-md px-3 pt-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 bg-blue-500 rounded-full"}),e.jsx("div",{className:"text-lg font-medium",children:u.account_name})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[d&&e.jsx("div",{className:"transition-transform duration-300 ease-in-out hover:scale-105",children:e.jsx(be,{})}),e.jsx(D,{onClick:M,disabled:m,size:"sm",variant:"outline",className:"hover:bg-muted",children:e.jsx(fe,{className:`h-4 w-4 ${m?"animate-spin":""}`})}),e.jsx(D,{onClick:()=>S(u.account_name),size:"sm",variant:"outline",className:"hover:bg-muted",children:d===u.account_name?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(je,{className:"h-4 w-4"})})]})]})}),e.jsx(ce,{className:"p-0",children:e.jsxs("div",{className:"rounded-b-lg overflow-hidden px-2.5 pb-2.5",children:[e.jsx(Pe,{data:u.ageData||[],primaryColumn:v,metricConfig:Le.spendAndRoas||{}}),e.jsx(Ie,{data:Array.isArray(u.ageData)?u.ageData:[u.ageData],primaryColumn:v,secondaryColumns:g,monthlyDataKey:w,monthlyMetrics:F,isFullScreen:d===u.account_name})]})})]},I))]})]})},uc=()=>{const s=z(d=>d.date.from),r=z(d=>d.date.to),a=t.useMemo(()=>({from:s,to:r}),[s,r]),[n,l]=t.useState("age"),o={from:a.from?new Date(a.from):void 0,to:a.to?new Date(a.to):void 0},m=[{label:"Age",value:"age"},{label:"Gender",value:"gender"},{label:"Country",value:"country"},{label:"Platform",value:"platform"},{label:"Placement",value:"placement"},{label:"Impression Device",value:"impressionDevice"},{label:"Audience Segments",value:"audienceSegments"}],h=d=>{l(d)};return e.jsxs("div",{className:"flex h-screen bg-gray-100",children:[e.jsx(ts,{}),e.jsxs("div",{className:"flex-1 h-screen overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex-none",children:[e.jsx(js,{title:"Meta Reports",Icon:Et,showDatePicker:!0}),e.jsx("div",{className:"bg-white px-6 sticky top-0 z-10",children:e.jsx(zs,{tabs:m,activeTab:n,onTabChange:h})})]}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"px-6 py-4 space-y-6",children:[n==="audienceSegments"&&e.jsx("div",{id:"audienceSegments",children:e.jsx(nc,{dateRange:o})}),n==="placement"&&e.jsx("div",{id:"placement",children:e.jsx(oc,{dateRange:o})}),n==="platform"&&e.jsx("div",{id:"platform",children:e.jsx(lc,{dateRange:o})}),n==="country"&&e.jsx("div",{id:"country",children:e.jsx(ic,{dateRange:o})}),n==="impressionDevice"&&e.jsx("div",{id:"impressionDevice",children:e.jsx(cc,{dateRange:o})}),n==="gender"&&e.jsx("div",{id:"gender",children:e.jsx(dc,{dateRange:o})}),n==="age"&&e.jsx("div",{id:"age",children:e.jsx(mc,{dateRange:o})})]})}),e.jsx(gs,{})]})]})},hc={groups:[],selectedCampaigns:[],editingGroupId:null,expandedGroups:[],isCreatingGroup:!1},Ns=(s,r)=>{s.accounts||(s.accounts={}),s.accounts[r]||(s.accounts[r]={...hc})},xc=$s({name:"campaignGroups",initialState:{accounts:{}},reducers:{createGroup:(s,r)=>{const{accountId:a,name:n,campaigns:l,color:o}=r.payload;Ns(s,a);const m={id:Date.now().toString(),name:n,campaigns:l,color:o};s.accounts[a].groups.push(m),s.accounts[a].selectedCampaigns=[],s.accounts[a].isCreatingGroup=!1},deleteGroup:(s,r)=>{const{accountId:a,groupId:n}=r.payload;Ns(s,a),s.accounts[a].groups=s.accounts[a].groups.filter(l=>l.id!==n),s.accounts[a].editingGroupId===n&&(s.accounts[a].editingGroupId=null)},addCampaignToGroup:(s,r)=>{const{accountId:a,groupId:n,campaignName:l}=r.payload;Ns(s,a);const o=s.accounts[a].groups.find(m=>m.id===n);o&&!o.campaigns.includes(l)&&o.campaigns.push(l)},removeCampaignFromGroup:(s,r)=>{const{accountId:a,groupId:n,campaignName:l}=r.payload;Ns(s,a);const o=s.accounts[a].groups.find(m=>m.id===n);o&&(o.campaigns=o.campaigns.filter(m=>m!==l))},setSelectedCampaigns:(s,r)=>{const{accountId:a,campaigns:n}=r.payload;Ns(s,a),s.accounts[a].selectedCampaigns=n},toggleEditingGroup:(s,r)=>{const{accountId:a,groupId:n}=r.payload;Ns(s,a),s.accounts[a].editingGroupId=n},toggleGroupExpansion:(s,r)=>{const{accountId:a,groupId:n}=r.payload;Ns(s,a);const l=s.accounts[a].expandedGroups;l.includes(n)?s.accounts[a].expandedGroups=l.filter(o=>o!==n):s.accounts[a].expandedGroups.push(n)},setIsCreatingGroup:(s,r)=>{const{accountId:a,isCreating:n}=r.payload;Ns(s,a),s.accounts[a].isCreatingGroup=n,n||(s.accounts[a].selectedCampaigns=[])}}}),fc=xc.reducer,gc=Fo({conversionFilters:Li,brand:qo,user:Bo,date:il,campaignGroups:fc,campaignLabels:Cl,tutorials:vl}),pc={key:"root",storage:To,whitelist:["conversionFilters","brand","user","date","campaignGroups","campaignLabels","tutorials"]},jc=Mo(pc,gc),Kr=Fn({reducer:jc,middleware:s=>s({serializableCheck:{ignoredActions:["persist/PERSIST","persist/REHYDRATE","persist/REGISTER"]}})}),vc=ko(Kr);function bc(){const[s,r]=t.useState(!1),[a,n]=t.useState([]),[l,o]=t.useState("en-IN"),[m,h]=t.useState({totalSpent:0,totalRevenue:0,totalROAS:0,totalPurchases:0,totalCTR:0,totalCPC:0,totalCPM:0,totalCPP:0}),{brandId:d}=ge(),c=fs(),p=z(w=>w.date.from),C=z(w=>w.date.to),x=t.useMemo(()=>({from:p,to:C}),[p,C]),S=z(w=>w.user.user),A=S==null?void 0:S.id,y=t.useCallback(async()=>{var w;r(!0);try{const g="https://parallels.messold.com",F=x!=null&&x.from?H(x.from,"yyyy-MM-dd"):"",M=x!=null&&x.to?H(x.to,"yyyy-MM-dd"):"",u=(await ve.post(`${g}/api/metrics/fbAd/${d}`,{startDate:F,endDate:M,userId:A},{withCredentials:!0})).data.data;n(u),b(u)}catch(g){console.error("Error fetching ad data:",g),ve.isAxiosError(g)&&((w=g.response)==null?void 0:w.status)===401&&(alert("Your session has expired. Please log in again."),c("/"))}finally{r(!1)}},[c,x,d,A]);t.useEffect(()=>{y()},[y]),t.useEffect(()=>{y();const w=setInterval(y,5*60*1e3);return()=>clearInterval(w)},[y]);const b=t.useCallback(w=>{let g=0,F=0,M=0,N=0,u=0;w!=null&&w.length&&w.forEach(I=>{var i,L;g+=parseFloat(String(I.spend||"0")),F+=parseFloat(String(((i=I.Revenue)==null?void 0:i.value)||"0")),M+=parseFloat(String(((L=I.purchases)==null?void 0:L.value)||"0")),N+=parseFloat(String(I.clicks||"0")),u+=parseFloat(String(I.impressions||"0"))}),h({totalSpent:g,totalRevenue:F,totalROAS:F/g||0,totalPurchases:M,totalCTR:N/u*100||0,totalCPC:g/N||0,totalCPM:g*1e3/u||0,totalCPP:M>0?g/M:0})},[]),$=t.useMemo(()=>({totalSpent:`₹ ${m.totalSpent.toLocaleString(l)}`,totalRevenue:`₹ ${m.totalRevenue.toLocaleString(l)}`,totalROAS:Number(m.totalROAS.toFixed(2)).toLocaleString(l),totalPurchases:m.totalPurchases.toLocaleString(l),totalCTR:`${Number(m.totalCTR.toFixed(2)).toLocaleString(l)} %`,totalCPC:Number(m.totalCPC.toFixed(2)).toLocaleString(l),totalCPM:Number(m.totalCPM.toFixed(2)).toLocaleString(l),totalCPP:Number(m.totalCPP.toFixed(2)).toLocaleString(l)}),[m,l]),v=[{label:"Amount Spent",value:$.totalSpent,tooltipContent:"The sum of ad spends for all advertising platforms"},{label:"Revenue",value:$.totalRevenue,tooltipContent:"Revenue from Ads Purchases"},{label:"ROAS (Ads only)",value:$.totalROAS,tooltipContent:"Blended ROAS = Ads Purchases value / Blended Ad Spend"},{label:"Ads Purchases",value:$.totalPurchases,tooltipContent:"Ads Purchases = Fb Ads Purchase + Google Conversions"},{label:"CTR",value:$.totalCTR,tooltipContent:"Average CTR from all advertising platforms = (Blended Clicks / Blended Impressions)*100"},{label:"CPC",value:$.totalCPC,tooltipContent:"Average CPC from all advertising platforms = (Blended Ad Spend / Blended Clicks)"},{label:"CPM",value:$.totalCPM,tooltipContent:"Average CPM from all advertising platforms = (Blended Ad Spend * 1000 / Blended Impressions)"},{label:"CPP",value:$.totalCPP,tooltipContent:"Average CPP from all advertising platforms = (Blended Ad Spend / Blended Purchases)"}];return e.jsxs("div",{className:"flex h-screen",children:[e.jsx(ts,{}),e.jsxs("div",{className:"flex-1 h-screen overflow-auto",children:[e.jsxs("div",{className:"min-h-screen bg-gray-100",children:[e.jsx(js,{title:"Adaccount summary",Icon:Et,showDatePicker:!0,showSettings:!0,showRefresh:!0,isLoading:!1,handleManualRefresh:()=>{y()},locale:l,setLocale:o}),e.jsxs("main",{className:"p-4 md:p-6 lg:px-8",children:[e.jsx("div",{className:"space-y-2",children:e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold flex flex-row items-center justify-between",children:e.jsxs("div",{className:"flex flex-row items-center space-x-2",children:[e.jsx(Rt,{className:"h-5 w-5"}),e.jsx("span",{children:"Blended summary"}),e.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"#1877F2",children:e.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})})]})}),e.jsx(Bs,{metrics:v,date:{from:x.from?new Date(x.from):void 0,to:x.to?new Date(x.to):void 0},isLoading:s,icon:"Facebook"})]})}),(a==null?void 0:a.length)>0&&a.map((w,g)=>{var M,N;const F=[{label:"Amount Spent",value:`₹ ${parseFloat(String(w.spend||"0")).toLocaleString(l)}`},{label:"Revenue",value:`₹ ${parseFloat(String(((M=w.Revenue)==null?void 0:M.value)||"0")).toLocaleString(l)}`},{label:"ROAS (Ads only)",value:w.purchase_roas&&w.purchase_roas.length>0?parseFloat(String(w.purchase_roas[0].value)).toFixed(2):"0"},{label:"Ads Purchases",value:((N=w.purchases)==null?void 0:N.value)||"0"},{label:"CPC (All clicks)",value:`₹ ${new Intl.NumberFormat(l).format(parseFloat(w.cpc||"0"))}`},{label:"CPM",value:`₹ ${new Intl.NumberFormat(l,{minimumFractionDigits:2}).format(parseFloat(w.cpm||"0"))}`},{label:"CTR",value:`${parseFloat(w.ctr||"0").toFixed(2)} %`},{label:"Cost per Purchase (All)",value:`₹ ${new Intl.NumberFormat(l).format(parseFloat(w.cpp||"0"))}`}];return e.jsx(e.Fragment,{children:e.jsx(Bs,{icon:"Facebook",title:`Facebook - ${w.account_name}`,metrics:F,date:{from:x.from?new Date(x.from):void 0,to:x.to?new Date(x.to):void 0},isLoading:s,errorMessage:w.message},g)})})]})]}),e.jsx(gs,{})]})]})}function yc(){const[s,r]=t.useState(!1),[a,n]=t.useState(null),[l,o]=t.useState("en-IN"),{brandId:m}=ge(),h=fs(),d=z(y=>y.date.from),c=z(y=>y.date.to),p=t.useMemo(()=>({from:d,to:c}),[d,c]),C=z(y=>y.user.user),x=C==null?void 0:C.id,S=t.useCallback(async()=>{var y;r(!0);try{const b="https://parallels.messold.com",$=p!=null&&p.from?H(p.from,"yyyy-MM-dd"):"",v=p!=null&&p.to?H(p.to,"yyyy-MM-dd"):"",w=await ve.post(`${b}/api/metrics/fbCampaign/${m}`,{startDate:$,endDate:v,userId:x},{withCredentials:!0});n(w.data)}catch(b){console.error("Error fetching ad data:",b),ve.isAxiosError(b)&&((y=b.response)==null?void 0:y.status)===401&&(alert("Your session has expired. Please log in again."),h("/"))}finally{r(!1)}},[h,p,m,x]);t.useEffect(()=>{S();const y=setInterval(S,15*60*1e3);return()=>clearInterval(y)},[S]);let A="";return a!=null&&a.data&&a.data.length>1?A="max-h-[calc(100vh-400px)]":A="max-h-[calc(100vh-210px)]",e.jsxs("div",{className:"flex h-screen",children:[e.jsx(ts,{}),e.jsxs("div",{className:"flex-1 h-screen overflow-auto",children:[e.jsxs("div",{className:"min-h-screen bg-gray-100",children:[e.jsx(js,{title:"Campaign Report",Icon:Et,showDatePicker:!0,showSettings:!0,showRefresh:!0,isLoading:s,handleManualRefresh:S,locale:l,setLocale:o}),e.jsx("main",{className:"p-4 md:p-6 lg:px-8",children:s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):a!=null&&a.data&&a.data.length>0?a.data.map((y,b)=>e.jsx("div",{className:"mb-6",children:e.jsx(Or,{data:{account_name:y.account_name,account_id:y.account_id,campaigns:y.campaigns},height:A})},b)):e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No campaign data available"})})]}),e.jsx(gs,{})]})]})}const Nc=[{id:"FREE",title:"Free Plan",price:"Free",description:"Perfect for getting started with analytics",features:["Basic Analytics Dashboard","Shopify Integration","Daily Data Updates","Basic Reports","Email Support"],buttonText:"Get Started"},{id:"STARTUP",title:"Startup Plan",price:"$10",period:"/month",description:"Ideal for growing businesses",features:["Everything in Free Plan","Real-time Analytics","Custom Dashboards","Advanced Reports","Priority Email Support"],isPopular:!0,buttonText:"Subscribe Now"},{id:"GROWTH",title:"Growth Plan",price:"$50",period:"/month",description:"For businesses ready to scale",features:["Everything in Startup Plan","AI-Powered Insights","White-label Reports","Custom Integrations","Team Collaboration"],buttonText:"Subscribe Now"}];function wc(){return e.jsx("div",{className:"grid lg:grid-cols-3 gap-6",children:Nc.map(s=>e.jsxs("div",{className:`relative bg-white rounded-xl overflow-hidden border transition-all duration-300 hover:shadow-lg hover:scale-105 ${s.isPopular?"border-slate-200 shadow-md":"border-slate-100"}`,children:[e.jsxs("div",{className:`p-6 flex flex-col items-center ${s.id==="FREE"?"bg-gradient-to-b from-teal-50 to-white":s.id==="STARTUP"?"bg-gradient-to-b from-violet-50 to-white":"bg-gradient-to-b from-rose-50 to-white"}`,children:[s.isPopular&&e.jsxs("div",{className:"absolute top-0 left-0 bg-amber-500 text-white text-xs font-semibold py-1 px-3 rounded-br-lg",children:[e.jsx(go,{className:"h-3.5 w-3.5 fill-white inline-block mr-1"})," POPULAR"]}),e.jsx("h3",{className:"text-xl font-bold text-slate-800",children:s.title}),e.jsxs("div",{className:"flex items-baseline mt-4",children:[e.jsx("span",{className:`text-4xl font-bold ${s.id==="FREE"?"text-teal-600":s.id==="STARTUP"?"text-violet-600":"text-rose-600"}`,children:s.price}),s.period&&e.jsx("span",{className:"text-slate-500 ml-1",children:s.period})]}),e.jsx("p",{className:"mt-3 text-slate-600 text-sm text-center",children:s.description})]}),e.jsx("div",{className:"w-full h-px bg-slate-100"}),e.jsxs("div",{className:"p-6 bg-white",children:[e.jsx("ul",{className:"space-y-4",children:s.features.map((r,a)=>e.jsxs("li",{className:"flex items-start",children:[e.jsx("div",{className:`flex-shrink-0 rounded-full p-0.5 mt-0.5 ${s.id==="FREE"?"bg-teal-100 text-teal-600":s.id==="STARTUP"?"bg-violet-100 text-violet-600":"bg-rose-100 text-rose-600"}`,children:e.jsx(Ss,{className:"h-4 w-4"})}),e.jsx("span",{className:"ml-3 text-slate-700 text-sm",children:r})]},a))}),e.jsx("div",{className:"mt-8",children:e.jsx("button",{className:`w-full py-3 px-4 rounded-lg font-medium transition-all duration-200 ${s.id==="FREE"?"bg-teal-600 hover:bg-teal-700 text-white":s.id==="STARTUP"?"bg-violet-600 hover:bg-violet-700 text-white":"bg-rose-600 hover:bg-rose-700 text-white"}`,children:s.buttonText})})]})]},s.id))})}function Cc(){const[s,r]=t.useState("brands"),a=z(d=>d.user.user),n=a==null?void 0:a.brands,l=z(d=>d.brand.brands),o=n==null?void 0:n.map(d=>{const c=l.find(p=>p._id===d);return c?c.name:"Unknown Brand"}),m=async()=>{try{const c=await ve.get("https://parallels.messold.com/api/auth/zoho"),{authUrl:p}=c.data;window.location.href=p}catch(d){console.error("Error getting Zoho Auth URL:",d)}},h=fs();return e.jsxs("div",{className:"flex h-screen",children:[" ",e.jsx(ts,{}),e.jsx("div",{className:"flex-1 h-screen overflow-auto",children:e.jsx("div",{className:"min-h-screen bg-slate-50",children:e.jsx("div",{className:"container mx-auto px-4 py-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm",children:[e.jsx("div",{className:"p-6 border-b border-slate-200",children:e.jsxs("div",{className:"flex items-start gap-6",children:[e.jsx("div",{className:"h-24 w-24 rounded-full bg-slate-100 flex items-center justify-center",children:e.jsx("span",{className:"text-4xl font-bold text-slate-600",children:a==null?void 0:a.username[0]})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-800",children:a==null?void 0:a.username}),(a==null?void 0:a.isAdmin)&&e.jsxs(Vs,{className:"bg-teal-100 text-teal-700 px-3 py-1 rounded-full",children:[e.jsx(po,{className:"h-4 w-4 mr-1"}),"Administrator"]})]}),e.jsx("div",{className:"mt-4 grid grid-cols-2 gap-4",children:e.jsxs("div",{className:"flex items-center gap-2 text-slate-600",children:[e.jsx(Ys,{className:"h-4 w-4"}),e.jsx("span",{children:a==null?void 0:a.email})]})})]})]})}),e.jsx("div",{className:"border-b border-slate-200",children:e.jsx("div",{className:"flex px-6",children:["Brands","Pricing","Support"].map(d=>e.jsxs("button",{onClick:()=>r(d.toLowerCase()),className:`px-6 py-4 font-medium text-sm transition-colors relative ${s===d.toLowerCase()?"text-teal-600":"text-slate-600 hover:text-slate-900"}`,children:[d,s===d.toLowerCase()&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-teal-600"})]},d))})}),s.toLowerCase()==="brands"&&e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs(D,{onClick:()=>h("/brand-setup"),variant:"outline",className:"text-slate-700",children:[e.jsx(ur,{className:"h-5 w-5 mr-2"}),"Add New Brand"]}),o==null?void 0:o.map(d=>e.jsxs("div",{className:"bg-white rounded-lg border border-slate-200 p-5 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-slate-100 flex items-center justify-center",children:e.jsx(xr,{className:"h-5 w-5 text-teal-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-slate-900",children:d}),e.jsx("span",{className:"text-sm text-slate-500",children:"Connected"})]})]}),e.jsx(D,{variant:"ghost",size:"icon",className:"text-slate-600",children:e.jsx(dr,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-slate-600",children:"Integration Status"}),e.jsx(Vs,{className:"bg-teal-100 text-teal-700",children:"Active"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(D,{variant:"outline",size:"sm",className:"text-slate-700",children:"Manage"}),e.jsx(D,{variant:"ghost",size:"icon",className:"text-red-600 hover:text-red-700",children:e.jsx(fr,{className:"h-4 w-4"})})]})]})]},d))]})}),s.toLowerCase()==="pricing"&&e.jsx("div",{className:"p-5",children:e.jsx(wc,{})}),s.toLowerCase()==="support"&&(a==null?void 0:a.isAdmin)&&e.jsx("div",{className:"py-8 flex gap-4 items-center justify-center",children:e.jsxs(D,{onClick:m,className:"bg-teal-600 hover:bg-teal-700",children:[e.jsx(cr,{className:"h-5 w-5 mr-2"}),"Connect Zoho Help Desk"]})})]})})})})]})}const Sc=({children:s})=>{const r=Se(),n=pt().pathname,l=z(p=>p.tutorials.isFirstTimeLogin),o=z(p=>p.user.user),m=z(p=>p.tutorials.isTutorialActive),h=z(p=>p.tutorials.tutorialQueue),d=z(p=>p.tutorials.activeTutorial),c=Ze.useRef(!1);return t.useEffect(()=>{if(o&&!c.current){const p=o.loginCount===1;console.log("User login status:",{loginCount:o.loginCount,isFirstLogin:p}),r(gl(p))}},[o,r]),t.useEffect(()=>{console.log("Tutorial queue updated:",{active:d,queueLength:h.length,queue:h})},[d,h]),t.useEffect(()=>{c.current&&d===null&&!m&&(console.log("Tutorial session ended, marking first-time login as complete"),r(jl()))},[d,m,r]),t.useEffect(()=>{if(c.current)return;const p=l&&o&&!m&&h.length===0;if(console.log("Tutorial conditions:",{isFirstTimeLogin:l,hasUser:!!o,isTutorialActive:m,queueLength:h.length,shouldQueueTutorials:p}),p){const C=setTimeout(()=>{const x=Kt(n);if(console.log("Available tutorials for path:",{path:n,allTutorials:x}),x.length>0){const S=x.map(A=>A.id);console.log("Queueing tutorials:",S),r(Es(S)),c.current=!0}else console.log("No tutorials available for this path")},1500);return()=>clearTimeout(C)}},[l,o,n,m,h,r]),e.jsx(e.Fragment,{children:s})},Ac=()=>{const s=Se(),r=t.useRef(null),a=z(m=>m.tutorials.activeTutorial),n=z(m=>m.tutorials.isTutorialActive),l=z(m=>m.tutorials.activeTutorialStep),o=z(m=>m.tutorials.tutorialQueue);return t.useEffect(()=>{if(a&&n){console.log(`Starting tutorial: ${a}, Queue: [${o.join(", ")}]`);const m=ul(a);m&&m.length>0?(r.current&&(r.current.destroy(),r.current=null),setTimeout(()=>{let h=!0;if(m.forEach(c=>{document.querySelector(c.element)||(console.warn(`Element ${c.element} not found for tutorial ${a}`),h=!1)}),!h){console.warn(`Not all elements for tutorial ${a} exist on the page. Moving to next tutorial.`),s(kt());return}const d=$o({showProgress:!0,smoothScroll:!0,animate:!0,allowClose:!0,stagePadding:10,steps:m,onHighlightStarted:c=>{const p=m.findIndex(C=>C.element===(c==null?void 0:c.id));s(pl(p>=0?p:0))},onDestroyed:()=>{r.current=null;const c=hl(a);c.length>0&&(console.log(`Queueing related tutorials: ${c.join(", ")}`),s(Es(c))),console.log("Moving to next tutorial"),s(kt())}});l>0&&l<m.length?d.highlight(m[l]):d.drive(),r.current=d},500)):(console.error(`No steps defined for tutorial: ${a}`),s(kt()))}return()=>{r.current&&(r.current.destroy(),r.current=null)}},[a,n,s]),null};function kc(){return e.jsx("section",{className:"w-full py-12 md:py-8 lg:py-16 gradient-bg text-white",children:e.jsx("div",{className:"container px-4 md:px-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center space-y-4 text-center",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tighter md:text-4xl",children:"You’ve made it this far—why stop now?"}),e.jsx("p",{className:"max-w-[900px] md:text-xl",children:"Let’s take your marketing to the next level. Start your 14-day free trial today."})]}),e.jsxs("div",{className:"flex flex-col gap-2 min-[400px]:flex-row",children:[e.jsx(hs,{to:"/login",children:e.jsx(D,{size:"lg",variant:"secondary",className:"bg-white text-primary hover:bg-blue-50",children:"Start Free Trial"})}),e.jsx(D,{size:"lg",variant:"outline",className:"border-white text-black hover:bg-blue-50",children:"Schedule a Demo"})]}),e.jsxs("p",{className:"text-sm text-blue-100",children:["Got questions?"," ",e.jsx(hs,{to:"#",className:"text-white underline underline-offset-2",children:"Chat with our sales team"})]})]})})})}const Mc=({title:s,description:r,icon:a,index:n})=>e.jsxs("div",{className:ae("flex flex-col lg:border-r  py-10 relative group/feature dark:border-neutral-800",(n===0||n===4)&&"lg:border-l dark:border-neutral-800",n<4&&"lg:border-b dark:border-neutral-800"),children:[n<4&&e.jsx("div",{className:"opacity-0 group-hover/feature:opacity-100 transition duration-200 absolute inset-0 h-full w-full bg-gradient-to-t from-gray-200 dark:from-neutral-800 to-transparent pointer-events-none"}),n>=4&&e.jsx("div",{className:"opacity-0 group-hover/feature:opacity-100 transition duration-200 absolute inset-0 h-full w-full bg-gradient-to-b from-gray-200 dark:from-neutral-800 to-transparent pointer-events-none"}),e.jsx("div",{className:"mb-4 relative z-10 px-10 text-neutral-600 dark:text-neutral-400",children:a}),e.jsxs("div",{className:"text-lg font-bold mb-2 relative z-10 px-10",children:[e.jsx("div",{className:"absolute left-0 inset-y-0 h-6 group-hover/feature:h-8 w-1 rounded-tr-full rounded-br-full bg-neutral-300 dark:bg-neutral-700 group-hover/feature:bg-blue-500 transition-all duration-200 origin-center"}),e.jsx("span",{className:"group-hover/feature:translate-x-2 transition duration-200 inline-block text-neutral-800 dark:text-neutral-100",children:s})]}),e.jsx("p",{className:"text-sm text-neutral-600 dark:text-neutral-300 max-w-xs relative z-10 px-10",children:r})]}),Tc=[{title:"Unified Dashboard",description:"View all your marketing data in one place with customizable widgets",icon:e.jsx(at,{className:"h-8 w-8 text-primary"})},{title:"Multi-platform Integration",description:"Connect with Shopify, Meta, Google Ads, and GA4 seamlessly",icon:e.jsx(Bt,{className:"h-8 w-8 text-primary"})},{title:"Performance Tracking",description:"Monitor business performance across platforms and time periods",icon:e.jsx(Rs,{className:"h-8 w-8 text-primary"})},{title:"Demographic Analysis",description:"Track conversions based on location, demographics, brands, and products",icon:e.jsx(_t,{className:"h-8 w-8 text-primary"})},{title:"Automated Email Reports",description:"Receive regular performance updates directly in your inbox",icon:e.jsx(Ys,{className:"h-8 w-8 text-primary"})},{title:"Campaign Grouping",description:"Group campaigns by category to analyze performance at a glance",icon:e.jsx(jo,{className:"h-8 w-8 text-primary"})},{title:"Compare Date Ranges",description:"Easily compare analytics across different time periods",icon:e.jsx(Ot,{className:"h-8 w-8 text-primary"})},{title:"Easy & Transparent Pricing",description:"Simple, no-surprise pricing plans to fit every business",icon:e.jsx(pr,{className:"h-8 w-8 text-primary"})}];function Ic(){return e.jsx("section",{id:"features",className:"w-full py-12 md:py-8 lg:py-16 bg-slate-100 px-4",children:e.jsxs("div",{className:"container px-4 md:px-6",children:[e.jsx("div",{className:"flex flex-col items-center justify-center space-y-4 text-center mb-5",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tighter md:text-4xl lg:text-3xl gradient-text",children:"Smarter Marketing, Better Results"}),e.jsx("p",{className:"max-w-[900px] text-muted-foreground md:text-lg",children:"Track performance, scale campaigns, and maximize ROI—all with ease."})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4  relative z-10 pt-6 max-w-7xl mx-auto",children:Tc.map((s,r)=>e.jsx(Mc,{...s,index:r},s.title))})]})})}function Fc(){return e.jsx("footer",{className:"w-full border-t bg-slate-900 text-white",children:e.jsx("div",{className:"container px-6 py-8 flex justify-center items-center",children:e.jsxs("div",{className:"flex flex-col items-center space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 font-semibold text-2xl tracking-tight",children:[e.jsx("img",{src:Ht,alt:"Messold Logo",className:"h-8 w-8"}),e.jsx("span",{className:"text-slate-100",children:"Parallels"})]}),e.jsx("p",{className:"text-sm text-slate-400 text-center max-w-sm",children:"The all-in-one marketing platform for growing businesses."}),e.jsxs("nav",{className:"flex space-x-4 text-sm font-medium",children:[e.jsx(hs,{to:"/privacy-policy",className:"text-slate-400 transition hover:text-blue-400",children:"Privacy Policy"}),e.jsx("span",{className:"text-slate-500",children:"|"}),e.jsx(hs,{to:"#",className:"text-slate-400 transition hover:text-blue-400",children:"Terms of Service"})]})]})})})}const $c=()=>{const s=[],r=new Date;let a=25e3;for(let n=0;n<30;n++){const l=new Date(r);l.setDate(l.getDate()-(29-n));const o=l.getDate();a+=Math.random()*1500+500;const m=Math.random()>.7?Math.random()*1e4-5e3:Math.random()*3e3-1500,h=Math.round(a+m);s.push({name:o,value:Math.max(h,5e3)})}return s},Pc=$c();function Lc(){return e.jsxs("div",{className:"relative min-h-screen w-full overflow-hidden gradient-bg",children:[e.jsx("div",{className:"pointer-events-none absolute inset-0 bg-[radial-gradient(circle_at_50%_120%,rgba(120,119,198,0.3),rgba(255,255,255,0))]"}),e.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"grid gap-12 lg:grid-cols-2 lg:gap-8",children:[e.jsxs("div",{className:"flex flex-col justify-center items-start",children:[e.jsx("div",{className:"mb-8 flex justify-center",children:e.jsxs("div",{className:"animate-fade-in rounded-full border border-[#1E1B4B]/20 bg-[#0E0E2C] px-3 py-1 text-sm text-slate-300 backdrop-blur-sm",children:[e.jsx("span",{className:"mr-2 inline-block text-indigo-500",children:"✦"}),"Unified Marketing Analytics Platform"]})}),e.jsx("h1",{className:"text-center text-4xl font-bold tracking-tight text-white lg:text-left lg:text-6xl",children:e.jsx("span",{className:"block mb-2",children:"All Your Marketing Data,  One Place."})}),e.jsx("p",{className:"mt-6 text-center text-lg text-slate-200 lg:text-left",children:"Connect Shopify, Meta, Google Ads, and GA4 in one dashboard. Track performance, analyze conversions, and get automated email reports."}),e.jsxs("div",{className:"mt-8 flex flex-col items-center gap-4 sm:flex-row lg:justify-start",children:[e.jsx(hs,{to:"/login",children:e.jsxs(D,{size:"lg",className:"w-full bg-white text-black hover:bg-blue-100 sm:w-auto",children:["Start Free Trial ",e.jsx(jt,{className:"ml-2 h-4 w-4"})]})}),e.jsx(D,{size:"lg",variant:"outline",className:"w-full border-slate-800 text-black hover:bg-blue-100 sm:w-auto",children:"View Demo"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"relative rounded-2xl border border-slate-800 bg-[#0A0A1B] p-4",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"h-3 w-3 rounded-full bg-[#FF5F57]"}),e.jsx("div",{className:"h-3 w-3 rounded-full bg-[#FFBD2E]"}),e.jsx("div",{className:"h-3 w-3 rounded-full bg-[#28C840]"})]}),e.jsxs("div",{className:"flex items-center gap-2 rounded-full bg-slate-800/50 px-3 py-1",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-emerald-500"}),e.jsx("span",{className:"text-xs text-slate-300",children:"Last 30 days"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-300",children:"Analytics Overview"}),e.jsx(D,{variant:"outline",size:"sm",className:"border-slate-800",children:"Export"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-slate-100",children:[e.jsxs("div",{className:"rounded-lg bg-slate-800/50 p-4",children:[e.jsx("div",{className:"text-sm text-slate-400",children:"Revenue"}),e.jsx("div",{className:"mt-1 text-2xl font-bold",children:"$48.2K"}),e.jsx("div",{className:"mt-2 text-sm text-emerald-400",children:"+12.4%"})]}),e.jsxs("div",{className:"rounded-lg bg-slate-800/50 p-4",children:[e.jsx("div",{className:"text-sm text-slate-400",children:"Orders"}),e.jsx("div",{className:"mt-1 text-2xl font-bold",children:"2,567"}),e.jsx("div",{className:"mt-2 text-sm text-emerald-400",children:"+8.2%"})]}),e.jsxs("div",{className:"rounded-lg bg-slate-800/50 p-4",children:[e.jsx("div",{className:"text-sm text-slate-400",children:"Customers"}),e.jsx("div",{className:"mt-1 text-2xl font-bold",children:"1.2M"}),e.jsx("div",{className:"mt-2 text-sm text-emerald-400",children:"+4.7%"})]})]}),e.jsx("div",{className:"h-[300px] rounded-lg bg-slate-800/30 p-4",children:e.jsx(lt,{width:"100%",height:"100%",children:e.jsxs(So,{data:Pc,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorValue",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#6366f1",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#6366f1",stopOpacity:0})]})}),e.jsx(it,{dataKey:"name",axisLine:!1,tickLine:!1,tick:{fill:"#64748b",fontSize:12},interval:"preserveStartEnd"}),e.jsx(ct,{axisLine:!1,tickLine:!1,tick:{fill:"#64748b",fontSize:12},tickFormatter:s=>`$${s/1e3}k`}),e.jsx(Ao,{type:"monotone",dataKey:"value",stroke:"#6366f1",strokeWidth:2,fill:"url(#colorValue)"})]})})})]})]}),e.jsx("div",{className:"absolute -right-4 bottom-20",children:e.jsxs("div",{className:"rounded-2xl border border-green-500/20 bg-green-400/20 p-4 shadow-xl",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500"}),e.jsx("span",{className:"text-sm font-medium text-green-500",children:"New Milestone!"})]}),e.jsx("p",{className:"mt-1 text-xs text-green-300",children:"Revenue target achieved"})]})})]})]})})})]})}function Qr(){return e.jsx("header",{className:"sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:e.jsxs("div",{className:"container px-10 flex h-16 items-center justify-between",children:[e.jsx(hs,{to:"/",children:e.jsxs("div",{className:"flex items-center gap-2 font-bold text-xl",children:[e.jsx("img",{src:Ht,alt:"Messold Logo",className:"h-8 w-8"}),e.jsx("span",{children:"Parallels"})]})}),e.jsxs("nav",{className:"hidden md:flex gap-6",children:[e.jsx(hs,{to:"#features",className:"text-sm font-medium hover:text-primary",children:"Features"}),e.jsx(hs,{to:"#integrations",className:"text-sm font-medium hover:text-primary",children:"Integrations"}),e.jsx(hs,{to:"#analytics",className:"text-sm font-medium hover:text-primary",children:"Analytics"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(hs,{to:"/login",className:"text-sm font-medium hover:text-primary",children:"Log in"}),e.jsx(D,{children:"Get Started"})]})]})})}function Ec(){return e.jsxs("div",{className:"flex min-h-screen flex-col gradient-bg",children:[e.jsx(Qr,{}),e.jsxs("main",{className:"flex-1",children:[e.jsx(Lc,{}),e.jsx(Ic,{}),e.jsx(kc,{})]}),e.jsx(Fc,{})]})}function Rc(){return e.jsxs("div",{className:"min-h-screen bg-slate-100 text-slate-800",children:[e.jsx(Qr,{}),e.jsxs("div",{className:"container mx-auto px-6 py-12 max-w-5xl space-y-4",children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900 mb-6",children:"Privacy Policy"}),e.jsx("p",{className:"text-lg text-slate-600",children:"Your privacy is critical to us. Likewise, we have built up this Policy with the end goal you should see how we gather, utilize, impart and reveal and make utilization of individual data. The following blueprints our privacy policy"}),e.jsxs("ul",{className:"list-disc pl-6 space-y-4 text-slate-700",children:[e.jsx("li",{children:"Before or at the time of collecting personal information, we will identify the purposes for which information is being collected."}),e.jsx("li",{children:"We will gather and utilization of individual data singularly with the target of satisfying those reasons indicated by us and for other good purposes, unless we get the assent of the individual concerned or as required by law."}),e.jsx("li",{children:"We will just hold individual data the length of essential for the satisfaction of those reasons"}),e.jsx("li",{children:"We will gather individual data by legal and reasonable means and, where fitting, with the information or assent of the individual concerned"}),e.jsx("li",{children:"Personal information ought to be important to the reasons for which it is to be utilized, and, to the degree essential for those reasons, ought to be exact, finished, and updated."}),e.jsx("li",{children:"We will protect individual data by security shields against misfortune or burglary, and also unapproved access, divulgence, duplicating, use or alteratio."}),e.jsx("li",{children:"We will promptly provide customers with access to our policies and procedures for the administration of individual data."}),e.jsxs("li",{children:["For any concerns, please email us at"," ",e.jsx("a",{href:"mailto:team@messold.com",className:"text-blue-600 hover:underline",children:"team@messold.com"}),"."]})]}),e.jsx("p",{className:"text-sm text-slate-500",children:"Last updated: March 19, 2025"})]})]})}function Oc(){return e.jsx(In,{store:Kr,children:e.jsx(Io,{loading:null,persistor:vc,children:e.jsx(Po,{children:e.jsx(Ql,{children:e.jsx(_l,{children:e.jsx(Jr,{children:e.jsxs(Sc,{children:[e.jsx(Ac,{}),e.jsx(Wo,{}),e.jsxs($n,{children:[e.jsx(He,{path:"/",element:e.jsx(Ec,{})}),e.jsx(He,{path:"/login",element:e.jsx(Vo,{})}),e.jsx(He,{path:"/dashboard",element:e.jsx(Wl,{})}),e.jsx(He,{path:"/analytics-dashboard/:brandId",element:e.jsx(Ll,{})}),e.jsx(He,{path:"/ecommerce-reports/:brandId",element:e.jsx(Ai,{})}),e.jsx(He,{path:"/ad-metrics/:brandId",element:e.jsx(Zl,{})}),e.jsx(He,{path:"/performance-metrics",element:e.jsx(ti,{})}),e.jsx(He,{path:"/segment-dashboard/:brandId",element:e.jsx(vi,{})}),e.jsx(He,{path:"/adaccount-summary/:brandId",element:e.jsx(bc,{})}),e.jsx(He,{path:"/meta-campaigns/:brandId",element:e.jsx(yc,{})}),e.jsx(He,{path:"/meta-reports/:brandId",element:e.jsx(uc,{})}),e.jsx(He,{path:"/google-reports/:brandId",element:e.jsx(rc,{})}),e.jsx(He,{path:"/conversion-reports/:brandId/demographics",element:e.jsx(Vi,{})}),e.jsx(He,{path:"/conversion-reports/:brandId/performance",element:e.jsx(Ji,{})}),e.jsx(He,{path:"/callback",element:e.jsx(bi,{})}),e.jsx(He,{path:"/profile",element:e.jsx(Cc,{})}),e.jsx(He,{path:"/brand-setup",element:e.jsx(Br,{})}),e.jsx(He,{path:"/privacy-policy",element:e.jsx(Rc,{})})]})]})})})})})})})}Zr(document.getElementById("root")).render(e.jsx(t.StrictMode,{children:e.jsx(Oc,{})}));
//# sourceMappingURL=index-DQtygGp7.js.map
