import{r as l,j as e,R as Ke}from"./react-D8ek_KWF.js";import{c as Zs}from"./react-dom-RQgP6e1v.js";import{L as ne,B as Ys}from"./react-router-dom-E4ux4j3t.js";import{c as Ks}from"./clsx-B-dksMZM.js";import{t as qs}from"./tailwind-merge-Dnoi3Axr.js";import{S as Ws,R as as,V as rs,a as ns,A as ls,C as os,b as Xs,T as is,D as cs,P as Qs,c as Js,d as ds,e as et,f as st,g as tt,h as at,i as xs,j as rt,k as ms,l as nt,m as lt,n as hs,o as ps,p as ot,q as us,I as fs,r as gs,s as js,t as bs,u as ys,v as it,L as Cs,w as vs,x as ct,y as dt,z as xt,B as Ns,E as mt,F as ht,G as pt,H as ut,J as ft}from"./@radix-ui-2doXVd-V.js";import{c as Oe}from"./class-variance-authority-Bb4qSo10.js";import{a as $}from"./axios-CCb-kr4I.js";import{a as W,b as ws,d as oe,e as gt,f as J}from"./react-router-D-J8XLts.js";import{m as qe}from"./framer-motion-CwvKuL68.js";import{E as jt,a as bt,C as ge,b as me,S as Ss,U as yt,L as Ct,c as vt,d as Nt,e as Ue,f as Rs,g as Ls,M as wt,P as St,h as Rt,B as ie,R as ce,D as Lt,i as We,T as kt,F as be,j as At,k as Mt,l as Dt,m as Xe,n as Tt,o as $e,p as Pt,q as Me,A as De,r as Te,s as _t}from"./lucide-react-6Bkeit4J.js";import{R as Pe,P as ks,a as As,C as Ms,T as _e,B as Ft,b as $t,X as Ds,Y as Ts,L as Ps,c as It,A as Bt,d as Et}from"./recharts-BreeTN_J.js";import{D as Vt}from"./react-day-picker-B9_CsTZf.js";import{s as Qe,F as Ot,C as I}from"./date-fns-yT2CNxVW.js";import"./eventemitter3-_gqcMBhN.js";import"./scheduler-CzFDRTuY.js";import"./@remix-run-Br25Cn4W.js";import"./aria-hidden-DQ5UC2Eg.js";import"./react-remove-scroll-Bt6Gud5F.js";import"./tslib-CDuPK5Eb.js";import"./react-remove-scroll-bar-CRMJ-gRD.js";import"./react-style-singleton-DaAuT6gv.js";import"./get-nonce-C-Z93AgS.js";import"./use-sidecar-BnZEYIWv.js";import"./use-callback-ref-at-3vvNE.js";import"./@floating-ui-B0O51yml.js";import"./lodash-BVU3G9Cn.js";import"./react-is-DcfIKM1A.js";import"./react-smooth-C_iu3JyY.js";import"./prop-types-BbijBPcD.js";import"./fast-equals-C7I1S-bJ.js";import"./tiny-invariant-BaFNuDhB.js";import"./d3-shape-DjFPhhqo.js";import"./d3-path-CimkQT29.js";import"./victory-vendor-6_AdwBXU.js";import"./d3-scale-BYIooUZQ.js";import"./internmap-BkD7Hj8s.js";import"./d3-array-g_qRI3rN.js";import"./d3-time-format-BKO53YJi.js";import"./d3-time-QpEiTrED.js";import"./d3-interpolate-CvRPKVI0.js";import"./d3-color-9lF95FHy.js";import"./d3-format-CzD4bSOQ.js";import"./recharts-scale-DiOBu8nk.js";import"./decimal.js-light-B5-9uEc-.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const x of o)if(x.type==="childList")for(const f of x.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&n(f)}).observe(document,{childList:!0,subtree:!0});function r(o){const x={};return o.integrity&&(x.integrity=o.integrity),o.referrerPolicy&&(x.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?x.credentials="include":o.crossOrigin==="anonymous"?x.credentials="omit":x.credentials="same-origin",x}function n(o){if(o.ep)return;o.ep=!0;const x=r(o);fetch(o.href,x)}})();const _s=l.createContext(void 0),Ut=({children:s})=>{const[a,r]=l.useState(null);return e.jsx(_s.Provider,{value:{user:a,setUser:r},children:s})},ze=()=>{const s=l.useContext(_s);if(s===void 0)throw new Error("useUser must be used within a UserProvider");return s};function C(...s){return qs(Ks(s))}const ve=l.forwardRef(({className:s,type:a,...r},n)=>e.jsx("input",{type:a,className:C("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",s),ref:n,...r}));ve.displayName="Input";const Ve=Oe("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),N=l.forwardRef(({className:s,variant:a,size:r,asChild:n=!1,...o},x)=>{const f=n?Ws:"button";return e.jsx(f,{className:C(Ve({variant:a,size:r,className:s})),ref:x,...o})});N.displayName="Button";const zt=Oe("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Ne=l.forwardRef(({className:s,...a},r)=>e.jsx(as,{ref:r,className:C(zt(),s),...a}));Ne.displayName=as.displayName;const Gt=1,Ht=1e6;let Ie=0;function Zt(){return Ie=(Ie+1)%Number.MAX_SAFE_INTEGER,Ie.toString()}const Be=new Map,Je=s=>{if(Be.has(s))return;const a=setTimeout(()=>{Be.delete(s),ue({type:"REMOVE_TOAST",toastId:s})},Ht);Be.set(s,a)},Yt=(s,a)=>{switch(a.type){case"ADD_TOAST":return{...s,toasts:[a.toast,...s.toasts].slice(0,Gt)};case"UPDATE_TOAST":return{...s,toasts:s.toasts.map(r=>r.id===a.toast.id?{...r,...a.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=a;return r?Je(r):s.toasts.forEach(n=>{Je(n.id)}),{...s,toasts:s.toasts.map(n=>n.id===r||r===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return a.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(r=>r.id!==a.toastId)}}},we=[];let Se={toasts:[]};function ue(s){Se=Yt(Se,s),we.forEach(a=>{a(Se)})}function Kt({...s}){const a=Zt(),r=o=>ue({type:"UPDATE_TOAST",toast:{...o,id:a}}),n=()=>ue({type:"DISMISS_TOAST",toastId:a});return ue({type:"ADD_TOAST",toast:{...s,id:a,open:!0,onOpenChange:o=>{o||n()}}}),{id:a,dismiss:n,update:r}}function Fs(){const[s,a]=l.useState(Se);return l.useEffect(()=>(we.push(a),()=>{const r=we.indexOf(a);r>-1&&we.splice(r,1)}),[s]),{...s,toast:Kt,dismiss:r=>ue({type:"DISMISS_TOAST",toastId:r})}}function qt(){const[s,a]=l.useState(!0),[r,n]=l.useState(""),[o,x]=l.useState(""),[f,g]=l.useState(""),[c,L]=l.useState(!1),{toast:u}=Fs(),k=W(),[R,P]=l.useState({username:"",email:"",password:""}),{setUser:B}=ze(),_=()=>a(!s),E=()=>{const b={username:"",email:"",password:""};let v=!0;return!s&&!r.trim()&&(b.username="Username is required",v=!1),o.trim()?/\S+@\S+\.\S+/.test(o)||(b.email="Email is invalid",v=!1):(b.email="Email is required",v=!1),f?f.length<8&&(b.password="Password must be at least 8 characters",v=!1):(b.password="Password is required",v=!1),P(b),v},j=async b=>{if(b.preventDefault(),!!E())try{let v;const y="https://parallels.messold.com";s?(v=await $.post(`${y}/api/auth/login`,{email:o,password:f},{withCredentials:!0}),v.data.success&&(B(v.data.user),console.log("User set in context:",v.data.user),u({title:"Login successful!",description:"Welcome! Redirecting to your dashboard.",variant:"default"}),k("/dashboard"),console.log(y))):(v=await $.post(`${y}/api/auth/signup`,{username:r,email:o,password:f},{withCredentials:!0}),v.data.success&&(u({title:"Registration successful!",description:"Please log in with your new account.",variant:"default"}),a(!0)))}catch(v){$.isAxiosError(v)&&v.response?u({title:"Error",description:v.response.data.message||"An error occurred",variant:"destructive"}):u({title:"Unexpected Error",description:"An unexpected error occurred",variant:"destructive"})}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-purple-400 to-indigo-600",children:e.jsxs(qe.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white p-8 rounded-lg shadow-2xl w-96",children:[e.jsxs("div",{className:"flex mb-6",children:[e.jsx("button",{className:`flex-1 py-2 ${s?"text-indigo-600 border-b-2 border-indigo-600":"text-gray-500"}`,onClick:()=>a(!0),children:"Login"}),e.jsx("button",{className:`flex-1 py-2 ${s?"text-gray-500":"text-indigo-600 border-b-2 border-indigo-600"}`,onClick:()=>a(!1),children:"Sign Up"})]}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[!s&&e.jsxs(qe.div,{initial:{opacity:0,height:0},animate:{opacity:s?0:1,height:s?0:"auto"},transition:{duration:.3},className:"overflow-hidden space-y-2",children:[e.jsx(Ne,{htmlFor:"username",children:"Username"}),e.jsx(ve,{id:"username",type:"text",value:r,onChange:b=>n(b.target.value),placeholder:"Enter your username",required:!s}),R.username&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:R.username})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ne,{htmlFor:"email",children:"Email"}),e.jsx(ve,{id:"email",type:"email",value:o,onChange:b=>x(b.target.value),placeholder:"Enter your email",required:!0}),R.email&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:R.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ne,{htmlFor:"password",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(ve,{id:"password",type:c?"text":"password",value:f,onChange:b=>g(b.target.value),placeholder:"Enter your password",required:!0}),e.jsx("button",{type:"button",onClick:()=>L(!c),className:"absolute right-2 top-2",children:c?e.jsx(jt,{className:"h-5 w-5 text-gray-500"}):e.jsx(bt,{className:"h-5 w-5 text-gray-500"})})]}),R.password&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:R.password})]}),e.jsx(N,{type:"submit",className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white",children:s?"Login":"Sign Up"})]}),e.jsxs("p",{className:"mt-4 text-center text-sm text-gray-600",children:[s?"Don't have an account? ":"Already have an account? ",e.jsx("button",{onClick:_,className:"text-indigo-600 hover:underline",children:s?"Sign Up":"Login"})]})]})})}const Wt=Qs,$s=l.forwardRef(({className:s,...a},r)=>e.jsx(rs,{ref:r,className:C("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",s),...a}));$s.displayName=rs.displayName;const Xt=Oe("group pointer-events-auto relative flex w-full items-center justify-between space-x-2 overflow-hidden rounded-md border p-4 pr-6 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Is=l.forwardRef(({className:s,variant:a,...r},n)=>e.jsx(ns,{ref:n,className:C(Xt({variant:a}),s),...r}));Is.displayName=ns.displayName;const Qt=l.forwardRef(({className:s,...a},r)=>e.jsx(ls,{ref:r,className:C("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium transition-colors hover:bg-secondary focus:outline-none focus:ring-1 focus:ring-ring disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s),...a}));Qt.displayName=ls.displayName;const Bs=l.forwardRef(({className:s,...a},r)=>e.jsx(os,{ref:r,className:C("absolute right-1 top-1 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-1 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...a,children:e.jsx(Xs,{className:"h-4 w-4"})}));Bs.displayName=os.displayName;const Es=l.forwardRef(({className:s,...a},r)=>e.jsx(is,{ref:r,className:C("text-sm font-semibold [&+div]:text-xs",s),...a}));Es.displayName=is.displayName;const Vs=l.forwardRef(({className:s,...a},r)=>e.jsx(cs,{ref:r,className:C("text-sm opacity-90",s),...a}));Vs.displayName=cs.displayName;function Jt(){const{toasts:s}=Fs();return e.jsxs(Wt,{children:[s.map(function({id:a,title:r,description:n,action:o,...x}){return e.jsxs(Is,{...x,children:[e.jsxs("div",{className:"grid gap-1",children:[r&&e.jsx(Es,{children:r}),n&&e.jsx(Vs,{children:n})]}),o,e.jsx(Bs,{})]},a)}),e.jsx($s,{})]})}const Os=l.createContext(void 0),ea=({children:s})=>{const[a,r]=l.useState(null),[n,o]=l.useState([]),x=()=>{r(null)};return e.jsx(Os.Provider,{value:{selectedBrandId:a,setSelectedBrandId:r,resetBrand:x,brands:n,setBrands:o},children:s})},Ge=()=>{const s=l.useContext(Os);if(s===void 0)throw new Error("useBrand must be used within a BrandProvider");return s},Us=et,Le=st,ke=tt,fe=l.forwardRef(({className:s,sideOffset:a=4,...r},n)=>e.jsx(Js,{children:e.jsx(ds,{ref:n,sideOffset:a,className:C("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...r})}));fe.displayName=ds.displayName;const sa=()=>e.jsx(ne,{to:"/dashboard",children:e.jsx("div",{className:"bg-white rounded-full flex items-center justify-center",style:{width:"24px",height:"24px"},children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",fill:"none",viewBox:"0 0 40 40",children:[e.jsx("path",{fill:"#F06225",d:"M20 0c11.046 0 20 8.954 20 20v14a6 6 0 0 1-6 6H21v-8.774c0-2.002.122-4.076 1.172-5.78a10 10 0 0 1 6.904-4.627l.383-.062a.8.8 0 0 0 0-1.514l-.383-.062a10 10 0 0 1-8.257-8.257l-.062-.383a.8.8 0 0 0-1.514 0l-.062.383a9.999 9.999 0 0 1-4.627 6.904C12.85 18.878 10.776 19 8.774 19H.024C.547 8.419 9.29 0 20 0Z"}),e.jsx("path",{fill:"#F06225",d:"M0 21h8.774c2.002 0 4.076.122 5.78 1.172a10.02 10.02 0 0 1 3.274 3.274C18.878 27.15 19 29.224 19 31.226V40H6a6 6 0 0 1-6-6V21ZM40 2a2 2 0 1 1-4 0 2 2 0 0 1 4 0Z"})]})})});function se(){const[s,a]=l.useState(!1),{selectedBrandId:r,setSelectedBrandId:n,brands:o,setBrands:x}=Ge(),f=W(),g=ws(),c="https://parallels.messold.com",L=()=>{a(u=>!u)};return l.useEffect(()=>{(async()=>{try{const k=await $.get(`${c}/api/brands/all`,{withCredentials:!0});x(k.data)}catch(k){console.error("Error fetching brands:",k)}})()},[x]),e.jsx(Us,{children:e.jsxs("div",{className:`bg-gray-800 text-white transition-all duration-300 ease-in-out flex flex-col justify-between ${s?"w-64":"w-16"}`,children:[e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-end p-4",children:e.jsx("button",{onClick:L,className:"text-gray-300 hover:text-white focus:outline-none","aria-label":s?"Collapse sidebar":"Expand sidebar",children:s?e.jsx(ge,{size:24}):e.jsx(me,{size:24})})}),e.jsxs("nav",{className:"mt-3 overflow-y-auto max-h-[calc(100vh-200px)]",children:[e.jsx(es,{icon:e.jsx(sa,{}),text:"Messold",isExpanded:s,isSelected:!0,tooltipContent:"Messold"}),o.map(u=>e.jsx(es,{icon:e.jsx(Ss,{size:24}),text:u.name.replace(/_/g," "),isExpanded:s,isSelected:g.pathname.includes(u._id)||r===u._id,tooltipContent:u.name,onClick:()=>{n(u._id),f(`/business-dashboard/${u._id}`)}},u._id))]})]}),e.jsx(ta,{isExpanded:s})]})})}function es({icon:s,text:a,isExpanded:r,children:n,isSelected:o,tooltipContent:x,onClick:f}){const g=e.jsxs("div",{onClick:f,className:`flex items-center px-4 py-2 mb-2 text-gray-300 hover:bg-gray-700 hover:text-white transition-colors
         duration-200 cursor-pointer ${o?"text-white font-semibold relative":"text-gray-100"}`,children:[e.jsx("span",{className:r?"mr-2":"mr-0",children:s}),r&&e.jsx("span",{className:"text-sm",children:a})]});return e.jsxs("div",{children:[r?g:e.jsxs(Le,{children:[e.jsx(ke,{asChild:!0,children:g}),e.jsxs(fe,{side:"right",children:[e.jsx("p",{children:x}),Ke.Children.map(n,c=>e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute top-0 w-1 h-full bg-gray-500"}),c]}))]})]}),r&&e.jsxs("div",{className:"relative pl-8",children:[e.jsx("div",{className:"absolute top-0 w-1 h-full bg-gray-500"}),Ke.Children.map(n,c=>e.jsx("div",{children:c}))]})]})}function ta({isExpanded:s}){const{user:a,setUser:r}=ze(),{resetBrand:n}=Ge(),o=W(),x=async()=>{try{await $.post("https://parallels.messold.com/api/auth/logout",{},{withCredentials:!0}),r(null),n(),o("/")}catch(c){console.error("Error logging out:",c)}},f=e.jsxs("div",{className:"flex items-center gap-4 px-4 py-2 mb-2 text-gray-300 hover:bg-gray-700 hover:text-white transition-colors duration-200 cursor-pointer",children:[e.jsx("span",{className:"text-gray-300 hover:text-white",children:e.jsx(yt,{size:24})}),s&&e.jsx("span",{className:"text-sm mr-2",children:(a==null?void 0:a.username)||"user"})]}),g=e.jsx("div",{className:"flex items-center gap-4 px-4 py-2 mb-2 text-gray-300 hover:bg-gray-700 hover:text-white transition-colors duration-200 cursor-pointer",children:e.jsx("span",{className:"text-gray-300 hover:text-white",children:e.jsx(Ct,{onClick:x,size:24})})});return e.jsxs("div",{children:[s?f:e.jsxs(Le,{children:[e.jsx(ke,{asChild:!0,children:f}),e.jsx(fe,{side:"right",children:e.jsx("p",{children:(a==null?void 0:a.username)||"user"})})]}),s?g:e.jsxs(Le,{children:[e.jsx(ke,{asChild:!0,children:g}),e.jsx(fe,{side:"right",children:e.jsx("p",{children:"Logout"})})]})]})}const U=l.forwardRef(({className:s,...a},r)=>e.jsx("div",{ref:r,className:C("rounded-xl border bg-card text-card-foreground shadow",s),...a}));U.displayName="Card";const z=l.forwardRef(({className:s,...a},r)=>e.jsx("div",{ref:r,className:C("flex flex-col space-y-1.5 p-6",s),...a}));z.displayName="CardHeader";const q=l.forwardRef(({className:s,...a},r)=>e.jsx("h3",{ref:r,className:C("font-semibold leading-none tracking-tight",s),...a}));q.displayName="CardTitle";const Q=l.forwardRef(({className:s,...a},r)=>e.jsx("p",{ref:r,className:C("text-sm text-muted-foreground",s),...a}));Q.displayName="CardDescription";const H=l.forwardRef(({className:s,...a},r)=>e.jsx("div",{ref:r,className:C("p-6 pt-0",s),...a}));H.displayName="CardContent";const aa=l.forwardRef(({className:s,...a},r)=>e.jsx("div",{ref:r,className:C("flex items-center p-6 pt-0",s),...a}));aa.displayName="CardFooter";const ye=["#071952","#088395","#37B7C3","#4A628A","#98DED9","#FF33CC"],ra=({rawData:s})=>{if(s.length===0)return e.jsx("div",{style:{textAlign:"center",marginTop:"50px"},children:e.jsx("p",{children:"No data available. Please set up Google Analytics for this data."})});const a=s.reduce((o,x)=>{const f=x.Channel,g=parseInt(x.Visitors,10);return o[f]||(o[f]={Channel:f,totalVisitors:0}),o[f].totalVisitors+=g,o},{}),r=Object.values(a).sort((o,x)=>x.totalVisitors-o.totalVisitors).slice(0,5),n=()=>e.jsx("div",{className:"grid grid-cols-3 gap-2 mt-2",children:r.map((o,x)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-4 h-4 mr-2",style:{backgroundColor:ye[x%ye.length]}}),e.jsx("span",{className:"text-xs",children:o.Channel})]},`legend-${x}`))});return e.jsxs("div",{children:[n(),e.jsx(Pe,{width:"100%",height:280,children:e.jsxs(ks,{children:[e.jsx(As,{data:r,dataKey:"totalVisitors",nameKey:"channel",cx:"50%",cy:"50%",outerRadius:"60%",label:!0,children:r.map((o,x)=>e.jsx(Ms,{fill:ye[x%ye.length]},`cell-${x}`))}),e.jsx(_e,{})]})})]})},na=s=>s.map(a=>({city:a.City,visitors:parseInt(a.Visitors,10)})).filter(a=>!isNaN(a.visitors)).sort((a,r)=>r.visitors-a.visitors).slice(0,5),la=(s,a)=>{const r=["#E0F7FA","#B2EBF2","#80DEEA","#4DD0E1","#00ACC1"],n=Math.floor(s/a*(r.length-1));return r[n]},oa=({cityData:s})=>{const a=na(s),r=Math.max(...a.map(n=>n.visitors));return e.jsx(Pe,{width:"100%",height:300,children:a.length>0?e.jsxs(Ft,{data:a,layout:"vertical",margin:{right:30,left:35,bottom:30},children:[e.jsx($t,{strokeDasharray:"3 3"}),e.jsx(Ds,{type:"number",label:{value:"Visitors",position:"insideBottom",offset:-5}}),e.jsx(Ts,{dataKey:"city",type:"category"}),e.jsx(_e,{formatter:n=>[n,"Visitors"],contentStyle:{backgroundColor:"hsl(var(--background))",borderColor:"hsl(var(--border))"}}),e.jsx(Ps,{verticalAlign:"top",height:36}),e.jsx(It,{dataKey:"visitors",name:"Visitors",barSize:20,fill:"#00ACC1",shape:n=>{const{visitors:o}=n.payload;return e.jsx("rect",{...n,fill:la(o,r)})}})]}):e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("p",{className:"text-muted-foreground",children:"No data available. Please set up Google Analytics for this data."})})})},ia=s=>s.map(a=>({LandingPage:a.LandingPage,Visitors:parseInt(a.Visitors,10)})).sort((a,r)=>r.Visitors-a.Visitors).slice(0,5),ss=["#050C9C","#3572EF","#3ABEF9","#577B8D","#8dd1e1"],ca=({PageData:s})=>{const a=ia(s),[r,n]=l.useState(window.innerWidth<768);return l.useEffect(()=>{const o=()=>{n(window.innerWidth<768)};return window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)},[]),e.jsx("div",{children:e.jsx(Pe,{width:"100%",height:280,children:a.length>0?e.jsxs(ks,{className:"px-6",children:[e.jsx(_e,{formatter:(o,x)=>[`${o}`,`${x}`]}),!r&&e.jsx(Ps,{layout:"vertical",align:"right",verticalAlign:"middle"}),e.jsx(As,{data:a,dataKey:"Visitors",nameKey:"LandingPage",cx:"35%",cy:"50%",outerRadius:100,innerRadius:40,label:!0,children:a.map((o,x)=>e.jsx(Ms,{fill:ss[x%ss.length]},`cell-${x}`))})]}):e.jsx("div",{style:{textAlign:"center",marginTop:"50px"},children:e.jsx("p",{children:"No data available for top landing pages.Please set up Google Analytics for this data."})})})})};function zs({className:s,classNames:a,showOutsideDays:r=!0,...n}){return e.jsx(Vt,{showOutsideDays:r,className:C("p-3",s),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:C(Ve({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-8 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:C("relative p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([aria-selected])]:bg-accent [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected].day-range-end)]:rounded-r-md",n.mode==="range"?"[&:has(>.day-range-end)]:rounded-r-md [&:has(>.day-range-start)]:rounded-l-md first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md":"[&:has([aria-selected])]:rounded-md"),day:C(Ve({variant:"ghost"}),"h-8 w-8 p-0 font-normal aria-selected:opacity-100"),day_range_start:"day-range-start",day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50  aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...a},components:{IconLeft:()=>e.jsx(at,{className:"h-4 w-4"}),IconRight:()=>e.jsx(xs,{className:"h-4 w-4"})},...n})}zs.displayName="Calendar";const da=nt,xa=lt,Gs=l.forwardRef(({className:s,align:a="center",sideOffset:r=4,...n},o)=>e.jsx(rt,{children:e.jsx(ms,{ref:o,align:a,sideOffset:r,className:C("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...n})}));Gs.displayName=ms.displayName;function de({date:s,setDate:a,defaultDate:r,resetToFirstPage:n}){const[o,x]=l.useState(s||r),f=u=>{x(u)},g=()=>{a(o),n&&n()},c=(u,k)=>{x({from:u,to:k})},L=u=>u?u.from?u.to?`${I(u.from,"LLL dd, y")} - ${I(u.to,"LLL dd, y")}`:I(u.from,"LLL dd, y"):"Pick a date":r&&r.from&&r.to?`${I(r.from,"LLL dd, y")} - ${I(r.to,"LLL dd, y")}`:"Pick a date";return e.jsx("div",{className:"grid gap-2",children:e.jsxs(da,{children:[e.jsx(xa,{asChild:!0,children:e.jsxs(N,{id:"date",variant:"outline",className:C("w-[260px] justify-start text-left font-normal",!o&&!r&&"text-muted-foreground"),children:[e.jsx(vt,{className:"mr-2 h-4 w-4"}),L(o)]})}),e.jsx(Gs,{className:"w-auto p-4",align:"start",children:e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(N,{size:"sm",variant:"outline",onClick:()=>c(new Date,new Date),children:"Today"}),e.jsx(N,{size:"sm",variant:"outline",onClick:()=>c(Qe(new Date,6),new Date),children:"Last 7 days"}),e.jsx(N,{size:"sm",variant:"outline",onClick:()=>c(Qe(new Date,29),new Date),children:"Last 30 days"}),e.jsx(N,{size:"sm",variant:"outline",onClick:()=>c(Ot(new Date,3),new Date),children:"Last 3 months"})]}),e.jsx(zs,{initialFocus:!0,mode:"range",defaultMonth:(o==null?void 0:o.from)||(r==null?void 0:r.from)||new Date,selected:o,onSelect:f,numberOfMonths:2}),e.jsx(N,{onClick:g,children:"Update"})]})})]})})}const ma=s=>Object.entries(s).map(([a,r])=>({name:a,value:r})),ha=({active:s,payload:a})=>s&&a&&a.length?e.jsxs("div",{className:"bg-background border border-border p-2 rounded-md shadow-md",children:[e.jsx("p",{className:"font-bold",children:a[0].payload.name}),e.jsx("p",{children:a[0].value.toLocaleString()})]}):null,ts=["#4f83cc","#337ab7","#1e6a8c","#0d4d68"];function pa({rawData:s}){const r=ma(s.reduce((n,o)=>(n.Add_To_Carts+=parseInt(o.Add_To_Carts,10),n.Checkouts+=parseInt(o.Checkouts,10),n.Sessions+=parseInt(o.Sessions,10),n.Purchases+=parseInt(o.Purchases,10),n),{Add_To_Carts:0,Checkouts:0,Sessions:0,Purchases:0}));return s.length===0?e.jsx("div",{style:{textAlign:"center",marginTop:"50px"},children:e.jsx("p",{children:"No data available. Please set up Google Analytics for this data."})}):e.jsx(Pe,{width:"100%",height:280,children:e.jsxs(Bt,{data:r,children:[e.jsx(Ds,{dataKey:"name"}),e.jsx(Ts,{}),e.jsx(_e,{content:e.jsx(ha,{})}),e.jsx(Et,{type:"monotone",dataKey:"value",stroke:"#0d4d68",fillOpacity:.4,fill:"#0d4d68"}),e.jsx("defs",{children:e.jsx("linearGradient",{id:"colorGradient",x1:"0",y1:"0",x2:"1",y2:"0",children:ts.map((n,o)=>e.jsx("stop",{offset:`${o/(ts.length-1)*100}%`,stopColor:n},o))})})]})})}const He=ct,Ze=dt,ua=xt,fa=l.forwardRef(({className:s,inset:a,children:r,...n},o)=>e.jsxs(hs,{ref:o,className:C("flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",a&&"pl-8",s),...n,children:[r,e.jsx(xs,{className:"ml-auto"})]}));fa.displayName=hs.displayName;const ga=l.forwardRef(({className:s,...a},r)=>e.jsx(ps,{ref:r,className:C("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...a}));ga.displayName=ps.displayName;const Fe=l.forwardRef(({className:s,sideOffset:a=4,...r},n)=>e.jsx(ot,{children:e.jsx(us,{ref:n,sideOffset:a,className:C("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...r})}));Fe.displayName=us.displayName;const Ye=l.forwardRef(({className:s,inset:a,...r},n)=>e.jsx(fs,{ref:n,className:C("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",a&&"pl-8",s),...r}));Ye.displayName=fs.displayName;const ja=l.forwardRef(({className:s,children:a,checked:r,...n},o)=>e.jsxs(gs,{ref:o,className:C("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:r,...n,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(js,{children:e.jsx(bs,{className:"h-4 w-4"})})}),a]}));ja.displayName=gs.displayName;const Re=l.forwardRef(({className:s,children:a,...r},n)=>e.jsxs(ys,{ref:n,className:C("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(js,{children:e.jsx(it,{className:"h-2 w-2 fill-current"})})}),a]}));Re.displayName=ys.displayName;const ba=l.forwardRef(({className:s,inset:a,...r},n)=>e.jsx(Cs,{ref:n,className:C("px-2 py-1.5 text-sm font-semibold",a&&"pl-8",s),...r}));ba.displayName=Cs.displayName;const ya=l.forwardRef(({className:s,...a},r)=>e.jsx(vs,{ref:r,className:C("-mx-1 my-1 h-px bg-muted",s),...a}));ya.displayName=vs.displayName;function xe({brandId:s}){const a=W(),r=l.useCallback(o=>{a(o)},[a]),n=[{name:"Monthly Ad Metrics Reports",icon:Rs,path:`/ad-metrics/${s}`},{name:"Daily E-Commerce Metrics Reports",icon:Ls,path:`/ecommerce-metrics/${s}`},{name:"City based Reports",icon:wt,path:`/city-metrics/${s}`},{name:"Landing Page based Reports",icon:St,path:`/page-metrics/${s}`},{name:"Referring Channel based Reports",icon:Rt,path:`/channel-metrics/${s}`}];return e.jsxs(He,{children:[e.jsx(Ze,{asChild:!0,children:e.jsxs(N,{className:"flex items-center justify-between bg-cyan-600 hover:bg-cyan-700","aria-label":"View Reports",children:[e.jsx("span",{className:"mr-2",children:"View Reports"}),e.jsx(Nt,{className:"mr-2 h-4 w-4","aria-hidden":"true"}),e.jsx(Ue,{className:"h-4 w-4","aria-hidden":"true"})]})}),e.jsx(Fe,{align:"end",className:"w-72",children:n.map(o=>e.jsxs(Ye,{onClick:()=>r(o.path),className:"flex items-center",children:[e.jsx(o.icon,{className:"mr-2 h-4 w-4","aria-hidden":"true"}),e.jsx("span",{className:"p-0.5",children:o.name})]},o.name))})]})}function Hs({brandId:s}){const a=[{name:"Business Dashboard",icon:ie,path:`/business-dashboard/${s}`},{name:"Ad Metrics Dashboard",icon:Rs,path:`/analytics-dashboard/${s}`}],r=W(),n=ws(),[o,x]=l.useState(a[0]);l.useEffect(()=>{const g=a.find(c=>n.pathname.includes(c.path));g&&x(g)},[n.pathname]);const f=l.useCallback(g=>{x(g),r(g.path)},[r]);return e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs(He,{children:[e.jsx(Ze,{asChild:!0,children:e.jsxs(N,{variant:"ghost",className:"p-0 hover:bg-transparent",children:[e.jsx("h1",{className:"text-2xl font-bold",children:o.name}),e.jsx(Ue,{className:"h-4 w-4 ml-2","aria-hidden":"true"})]})}),e.jsx(Fe,{align:"start",children:a.map(g=>e.jsxs(Ye,{onClick:()=>f(g),className:"flex items-center",children:[e.jsx(g.icon,{className:"h-5 w-5 mr-2 text-gray-500","aria-hidden":"true"}),e.jsx("span",{children:g.name})]},g.name))})]})})}function Ca(){const{brandId:s}=oe(),[a,r]=l.useState(null),[n,o]=l.useState(!1),[x,f]=l.useState(null),[g,c]=l.useState(void 0),L=W(),u=g!=null&&g.from?I(g.from,"yyyy-MM-dd"):"",k=g!=null&&g.to?I(g.to,"yyyy-MM-dd"):"",R=new Date,P=l.useCallback(async()=>{var m;o(!0);try{const d="https://parallels.messold.com";let p=`${d}/api/shopify/data/${s}`;const w=new URLSearchParams;u&&w.append("startDate",u),k&&w.append("endDate",k),w.toString()&&(p+=`?${w.toString()}`);const M=await $.get(p,{withCredentials:!0}),A=await $.post(`${d}/api/analytics/report/${s}`,{startDate:u,endDate:k},{withCredentials:!0});console.log("Analytics Data:",A.data);const F=await $.post(`${d}/api/analytics/atcreport/${s}`,{startDate:u,endDate:k},{withCredentials:!0});console.log("Daily Analytics Data:",F.data);const V={...M.data,analyticsReports:A.data||null,dailyCartCheckoutReports:F.data?[F.data]:[]};r(V),console.log(a),f(new Date)}catch(d){console.error("Error fetching dashboard data:",d),$.isAxiosError(d)&&((m=d.response)==null?void 0:m.status)===401&&(alert("Your session has expired. Please log in again."),L("/"))}finally{o(!1)}},[L,u,k]);l.useEffect(()=>{P()},[P]),l.useEffect(()=>{P();const m=setInterval(P,5*60*1e3);return()=>clearInterval(m)},[P]);const B=()=>{P()},_=a==null?void 0:a.analyticsReports.find(m=>m.reportType==="Purchase Data");let E=0;_&&Array.isArray(_.data)&&(E=_.data.reduce((m,d)=>m+Number(d.ConversionRate),0));const b=parseFloat((()=>{if(!a||!a.analyticsReports)return 0;const m=a.analyticsReports.find(p=>p.reportType==="Returning Customer Rate");return!m||!m.data?0:m.data.reduce((p,{returnRate:w})=>{const M=parseFloat(w)||0;return p+M},0)})().toFixed(2)),v=()=>{var d;if(!a||!a.analyticsReports)return[];const m=((d=a.analyticsReports.find(p=>p.reportType==="Sessions by Referring Channel"))==null?void 0:d.data)||[];return m?m.map(p=>({Channel:p.Channel,Visitors:p.Visitors,Sessions:p.Sessions})):[]},y=()=>{var d;if(!a||!a.analyticsReports)return[];const m=((d=a.analyticsReports.find(p=>p.reportType==="Sessions by Location"))==null?void 0:d.data)||[];return m?m.map(p=>({City:p.City,Region:p.Region,Country:p.Country,Visitors:p.Visitors,Sessions:p.Sessions})):[]},T=()=>{var d;if(!a||!a.analyticsReports)return[];const m=((d=a.analyticsReports.find(p=>p.reportType==="Landing Page Report"))==null?void 0:d.data)||[];return m?m.map(p=>({LandingPage:p.LandingPage,Visitors:p.Visitors})):[]};return a?e.jsxs(e.Fragment,{children:[e.jsx("header",{className:"bg-white border-b border-gray-200 px-4 py-4 md:px-6 lg:px-6",children:e.jsxs("div",{className:" flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:[e.jsx(Hs,{brandId:s}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(xe,{brandId:s}),e.jsx(de,{date:g,setDate:c,defaultDate:{from:new Date(R.getFullYear(),R.getMonth(),1),to:R}})]})]})}),e.jsxs("div",{className:"p-4 md:p-6 bg-gradient-to-br from-gray-100 to-gray-200 min-h-screen",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h1",{className:"text-2xl font-semibold mb-2 flex items-center space-x-3",children:[e.jsx(ie,{className:"h-6 w-6"}),e.jsx("span",{children:"Blended summary"}),e.jsx("svg",{viewBox:"0 0 64 64",className:"w-5 h-5",xmlns:"http://www.w3.org/2000/svg",children:e.jsxs("g",{children:[e.jsx("g",{children:e.jsx("path",{d:"M51.759,12.659c-0.221-0.021-4.94-0.371-4.94-0.371s-3.28-3.271-3.639-3.631    c-0.36-0.362-1.063-0.254-1.337-0.171c-0.039,0.011-0.715,0.222-1.834,0.567c-1.096-3.167-3.027-6.077-6.426-6.077    c-0.094,0-0.191,0.004-0.289,0.01c-0.966-1.283-2.164-1.844-3.199-1.844c-7.919,0-11.703,9.951-12.889,15.008    c-3.078,0.956-5.266,1.638-5.542,1.728C9.943,18.42,9.89,18.474,9.667,20.1C9.495,21.331,5,56.264,5,56.264l35.022,6.594    L59,58.731c0,0-6.661-45.261-6.703-45.572C52.255,12.849,51.983,12.677,51.759,12.659z M33.034,10.88    c0,0.119-0.002,0.231-0.002,0.344c-1.928,0.601-4.02,1.251-6.121,1.906c1.179-4.57,3.387-6.78,5.32-7.613    C32.716,6.743,33.034,8.505,33.034,10.88z M29.876,3.278c0.346,0,0.688,0.116,1.018,0.345c-2.539,1.199-5.258,4.224-6.408,10.261    c-1.679,0.522-3.319,1.034-4.838,1.506C20.994,10.783,24.188,3.278,29.876,3.278z M31.241,30.19c0,0-2.05-1.099-4.561-1.099    c-3.686,0-3.872,2.324-3.872,2.908c0,3.195,8.287,4.42,8.287,11.903c0,5.888-3.714,9.678-8.726,9.678    c-6.012,0-9.088-3.761-9.088-3.761l1.609-5.345c0,0,3.16,2.729,5.83,2.729c1.74,0,2.449-1.38,2.449-2.387    c0-4.168-6.799-4.354-6.799-11.203c0-5.761,4.116-11.341,12.428-11.341c3.199,0,4.783,0.923,4.783,0.923L31.241,30.19z     M35.11,10.578c0-0.211,0.002-0.417,0.002-0.644c0-1.966-0.273-3.551-0.709-4.807c1.752,0.219,2.919,2.223,3.67,4.528    C37.194,9.931,36.194,10.241,35.11,10.578z",fill:"#95C675"})}),e.jsx("g",{children:e.jsx("path",{d:"M51.759,12.659c-0.221-0.021-4.94-0.371-4.94-0.371s-3.28-3.271-3.639-3.631    c-0.36-0.362-1.063-0.254-1.337-0.171c-0.039,0.011-0.715,0.222-1.834,0.567c-1.096-3.167-3.027-6.077-6.426-6.077    c-0.094,0-0.191,0.004-0.289,0.01c-0.966-1.283-2.164-1.844-3.199-1.844c-7.919,0-9.873,9.951-11.059,15.008    c-3.078,0.956-5.44,6.219-5.719,6.307c-1.719,0.542-1.772,0.596-1.996,2.223C11.148,25.91,5,56.264,5,56.264l35.022,6.594    L59,58.731c0,0-6.661-45.261-6.703-45.572C52.255,12.849,51.983,12.677,51.759,12.659z M33.034,10.88    c0,0.119-0.002,0.231-0.002,0.344c-1.928,0.601-4.02,1.251-6.121,1.906c1.179-4.57,3.387-6.78,5.32-7.613    C32.716,6.743,33.034,8.505,33.034,10.88z M29.876,3.278c0.346,0,0.688,0.116,1.018,0.345c-2.539,1.199-5.258,4.224-6.408,10.261    c-1.679,0.522-3.319,1.034-4.838,1.506C20.994,10.783,24.188,3.278,29.876,3.278z M31.241,30.19c0,0-2.05-1.099-4.561-1.099    c-3.686,0-3.872,2.324-3.872,2.908c0,3.195,8.287,4.42,8.287,11.903c0,5.888-3.714,9.678-8.726,9.678    c-6.012,0-9.088-3.761-9.088-3.761l1.609-5.345c0,0,3.16,2.729,5.83,2.729c1.74,0,2.449-1.38,2.449-2.387    c0-4.168-6.799-4.354-6.799-11.203c0-5.761,4.116-11.341,12.428-11.341c3.199,0,4.783,0.923,4.783,0.923L31.241,30.19z     M35.11,10.578c0-0.211,0.002-0.417,0.002-0.644c0-1.966-0.273-3.551-0.709-4.807c1.752,0.219,2.919,2.223,3.67,4.528    C37.194,9.931,36.194,10.241,35.11,10.578z",fill:"#79B259"})}),e.jsx("path",{d:"M40.022,62.857L59,58.731c0,0-6.661-45.261-6.703-45.572c-0.042-0.311-0.313-0.482-0.538-0.5   c-0.221-0.021-4.94-0.371-4.94-0.371s-3.28-3.271-3.639-3.631c-0.192-0.194-0.479-0.249-0.75-0.251   c-0.72,1.22-0.571,3.537-0.571,3.537l-2.232,50.839L40.022,62.857z",fill:"#55932C"}),e.jsx("path",{d:"M33.583,2.977c-0.094,0-0.191,0.004-0.289,0.01c-0.966-1.283-2.164-1.844-3.199-1.844   c-7.887,0-11.674,9.873-12.875,14.947l2.447-0.759c1.354-4.609,4.545-12.053,10.209-12.053c0.346,0,0.688,0.116,1.018,0.345   c-2.532,1.195-5.244,4.209-6.398,10.213l2.43-0.75c1.182-4.541,3.381-6.739,5.307-7.569c0.484,1.227,0.803,2.988,0.803,5.363   c0,0.108,0,0.211-0.002,0.314l2.078-0.643c0-0.2,0.002-0.4,0.002-0.617c0-1.966-0.273-3.551-0.709-4.807   c1.746,0.218,2.912,2.213,3.662,4.508l1.938-0.601C38.906,5.876,36.976,2.977,33.583,2.977z",fill:"#4A7A2B"}),e.jsx("path",{d:"M47.611,12.348c-0.474-0.037-0.793-0.06-0.793-0.06s-3.28-3.271-3.639-3.631   c-0.192-0.194-0.479-0.249-0.75-0.251c-0.72,1.22-0.571,3.537-0.571,3.537l-2.232,50.839l0.396,0.075l10.098-2.196L47.611,12.348z",fill:"#4C822A"})]})}),e.jsxs("svg",{viewBox:"0 0 24 24",className:"w-5 h-5",children:[e.jsx("rect",{x:"17",y:"2",width:"5",height:"20",rx:"2.5",fill:"#F9AB00"}),e.jsx("path",{d:"M9.5 13.5C9.5 12.1193 10.6193 11 12 11C13.3807 11 14.5 12.1193 14.5 13.5V19.5C14.5 20.8807 13.3807 22 12 22C10.6193 22 9.5 20.8807 9.5 19.5V13.5Z",fill:"#E37400"}),e.jsx("path",{d:"M2 19.5C2 18.1193 3.11929 17 4.5 17C5.88071 17 7 18.1193 7 19.5C7 20.8807 5.88071 22 4.5 22C3.11929 22 2 20.8807 2 19.5Z",fill:"#E37400"}),e.jsx("path",{d:"M6.92162 10C6.36184 10 5.95724 9.68838 5.95724 9.05977V8.55474H3.2304C2.49881 8.55474 2 8.1088 2 7.45332C2 7.07723 2.12193 6.70651 2.40459 6.22297C2.93666 5.29349 3.57403 4.31565 4.31116 3.23573C4.92637 2.31162 5.39747 2 6.20111 2C7.2209 2 7.88044 2.54265 7.88044 3.38617V7.02351H8.19082C8.72842 7.02351 9 7.34587 9 7.79181C9 8.23774 8.72288 8.55474 8.19082 8.55474H7.88044V9.05977C7.88044 9.68838 7.47585 10 6.92162 10ZM6.01267 7.09335V3.48287H5.97387C5.0095 4.8368 4.34996 5.83076 3.7015 7.03962V7.09335H6.01267Z",fill:"#E37400"})]})]}),e.jsxs("div",{className:"md:flex items-center hidden",children:[x&&e.jsxs("span",{className:"text-sm text-gray-600 mr-4",children:["Last updated: ",x.toLocaleTimeString()]}),e.jsxs(N,{onClick:B,disabled:n,className:"flex items-center",children:[e.jsx(ce,{className:`mr-2 h-4 w-4 ${n?"animate-spin":""}`}),"Refresh"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-2 mb-4 md:mb-5",children:[{title:"Total Orders",value:a.totalOrders,colorClass:"text-cyan-700",icon:Ls},{title:"Total Sales",value:`₹${a.totalSales.toFixed(2)}`,colorClass:"text-cyan-700",icon:Lt},{title:"Monthly Conversion Rate",value:`${E.toFixed(2)}%`,colorClass:"text-cyan-700",icon:We},{title:"Average Order Value",value:`₹${a.averageOrderValue.toFixed(2)}`,colorClass:"text-cyan-700",icon:kt},{title:"Monthly Return Rate",value:`${b}`,colorClass:"text-cyan-700",icon:We}].map((m,d)=>e.jsxs(U,{className:"shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1",children:[e.jsxs(z,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(q,{className:"text-lg text-gray-600",children:m.title}),e.jsx(m.icon,{className:`h-6 w-6 ${m.colorClass}`})]}),e.jsx(H,{children:e.jsx("p",{className:`text-2xl font-bold ${m.colorClass}`,children:m.value})})]},d))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:[e.jsxs(U,{className:"shadow-lg hover:shadow-xl transition-all duration-300 mb-5",children:[e.jsxs(z,{className:"flex flex-row justify-between items-center",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(q,{className:"text-base",children:"Aggregated E-commerce Metrics"}),e.jsx(Q,{children:"Total Add to Carts, Checkouts, Sessions, and Purchases"})]}),e.jsx(ne,{to:`/ecommerce-metrics/${s}`,children:e.jsx(N,{className:" bg-blue-50 text-blue-900 hover:text-white ",children:e.jsx(be,{})})})]}),e.jsx(H,{children:e.jsx(pa,{rawData:(a==null?void 0:a.dailyCartCheckoutReports[0].data)||[]})})]}),e.jsxs(U,{className:"shadow-lg hover:shadow-xl transition-all duration-300 mb-5",children:[e.jsxs(z,{className:"flex flex-row justify-between items-center",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(q,{className:"text-base",children:"Top Cities"}),e.jsx(Q,{children:"Visitor Count For Top cities"})]}),e.jsx(ne,{to:`/city-metrics/${s}`,children:e.jsx(N,{className:" bg-blue-50 text-blue-900 hover:text-white ",children:e.jsx(be,{})})})]}),e.jsx(H,{children:e.jsx(oa,{cityData:y()})})]}),e.jsxs(U,{className:"shadow-lg hover:shadow-xl transition-all duration-300 mb-5",children:[e.jsxs(z,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(q,{className:"text-base",children:"Top Referring Channels"}),e.jsx(Q,{children:"Visitor count for reffering channels"})]}),e.jsx(ne,{to:`/channel-metrics/${s}`,children:e.jsx(N,{className:" bg-blue-50 text-blue-900 hover:text-white ",children:e.jsx(be,{})})})]}),e.jsx(H,{className:"h-80",children:e.jsx(ra,{rawData:v()})})]})]}),e.jsx("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-4",children:e.jsxs(U,{className:"shadow-lg hover:shadow-xl transition-all duration-300 ",children:[e.jsxs(z,{className:"flex flex-row justify-between items-center px-6 py-3",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(q,{className:"text-base",children:"Top Landing Pages"}),e.jsx(Q,{children:"Visitors count based on Landing Pages"})]}),e.jsx(ne,{to:`/page-metrics/${s}`,children:e.jsx(N,{className:" bg-blue-50 text-blue-900 hover:text-white ",children:e.jsx(be,{})})})]}),e.jsx(ca,{PageData:T()})]})})]})]}):e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-t-2 border-b-2 border-blue-500"})})}function va(){return e.jsxs("div",{className:"flex h-screen",children:[e.jsx(se,{}),e.jsx("div",{className:"flex-1 h-screen overflow-auto",children:e.jsx(Ca,{})})]})}function Ce({className:s,...a}){return e.jsx("div",{className:C("animate-pulse rounded-md bg-primary/10",s),...a})}const Na=()=>e.jsxs(U,{className:"transition-transform transform hover:scale-105 hover:border hover:border-blue-600",children:[e.jsxs(z,{className:"flex flex-col items-start justify-start",children:[e.jsxs("div",{className:"flex flex-row items-center gap-2",children:[e.jsx(Ce,{className:"w-4 h-4 rounded-full"}),e.jsx(Ce,{className:"h-6 w-24"})]}),e.jsx(Ce,{className:"h-4 w-32 mt-2"})]}),e.jsx(H,{children:e.jsx(Ce,{className:"h-8 w-20 mt-2"})})]}),wa=({label:s,value:a,date:r,icon:n,tooltipContent:o})=>e.jsxs(U,{className:"transition-transform transform hover:scale-105 hover:border hover:border-blue-600",children:[e.jsxs(z,{className:"flex flex-col items-start justify-start",children:[e.jsxs("div",{className:"flex flex-row items-center gap-2",children:[n==="Facebook"?e.jsx("svg",{className:"w-4 h-4",fill:"#1877F2",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}):n==="Google"?e.jsxs("svg",{viewBox:"0 0 24 24",className:"w-5 h-5",children:[e.jsx("path",{d:"M13.5437 4.24116L13.5441 4.24138C13.904 4.43971 14.2179 4.70303 14.4689 5.01529C14.7198 5.3275 14.903 5.68264 15.009 6.0601L15.4904 5.92486L15.009 6.0601C15.115 6.43752 15.1422 6.83078 15.0891 7.21776C15.0361 7.60457 14.9038 7.97861 14.6989 8.31855C14.6988 8.31873 14.6987 8.31891 14.6986 8.3191L8.41444 18.701C7.9918 19.3741 7.30557 19.868 6.49825 20.0687C5.68937 20.2699 4.83087 20.1586 4.10949 19.7614C3.38872 19.3646 2.86649 18.7168 2.64727 17.9633C2.42868 17.212 2.5264 16.4083 2.92214 15.7226L9.20689 5.33823C9.20695 5.33813 9.20702 5.33802 9.20708 5.33792C9.62451 4.65082 10.3142 4.14383 11.1301 3.93599C11.9464 3.72804 12.8151 3.83872 13.5437 4.24116Z",fill:"#FFB70A",stroke:"#FFB70A"}),e.jsx("path",{d:"M21.5404 15.4544L15.24 5.04127C14.7453 4.25097 13.9459 3.67817 13.0138 3.44633C12.0817 3.21448 11.0917 3.34215 10.2572 3.80182C9.4226 4.26149 8.8103 5.01636 8.55224 5.90372C8.29418 6.79108 8.41102 7.73988 8.87757 8.54562L15.178 18.9587C15.6726 19.749 16.4721 20.3218 17.4042 20.5537C18.3362 20.7855 19.3262 20.6579 20.1608 20.1982C20.9953 19.7385 21.6076 18.9836 21.8657 18.0963C22.1238 17.2089 22.0069 16.2601 21.5404 15.4544Z",fill:"#3B8AD8"}),e.jsx("path",{d:"M9.23018 16.2447C9.07335 15.6884 8.77505 15.1775 8.36166 14.7572C7.94827 14.3369 7.43255 14.0202 6.86011 13.835C6.28768 13.6499 5.67618 13.6021 5.07973 13.6958C4.48328 13.7895 3.92026 14.0219 3.44049 14.3723C2.96071 14.7227 2.57898 15.1804 2.32906 15.7049C2.07914 16.2294 1.96873 16.8045 2.00762 17.3794C2.0465 17.9542 2.23347 18.5111 2.55199 19.0007C2.8705 19.4902 3.31074 19.8975 3.83376 20.1863C4.46363 20.5354 5.1882 20.6983 5.91542 20.6542C6.64264 20.6101 7.33969 20.361 7.91802 19.9386C8.49636 19.5162 8.92988 18.9395 9.16351 18.2817C9.39715 17.624 9.42035 16.915 9.23018 16.2447Z",fill:"#2CAA14"})]}):n===""?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"#1877F2",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),e.jsxs("svg",{viewBox:"0 0 24 24",className:"w-5 h-5",children:[e.jsx("path",{d:"M13.5437 4.24116L13.5441 4.24138C13.904 4.43971 14.2179 4.70303 14.4689 5.01529C14.7198 5.3275 14.903 5.68264 15.009 6.0601L15.4904 5.92486L15.009 6.0601C15.115 6.43752 15.1422 6.83078 15.0891 7.21776C15.0361 7.60457 14.9038 7.97861 14.6989 8.31855C14.6988 8.31873 14.6987 8.31891 14.6986 8.3191L8.41444 18.701C7.9918 19.3741 7.30557 19.868 6.49825 20.0687C5.68937 20.2699 4.83087 20.1586 4.10949 19.7614C3.38872 19.3646 2.86649 18.7168 2.64727 17.9633C2.42868 17.212 2.5264 16.4083 2.92214 15.7226L9.20689 5.33823C9.20695 5.33813 9.20702 5.33802 9.20708 5.33792C9.62451 4.65082 10.3142 4.14383 11.1301 3.93599C11.9464 3.72804 12.8151 3.83872 13.5437 4.24116Z",fill:"#FFB70A",stroke:"#FFB70A"}),e.jsx("path",{d:"M21.5404 15.4544L15.24 5.04127C14.7453 4.25097 13.9459 3.67817 13.0138 3.44633C12.0817 3.21448 11.0917 3.34215 10.2572 3.80182C9.4226 4.26149 8.8103 5.01636 8.55224 5.90372C8.29418 6.79108 8.41102 7.73988 8.87757 8.54562L15.178 18.9587C15.6726 19.749 16.4721 20.3218 17.4042 20.5537C18.3362 20.7855 19.3262 20.6579 20.1608 20.1982C20.9953 19.7385 21.6076 18.9836 21.8657 18.0963C22.1238 17.2089 22.0069 16.2601 21.5404 15.4544Z",fill:"#3B8AD8"}),e.jsx("path",{d:"M9.23018 16.2447C9.07335 15.6884 8.77505 15.1775 8.36166 14.7572C7.94827 14.3369 7.43255 14.0202 6.86011 13.835C6.28768 13.6499 5.67618 13.6021 5.07973 13.6958C4.48328 13.7895 3.92026 14.0219 3.44049 14.3723C2.96071 14.7227 2.57898 15.1804 2.32906 15.7049C2.07914 16.2294 1.96873 16.8045 2.00762 17.3794C2.0465 17.9542 2.23347 18.5111 2.55199 19.0007C2.8705 19.4902 3.31074 19.8975 3.83376 20.1863C4.46363 20.5354 5.1882 20.6983 5.91542 20.6542C6.64264 20.6101 7.33969 20.361 7.91802 19.9386C8.49636 19.5162 8.92988 18.9395 9.16351 18.2817C9.39715 17.624 9.42035 16.915 9.23018 16.2447Z",fill:"#2CAA14"})]})]}):null,e.jsx("div",{className:"text-base font-medium",children:s}),e.jsx(Us,{children:e.jsxs(Le,{children:[e.jsx(ke,{asChild:!0,children:e.jsx("button",{className:"p-0 m-0","aria-label":`Info about ${s}`,children:e.jsx(At,{className:"w-3 h-3 text-gray-400"})})}),e.jsxs(fe,{className:"w-64 p-0 bg-white text-black border shadow-sm",children:[e.jsx("div",{className:"p-2 font-semibold border-black",children:s}),o&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full h-[0.5px] bg-black"}),e.jsx("div",{className:"p-2",children:o})]})]})]})})]}),e.jsxs("div",{className:"text-xs text-gray-500 font-bold",children:[r.from?r.from.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"",r.from&&r.to?" - ":"",r.to?r.to.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):""]})]}),e.jsx(H,{children:e.jsx("p",{className:"text-3xl font-bold text-cyan-950",children:a})})]}),Ee=({title:s,metrics:a=[],date:r,isLoading:n=!1,icon:o,errorMessage:x})=>x&&!n?e.jsx("section",{className:s?"mt-10":"",children:e.jsxs(U,{className:"p-4",children:[e.jsx(z,{children:e.jsx("h2",{className:"text-xl font-semibold flex items-center space-x-2",children:s&&e.jsxs(e.Fragment,{children:[o==="Facebook"?e.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"#1877F2",children:e.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}):e.jsxs("svg",{viewBox:"0 0 24 24",className:"w-5 h-5",children:[e.jsx("path",{d:"M13.5437 4.24116L13.5441 4.24138C13.904 4.43971 14.2179 4.70303 14.4689 5.01529C14.7198 5.3275 14.903 5.68264 15.009 6.0601L15.4904 5.92486L15.009 6.0601C15.115 6.43752 15.1422 6.83078 15.0891 7.21776C15.0361 7.60457 14.9038 7.97861 14.6989 8.31855C14.6988 8.31873 14.6987 8.31891 14.6986 8.3191L8.41444 18.701C7.9918 19.3741 7.30557 19.868 6.49825 20.0687C5.68937 20.2699 4.83087 20.1586 4.10949 19.7614C3.38872 19.3646 2.86649 18.7168 2.64727 17.9633C2.42868 17.212 2.5264 16.4083 2.92214 15.7226L9.20689 5.33823C9.20695 5.33813 9.20702 5.33802 9.20708 5.33792C9.62451 4.65082 10.3142 4.14383 11.1301 3.93599C11.9464 3.72804 12.8151 3.83872 13.5437 4.24116Z",fill:"#FFB70A",stroke:"#FFB70A"}),e.jsx("path",{d:"M21.5404 15.4544L15.24 5.04127C14.7453 4.25097 13.9459 3.67817 13.0138 3.44633C12.0817 3.21448 11.0917 3.34215 10.2572 3.80182C9.4226 4.26149 8.8103 5.01636 8.55224 5.90372C8.29418 6.79108 8.41102 7.73988 8.87757 8.54562L15.178 18.9587C15.6726 19.749 16.4721 20.3218 17.4042 20.5537C18.3362 20.7855 19.3262 20.6579 20.1608 20.1982C20.9953 19.7385 21.6076 18.9836 21.8657 18.0963C22.1238 17.2089 22.0069 16.2601 21.5404 15.4544Z",fill:"#3B8AD8"}),e.jsx("path",{d:"M9.23018 16.2447C9.07335 15.6884 8.77505 15.1775 8.36166 14.7572C7.94827 14.3369 7.43255 14.0202 6.86011 13.835C6.28768 13.6499 5.67618 13.6021 5.07973 13.6958C4.48328 13.7895 3.92026 14.0219 3.44049 14.3723C2.96071 14.7227 2.57898 15.1804 2.32906 15.7049C2.07914 16.2294 1.96873 16.8045 2.00762 17.3794C2.0465 17.9542 2.23347 18.5111 2.55199 19.0007C2.8705 19.4902 3.31074 19.8975 3.83376 20.1863C4.46363 20.5354 5.1882 20.6983 5.91542 20.6542C6.64264 20.6101 7.33969 20.361 7.91802 19.9386C8.49636 19.5162 8.92988 18.9395 9.16351 18.2817C9.39715 17.624 9.42035 16.915 9.23018 16.2447Z",fill:"#2CAA14"})]}),e.jsx("span",{children:s})]})})}),e.jsx(H,{children:e.jsx("p",{className:"text-red-600 text-sm",children:x})})]})}):e.jsxs("section",{className:s?"mt-10":"",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 flex items-center space-x-2",children:s&&e.jsxs(e.Fragment,{children:[o==="Facebook"?e.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"#1877F2",children:e.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}):e.jsxs("svg",{viewBox:"0 0 24 24",className:"w-5 h-5",children:[e.jsx("path",{d:"M13.5437 4.24116L13.5441 4.24138C13.904 4.43971 14.2179 4.70303 14.4689 5.01529C14.7198 5.3275 14.903 5.68264 15.009 6.0601L15.4904 5.92486L15.009 6.0601C15.115 6.43752 15.1422 6.83078 15.0891 7.21776C15.0361 7.60457 14.9038 7.97861 14.6989 8.31855C14.6988 8.31873 14.6987 8.31891 14.6986 8.3191L8.41444 18.701C7.9918 19.3741 7.30557 19.868 6.49825 20.0687C5.68937 20.2699 4.83087 20.1586 4.10949 19.7614C3.38872 19.3646 2.86649 18.7168 2.64727 17.9633C2.42868 17.212 2.5264 16.4083 2.92214 15.7226L9.20689 5.33823C9.20695 5.33813 9.20702 5.33802 9.20708 5.33792C9.62451 4.65082 10.3142 4.14383 11.1301 3.93599C11.9464 3.72804 12.8151 3.83872 13.5437 4.24116Z",fill:"#FFB70A",stroke:"#FFB70A"}),e.jsx("path",{d:"M21.5404 15.4544L15.24 5.04127C14.7453 4.25097 13.9459 3.67817 13.0138 3.44633C12.0817 3.21448 11.0917 3.34215 10.2572 3.80182C9.4226 4.26149 8.8103 5.01636 8.55224 5.90372C8.29418 6.79108 8.41102 7.73988 8.87757 8.54562L15.178 18.9587C15.6726 19.749 16.4721 20.3218 17.4042 20.5537C18.3362 20.7855 19.3262 20.6579 20.1608 20.1982C20.9953 19.7385 21.6076 18.9836 21.8657 18.0963C22.1238 17.2089 22.0069 16.2601 21.5404 15.4544Z",fill:"#3B8AD8"}),e.jsx("path",{d:"M9.23018 16.2447C9.07335 15.6884 8.77505 15.1775 8.36166 14.7572C7.94827 14.3369 7.43255 14.0202 6.86011 13.835C6.28768 13.6499 5.67618 13.6021 5.07973 13.6958C4.48328 13.7895 3.92026 14.0219 3.44049 14.3723C2.96071 14.7227 2.57898 15.1804 2.32906 15.7049C2.07914 16.2294 1.96873 16.8045 2.00762 17.3794C2.0465 17.9542 2.23347 18.5111 2.55199 19.0007C2.8705 19.4902 3.31074 19.8975 3.83376 20.1863C4.46363 20.5354 5.1882 20.6983 5.91542 20.6542C6.64264 20.6101 7.33969 20.361 7.91802 19.9386C8.49636 19.5162 8.92988 18.9395 9.16351 18.2817C9.39715 17.624 9.42035 16.915 9.23018 16.2447Z",fill:"#2CAA14"})]}),e.jsx("span",{children:s})]})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:n?Array(a.length).fill(0).map((f,g)=>e.jsx(Na,{},g)):a.map((f,g)=>e.jsx(wa,{label:f.label,value:f.value,date:r,icon:o,tooltipContent:f.tooltipContent},g))})]});function Sa(){const[s,a]=l.useState({from:new Date,to:new Date}),[r,n]=l.useState(!1),[o,x]=l.useState([]),[f,g]=l.useState(null),[c,L]=l.useState(),[u,k]=l.useState("all"),[R,P]=l.useState(null),{brandId:B}=oe(),_=W(),E=m=>{m!==u&&k(m)},j=l.useCallback(async()=>{var m;n(!0);try{const d="https://parallels.messold.com",p=s!=null&&s.from?I(s.from,"yyyy-MM-dd"):"",w=s!=null&&s.to?I(s.to,"yyyy-MM-dd"):"";let M=[],A=[];if(u==="all"||u==="facebook")try{M=(await $.post(`${d}/api/metrics/fbad/${B}`,{startDate:p,endDate:w},{withCredentials:!0})).data.data,console.log(M),x(M)}catch(F){console.error("Error fetching Facebook ad data:",F)}if(u==="all"||u==="google")try{A=(await $.post(`${d}/api/metrics/googlead/${B}`,{startDate:p,endDate:w},{withCredentials:!0})).data.data,console.log(A),L(A)}catch(F){console.error("Error fetching Google ad data:",F)}b(u==="google"?[]:M,u==="facebook"?void 0:A),P(new Date)}catch(d){console.error("Error fetching ad data:",d),$.isAxiosError(d)&&((m=d.response)==null?void 0:m.status)===401&&(alert("Your session has expired. Please log in again."),_("/"))}finally{n(!1)}},[_,s,u,B]);l.useEffect(()=>{j()},[j]),l.useEffect(()=>{j();const m=setInterval(j,5*60*1e3);return()=>clearInterval(m)},[j]);const b=(m,d)=>{let p=0,w=0,M=0,A=0,F=0;m&&m.length>0&&m.forEach(V=>{var O,X;p+=parseFloat(V.spend||"0"),w+=parseFloat(((O=V.Revenue)==null?void 0:O.value)||"0"),M+=parseFloat(((X=V.purchases)==null?void 0:X.value)||"0"),A+=parseFloat(V.clicks||"0"),F+=parseFloat(V.impressions||"0")}),d&&(p+=parseFloat(d.totalSpend||"0"),w+=parseFloat(d.totalConversionsValue||"0"),M+=parseFloat(d.totalConversions||"0"),A+=parseFloat(d.totalClicks||"0"),F+=parseFloat(d.totalImpressions||"0")),g({totalSpent:`₹ ${p.toLocaleString()}`,totalRevenue:`₹ ${w.toLocaleString()}`,totalROAS:(w/p).toFixed(2).toString(),totalPurchases:M.toLocaleString(),totalCTR:`${(A/F*100).toFixed(2)} %`,totalCPC:(p/A).toFixed(2).toString()})},v=[{label:"Amount Spent",value:f?f.totalSpent:"₹ 0",tooltipContent:"The sum of ad spends for all advertising platform"},{label:"Revenue",value:f?f.totalRevenue:"₹ 0",tooltipContent:"Revenue from Ads Purchases"},{label:"ROAS (Ads only)",value:f?f.totalROAS:"0.00",tooltipContent:"Blended ROAS = Ads Purchases vaue / Blended Ad Spend"},{label:"Ads Purchases",value:f?f.totalPurchases:"0.00",tooltipContent:"Ads Purchases = Fb Ads Purchase + Google Conversions"},{label:"CTR",value:f?f.totalCTR:"0.00",tooltipContent:"Average CTR from all advertising platforms = (Blended Clicks / Blended Impressions)*100"},{label:"CPC",value:f?f.totalCPC:"0.00",tooltipContent:"Average CPC from all advertising platforms = (Blended Ad Spend / Blended Clicks )"}],y=[{label:"Total Cost",value:c?`₹ ${c==null?void 0:c.totalSpend}`:" 0"},{label:"Conversion Value",value:c?`₹ ${c==null?void 0:c.totalConversionsValue}`:" 0"},{label:"ROAS",value:c?c==null?void 0:c.roas:"0.00"},{label:"Conversions",value:c?c==null?void 0:c.totalConversions:"0"},{label:"CPC",value:c?`₹ ${c==null?void 0:c.totalCPC}`:" 0"},{label:"CPM",value:c?`₹ ${c==null?void 0:c.totalCPM}`:" 0"},{label:"CTR",value:c?`${c==null?void 0:c.totalCTR} %`:" 0"},{label:"Cost Per Conversion",value:c?`₹ ${c==null?void 0:c.totalCostPerConversion}`:" 0"}],T=()=>{j()};return e.jsxs("div",{className:"min-h-screen bg-gray-100",children:[e.jsx("nav",{className:"bg-white border-b border-gray-200 px-4 py-4 md:px-6 lg:px-8",children:e.jsxs("div",{className:" flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:[e.jsx(Hs,{brandId:B}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(xe,{brandId:B}),e.jsx(de,{date:s,setDate:a,defaultDate:{from:new Date,to:new Date}})]})]})}),e.jsxs("main",{className:"p-4 md:p-6 lg:px-8",children:[e.jsx("div",{className:"space-y-2",children:e.jsxs("section",{children:[e.jsxs("h2",{className:"text-xl font-semibold flex flex-row items-center justify-between",children:[e.jsxs("div",{className:"flex flex-row items-center space-x-2",children:[e.jsx(Mt,{className:"h-5 w-5"}),e.jsx("span",{children:"Blended summary"}),(u==="all"||u==="facebook")&&e.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"#1877F2",children:e.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),(u==="all"||u==="google")&&e.jsxs("svg",{viewBox:"0 0 24 24",className:"w-5 h-5",children:[e.jsx("path",{d:"M13.5437 4.24116L13.5441 4.24138C13.904 4.43971 14.2179 4.70303 14.4689 5.01529C14.7198 5.3275 14.903 5.68264 15.009 6.0601L15.4904 5.92486L15.009 6.0601C15.115 6.43752 15.1422 6.83078 15.0891 7.21776C15.0361 7.60457 14.9038 7.97861 14.6989 8.31855C14.6988 8.31873 14.6987 8.31891 14.6986 8.3191L8.41444 18.701C7.9918 19.3741 7.30557 19.868 6.49825 20.0687C5.68937 20.2699 4.83087 20.1586 4.10949 19.7614C3.38872 19.3646 2.86649 18.7168 2.64727 17.9633C2.42868 17.212 2.5264 16.4083 2.92214 15.7226L9.20689 5.33823C9.20695 5.33813 9.20702 5.33802 9.20708 5.33792C9.62451 4.65082 10.3142 4.14383 11.1301 3.93599C11.9464 3.72804 12.8151 3.83872 13.5437 4.24116Z",fill:"#FFB70A",stroke:"#FFB70A"}),e.jsx("path",{d:"M21.5404 15.4544L15.24 5.04127C14.7453 4.25097 13.9459 3.67817 13.0138 3.44633C12.0817 3.21448 11.0917 3.34215 10.2572 3.80182C9.4226 4.26149 8.8103 5.01636 8.55224 5.90372C8.29418 6.79108 8.41102 7.73988 8.87757 8.54562L15.178 18.9587C15.6726 19.749 16.4721 20.3218 17.4042 20.5537C18.3362 20.7855 19.3262 20.6579 20.1608 20.1982C20.9953 19.7385 21.6076 18.9836 21.8657 18.0963C22.1238 17.2089 22.0069 16.2601 21.5404 15.4544Z",fill:"#3B8AD8"}),e.jsx("path",{d:"M9.23018 16.2447C9.07335 15.6884 8.77505 15.1775 8.36166 14.7572C7.94827 14.3369 7.43255 14.0202 6.86011 13.835C6.28768 13.6499 5.67618 13.6021 5.07973 13.6958C4.48328 13.7895 3.92026 14.0219 3.44049 14.3723C2.96071 14.7227 2.57898 15.1804 2.32906 15.7049C2.07914 16.2294 1.96873 16.8045 2.00762 17.3794C2.0465 17.9542 2.23347 18.5111 2.55199 19.0007C2.8705 19.4902 3.31074 19.8975 3.83376 20.1863C4.46363 20.5354 5.1882 20.6983 5.91542 20.6542C6.64264 20.6101 7.33969 20.361 7.91802 19.9386C8.49636 19.5162 8.92988 18.9395 9.16351 18.2817C9.39715 17.624 9.42035 16.915 9.23018 16.2447Z",fill:"#2CAA14"})]})]}),e.jsxs("div",{className:"flex flex-row items-center space-x-2",children:[e.jsxs("div",{className:"md:flex items-center hidden",children:[R&&e.jsxs("span",{className:"text-sm text-gray-600 mr-4",children:["Last updated: ",R.toLocaleTimeString()]}),e.jsx(N,{onClick:T,disabled:r,className:"flex items-center",children:e.jsx(ce,{className:`h-4 w-4 ${r?"animate-spin":""}`})})]}),e.jsxs(He,{children:[e.jsx(Ze,{asChild:!0,children:e.jsxs(N,{className:"bg-cyan-800",children:[e.jsx(Dt,{className:"h-5 w-5 mr-2"}),"Filter"]})}),e.jsx(Fe,{children:e.jsxs(ua,{value:u,onValueChange:m=>E(m),children:[e.jsx(Re,{value:"all",children:"All Data"}),e.jsx(Re,{value:"facebook",children:"Facebook Ads"}),e.jsx(Re,{value:"google",children:"Google Ads"})]})})]})]})]}),e.jsx(Ee,{metrics:v,date:s||{from:new Date,to:new Date},isLoading:r,icon:u==="all"?"":u==="facebook"?"Facebook":"Google"})]})}),(u==="all"||u==="facebook")&&o.length>0&&o.map((m,d)=>{var w,M;const p=[{label:"Amount Spent",value:`₹ ${m.spend||"0"}`},{label:"Revenue",value:`₹ ${parseFloat(((w=m.Revenue)==null?void 0:w.value)||"0").toLocaleString()}`},{label:"ROAS (Ads only)",value:m.purchase_roas&&m.purchase_roas.length>0?parseFloat(m.purchase_roas[0].value).toFixed(2):"0"},{label:"Ads Purchases",value:((M=m.purchases)==null?void 0:M.value)||"0"},{label:"CPC (All clicks)",value:`₹ ${parseFloat(m.cpc||"0").toLocaleString()}`},{label:"CPM",value:`₹ ${parseFloat(m.cpm||"0").toFixed(2).toLocaleString()}`},{label:"CTR",value:`${parseFloat(m.ctr||"0").toFixed(2)} %`},{label:"Cost per Purchase (All)",value:`₹ ${parseFloat(m.cpp||"0").toLocaleString()}`}];return e.jsx(Ee,{icon:"Facebook",title:`Facebook - ${m.account_name}`,metrics:p,date:s||{from:new Date,to:new Date},isLoading:r,errorMessage:m.message},d)}),(u==="all"||u==="google")&&c&&e.jsx(Ee,{icon:"Google",title:`Google Ads - ${c==null?void 0:c.adAccountName}`,metrics:y,date:s||{from:new Date,to:new Date},isLoading:r})]})]})}const Ra=()=>e.jsxs("div",{className:"flex h-screen",children:[" ",e.jsx(se,{}),e.jsx("div",{className:"flex-1 h-screen overflow-auto",children:e.jsx(Sa,{})})]});function La(){const{user:s}=ze(),{brands:a}=Ge();return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 to-pink-50 p-6 space-y-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsxs("h1",{className:"text-3xl font-bold tracking-tight ",children:["Welcome back, ",(s==null?void 0:s.username.split(" ")[0])||"user"," !"]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(U,{className:"bg-white border-t-4 border-t-black shadow-lg",children:[e.jsxs(z,{children:[e.jsx(q,{children:"Your Brands"}),e.jsx(Q,{children:"Quick access to your brand dashboards"})]}),e.jsxs(H,{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:[a.map((r,n)=>e.jsx(N,{asChild:!0,className:`w-full justify-start ${n%2==0?" hover:bg-black/50 hover:text-white":"hover:bg-pink-500 bg-pink-600 text-white"} `,children:e.jsxs(ne,{to:`/business-dashboard/${r._id}`,children:[e.jsx(Ss,{className:"mr-2 h-4 w-4"}),r.name]})},r._id)),e.jsxs(N,{variant:"outline",className:"w-full justify-start border-dashed border-2 border-gray-300 hover:bg-indigo-50",children:[e.jsx(Xe,{className:"mr-2 h-4 w-4"}),"Add New Brand"]})]})]}),e.jsxs(U,{className:"bg-white border-t-4 border-t-cyan-600 shadow-lg",children:[e.jsxs(z,{children:[e.jsx(q,{className:"text-cyan-600",children:"Daily Reports"}),e.jsx(Q,{children:"Get Daily Reports for your brands"})]}),e.jsx(H,{children:e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:a.map(r=>e.jsx(ne,{to:`/ad-metrics/${r._id}`,children:e.jsxs(N,{variant:"outline",className:"w-full justify-start items-center text-cyan-600 hover:bg-green-50 hover:text-cyan-700 border-cyan-400",children:[e.jsx(Tt,{className:"h-4 w-4"}),e.jsx("span",{className:"",children:r.name})]},r._id)}))})})]})]}),e.jsx("div",{className:"grid gap-6 md:grid-cols-1",children:e.jsxs(U,{className:"bg-white border-t-4 border-t-amber-500 shadow-lg",children:[e.jsxs(z,{children:[e.jsx(q,{className:"text-amber-600",children:"Getting Started"}),e.jsx(Q,{children:"Follow these steps to make the most of your analytics"})]}),e.jsx(H,{children:e.jsxs("ol",{className:"list-decimal list-inside space-y-2",children:[e.jsx("li",{className:"text-gray-700",children:'Select a brand from the sidebar or "Your Brands" section'}),e.jsx("li",{className:"text-gray-700",children:"Connect your brand's Shopify store"}),e.jsx("li",{className:"text-gray-700",children:"Set up Google Analytics 4 property for your brand"}),e.jsx("li",{className:"text-gray-700",children:"Link your brand's Facebook Ads account"}),e.jsx("li",{className:"text-gray-700",children:"Configure Google Ads integration for your brand"}),e.jsx("li",{className:"text-gray-700",children:"Explore your unified brand analytics in the dashboard"})]})})]})}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(U,{className:"bg-white border-t-4 border-t-teal-500 shadow-lg",children:[e.jsxs(z,{children:[e.jsx(q,{className:"text-teal-600",children:"Notifications"}),e.jsx(Q,{children:"Stay updated with your latest alerts"})]}),e.jsx(H,{children:e.jsxs("ul",{className:"space-y-2",children:[e.jsxs("li",{className:"flex items-center",children:[e.jsx($e,{className:"mr-2 h-4 w-4 text-indigo-500"}),e.jsx("span",{className:"text-gray-700",children:"New Shopify order received for UDD Studio"})]}),e.jsxs("li",{className:"flex items-center",children:[e.jsx($e,{className:"mr-2 h-4 w-4 text-pink-500"}),e.jsx("span",{className:"text-gray-700",children:"Weekly analytics report ready for Fisherman Hub"})]}),e.jsxs("li",{className:"flex items-center",children:[e.jsx($e,{className:"mr-2 h-4 w-4 text-amber-500"}),e.jsx("span",{className:"text-gray-700",children:"Facebook Ads campaign ended for UDD Studio"})]})]})})]}),e.jsxs(U,{className:"bg-white border-t-4 border-t-purple-500 shadow-lg",children:[e.jsxs(z,{children:[e.jsx(q,{className:"text-purple-600",children:"Quick Actions"}),e.jsx(Q,{children:"Frequently used features and settings"})]}),e.jsxs(H,{className:"space-y-4",children:[e.jsxs(N,{variant:"outline",className:"w-full justify-start text-purple-600 hover:bg-purple-50 hover:text-purple-700 border-purple-200",children:[e.jsx(Pt,{className:"mr-2 h-4 w-4"}),"Account Settings"]}),e.jsxs(N,{variant:"outline",className:"w-full justify-start text-purple-600 hover:bg-purple-50 hover:text-purple-700 border-purple-200",children:[e.jsx(ce,{className:"mr-2 h-4 w-4"}),"Sync Data Sources"]}),e.jsxs(N,{variant:"outline",className:"w-full justify-start text-purple-600 hover:bg-purple-50 hover:text-purple-700 border-purple-200",children:[e.jsx(Xe,{className:"mr-2 h-4 w-4"}),"Manage Brands"]})]})]})]})]})})}const ka=()=>e.jsxs("div",{className:"flex h-screen",children:[e.jsx(se,{}),e.jsx("div",{className:"flex-1 h-screen overflow-auto",children:e.jsx(La,{})})]}),je=l.forwardRef(({className:s,...a},r)=>e.jsx(Ns,{ref:r,className:C("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...a,children:e.jsx(mt,{className:C("flex items-center justify-center text-current"),children:e.jsx(bs,{className:"h-4 w-4"})})}));je.displayName=Ns.displayName;const le=l.forwardRef(({className:s,...a},r)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:r,className:C("w-full caption-bottom text-sm",s),...a})}));le.displayName="Table";const he=l.forwardRef(({className:s,...a},r)=>e.jsx("thead",{ref:r,className:C("[&_tr]:border-b",s),...a}));he.displayName="TableHeader";const pe=l.forwardRef(({className:s,...a},r)=>e.jsx("tbody",{ref:r,className:C("[&_tr:last-child]:border-0",s),...a}));pe.displayName="TableBody";const Aa=l.forwardRef(({className:s,...a},r)=>e.jsx("tfoot",{ref:r,className:C("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...a}));Aa.displayName="TableFooter";const Z=l.forwardRef(({className:s,...a},r)=>e.jsx("tr",{ref:r,className:C("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...a}));Z.displayName="TableRow";const Ae=l.forwardRef(({className:s,...a},r)=>e.jsx("th",{ref:r,className:C("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...a}));Ae.displayName="TableHead";const S=l.forwardRef(({className:s,...a},r)=>e.jsx("td",{ref:r,className:C("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...a}));S.displayName="TableCell";const Ma=l.forwardRef(({className:s,...a},r)=>e.jsx("caption",{ref:r,className:C("mt-4 text-sm text-muted-foreground",s),...a}));Ma.displayName="TableCaption";const Da=()=>{const[s,a]=l.useState(void 0),r=new Date,[n,o]=l.useState([]),[x,f]=l.useState(!1),[g,c]=l.useState(null),{brandId:L}=oe(),u=W(),k=s!=null&&s.from?I(s.from,"yyyy-MM-dd"):"",R=s!=null&&s.to?I(s.to,"yyyy-MM-dd"):"",[P,B]=l.useState(!1),[_,E]=l.useState(["Date","Sessions","Add_To_Carts","Add_To_Cart_Rate","Checkouts","Checkouts_Rate","Purchase_Rate"]),[j,b]=l.useState(1),v=10,y=()=>{b(1)},T=()=>{B(!P)},m=t=>{E(i=>{const h=i.includes(t)?i.filter(D=>D!==t):[...i,t];return w.filter(D=>h.includes(D))})},d=l.useCallback(async()=>{var t;f(!0);try{const h=await $.post(`https://parallels.messold.com/api/analytics/atcreport/${L}`,{startDate:k,endDate:R},{withCredentials:!0});o(h.data.data||[]),c(new Date)}catch(i){console.error("Error fetching dashboard data:",i),$.isAxiosError(i)&&((t=i.response)==null?void 0:t.status)===401&&(alert("Your session has expired. Please log in again."),u("/"))}finally{f(!1)}},[u,k,R,L]);l.useEffect(()=>{d()},[d]),l.useEffect(()=>{d();const t=setInterval(d,5*60*1e3);return()=>clearInterval(t)},[d]);const p=()=>{d()},w=n.length>0?Object.keys(n[0]):[],M=w.filter(t=>_.includes(t)),A=Math.ceil(n.length/v),F=n.slice((j-1)*v,j*v);console.log(F);const V=n.map(t=>({...t,Sessions:Number(t.Sessions)})),O=Math.max(...V.map(t=>t.Sessions)),X=(t,i)=>{const h=t/i;return`rgba(0, 0, 255, ${Math.max(.1,h)})`},te=(t,i)=>t/i>.7?"white":"black",G=t=>parseFloat(t.replace("%","").trim()),ee={Add_To_Cart_Rate:n.reduce((t,i)=>t+G(i.Add_To_Cart_Rate),0)/n.length,Checkouts_Rate:n.reduce((t,i)=>t+G(i.Checkouts_Rate),0)/n.length,Purchase_Rate:n.reduce((t,i)=>t+G(i.Purchase_Rate),0)/n.length},ae=(t,i)=>t<i?"red":t>i?"green":"#FFB200",re=(t,i)=>t<i?e.jsx(De,{className:"ml-1 text-red-500 w-3 h-3"}):t>i?e.jsx(Te,{className:"ml-1 text-green-500 w-3 h-3"}):null;return e.jsxs("div",{className:"flex h-screen",children:[e.jsx(se,{}),e.jsxs("div",{className:"flex-1 h-screen overflow-hidden",children:[e.jsx("header",{className:"bg-white border-b border-gray-200 px-4 py-4 md:px-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ie,{className:"h-6 w-6 text-gray-500"}),e.jsx("h1",{className:"text-2xl font-bold",children:"E-commerce Metrics Overview"})]}),e.jsxs("div",{className:"flex flex-row space-x-3 items-center",children:[e.jsx(xe,{brandId:L}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx(de,{date:s,setDate:a,defaultDate:{from:new Date(r.getFullYear(),r.getMonth(),1),to:r},resetToFirstPage:y})})]})]})}),e.jsxs("div",{className:"m-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"text-lg font-semibold",children:"Key performance indicators for your online store"}),e.jsxs("div",{className:"flex flex-row items-center space-x-2",children:[e.jsxs("div",{className:"md:flex items-center hidden",children:[g&&e.jsxs("span",{className:"text-sm text-gray-600 mr-4",children:["Last updated: ",g.toLocaleTimeString()]}),e.jsx(N,{onClick:p,disabled:x,className:"flex items-center",children:e.jsx(ce,{className:`h-4 w-4 ${x?"animate-spin":""}`})})]}),e.jsxs(N,{onClick:T,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(Me,{className:"h-4 w-4"}),e.jsx("span",{children:"Select Columns"})]})]})]}),P&&e.jsxs("div",{className:"mb-4 p-4 border rounded-md bg-background",children:[e.jsx("h2",{className:"text-sm font-semibold mb-2",children:"Select columns to display:"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2",children:w.map(t=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(je,{id:`column-${t}`,checked:_.includes(t),onCheckedChange:()=>m(t)}),e.jsx("label",{htmlFor:`column-${t}`,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:t})]},t))})]}),e.jsx("div",{className:"border rounded-md overflow-auto",children:e.jsxs(le,{className:"text-center",children:[e.jsx(he,{className:"bg-gray-200",children:e.jsx(Z,{children:M.map(t=>e.jsx(S,{className:"font-bold px-4 text-black min-w-[100px]",children:t},t))})}),e.jsx(pe,{children:F.map((t,i)=>e.jsx(Z,{children:M.map(h=>{const D=h.includes("Rate")?G(t[h]):t[h],Y=["Add_To_Cart_Rate","Checkouts_Rate","Purchase_Rate"].includes(h);return e.jsx(S,{className:"px-4 py-2 border-b w-[150px] font-medium",style:{width:"150px",backgroundColor:h==="Sessions"?X(Number(t.Sessions),O):"",color:h==="Sessions"?te(Number(t.Sessions),O):Y?ae(D,ee[h]):"inherit"},children:e.jsxs("div",{className:"flex flex-row items-center justify-center gap-1",children:[t[h],Y&&re(D,ee[h])]})},h)})},i))})]})}),e.jsxs("div",{className:"flex items-center justify-center gap-10 mt-4",children:[e.jsx(N,{onClick:()=>b(t=>Math.max(t-1,1)),disabled:j===1,className:"flex items-center",children:e.jsx(ge,{className:"h-4 w-4 mr-2"})}),e.jsxs("span",{children:["Page ",j," of ",A]}),e.jsx(N,{onClick:()=>b(t=>Math.min(t+1,A)),disabled:j===A,className:"flex items-center",children:e.jsx(me,{className:"h-4 w-4 ml-2"})})]})]})]})]})};function K({title:s,tooltip:a}){return e.jsx(Ae,{className:"font-bold text-primary-foreground text-center w-[120px]",children:e.jsx(ht,{children:e.jsxs(pt,{children:[e.jsx(ut,{asChild:!0,children:e.jsx("span",{className:"flex items-center justify-center gap-1 cursor-help",children:s})}),e.jsx(ft,{className:"mb-3",children:e.jsx("div",{className:" text-gray-500 bg-white p-1 rounded-md text-xs border",children:a})})]})})})}const Ta=()=>{const[s,a]=l.useState([]),[r,n]=l.useState(""),[o,x]=l.useState(!0),[f,g]=l.useState(null),[c,L]=l.useState(void 0),[u,k]=l.useState([]),{brandId:R}=oe(),P=c!=null&&c.from?I(c.from,"yyyy-MM-dd"):"",B=c!=null&&c.to?I(c.to,"yyyy-MM-dd"):"",_="https://parallels.messold.com";l.useEffect(()=>{(async()=>{x(!0),g(null);try{const T={};P&&(T.startDate=P),B&&(T.endDate=B);const d=(await $.get(`${_}/api/report/${R}`,{params:T,withCredentials:!0})).data.data,w=(await $.get(`${_}/api/brands/${R}`,{withCredentials:!0})).data.name;a(d),n(w)}catch(T){console.error(T),g("Failed to fetch data. Please try again later.")}finally{x(!1)}})()},[R,c,_]);const E=y=>{k(T=>T.includes(y)?T.filter(m=>m!==y):[...T,y])},j=y=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(y),b=y=>`${y.toFixed(2)}`,v=l.useMemo(()=>s.map(y=>{const T=y.dailyMetrics.map(p=>({...p,metaSales:p.metaSpend*p.metaROAS,googleSales:p.googleSpend*p.googleROAS})),m=T.reduce((p,w)=>p+w.metaSales,0),d=T.reduce((p,w)=>p+w.googleSales,0);return{...y,metaSales:m,googleSales:d,dailyMetrics:T}}),[s]);return console.log(v),e.jsxs("div",{className:"flex h-screen ",children:[e.jsx(se,{}),e.jsxs("div",{className:"flex-1 h-screen overflow-hidden",children:[e.jsx("header",{className:"bg-white border-b border-gray-200 px-4 py-4 md:px-6 lg:px-8",children:e.jsxs("div",{className:" flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ie,{className:"h-6 w-6 text-gray-500"}),e.jsxs("h1",{className:"text-2xl font-bold",children:[r," Ad Metrics Overview"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{brandId:R}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx(de,{date:c,setDate:L})}),c&&e.jsx(N,{onClick:()=>L(void 0),className:"px-4 py-2 text-white bg-red-500 hover:bg-red-600",children:e.jsx(_t,{className:"w-6 h-6"})})]})]})}),e.jsx("h1",{className:"text-lg font-semibold flex flex-col items-start space-x-3 m-6",children:"Key performance indicators for your Ad Accounts"}),o?e.jsx("div",{className:"flex items-baseline justify-center h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-blue-500"})}):f?e.jsx("p",{className:"text-red-500",children:f}):e.jsx("div",{className:"border rounded-md overflow-auto m-6 lg:mt-3",children:e.jsxs("div",{className:"max-h-[90vh] overflow-auto",children:[e.jsx(le,{children:e.jsx(he,{className:"bg-cyan-900 sticky top-0 z-10",children:e.jsxs(Z,{className:"hover:bg-cyan-900",children:[e.jsx(Ae,{className:"w-[30px]"}),e.jsx(K,{title:"Date",tooltip:"Date"}),e.jsx(K,{title:"Meta Spend",tooltip:"Meta spend"}),e.jsx(K,{title:"Meta Sales",tooltip:"Meta Sales = Meta Spend * Meta ROAS"}),e.jsx(K,{title:"Meta ROAS",tooltip:"Meta ROAS"}),e.jsx(K,{title:"Google Spend",tooltip:"Google Spend"}),e.jsx(K,{title:"Google Sales",tooltip:"Google Sales = Google Spend * Google ROAS"}),e.jsx(K,{title:"Google ROAS",tooltip:"Google ROAS"}),e.jsx(K,{title:"Total Spend",tooltip:"Total Spend = Meta Spend + Google Spend"}),e.jsx(K,{title:"Gross ROI",tooltip:"Gross ROI =(MetaSales + GoogleSales)/ Total Spend"}),e.jsx(K,{title:"Shopify Sales",tooltip:"Shopify Sales"}),e.jsx(K,{title:"Net ROI",tooltip:"Net ROI = Shopify Sales / Total Spend"}),u.length>0&&e.jsx(Ae,{className:"w-[15px]"})]})})}),e.jsx("div",{className:"max-h-[70vh] md:max-h-[calc(75vh-2.5rem)]  overflow-y-auto ",children:e.jsx(le,{children:e.jsx(pe,{children:v.map((y,T)=>{const m=`${y.year}-${y.month.toString().padStart(2,"0")}`,d=u.includes(m);return e.jsxs(e.Fragment,{children:[e.jsxs(Z,{className:"bg-muted/50 cursor-pointer hover:bg-muted",onClick:()=>E(m),children:[e.jsx(S,{className:"w-[30px]",children:d?e.jsx(Ue,{className:"h-4 w-4"}):e.jsx(me,{className:"h-4 w-4"})}),e.jsx(S,{className:"font-medium text-cyan-950  w-[120px]",children:I(new Date(y.year,y.month-1),"MMMM yyyy")}),e.jsx(S,{className:" w-[120px] text-center",children:j(y.metaSpend)}),e.jsx(S,{className:" w-[120px] text-center",children:j(y.metaSales)}),e.jsx(S,{className:" w-[120px] text-center",children:b(y.metaROAS)}),e.jsx(S,{className:" w-[120px] text-center",children:j(y.googleSpend)}),e.jsx(S,{className:" w-[120px] text-center",children:j(y.googleSales)}),e.jsx(S,{className:" w-[120px] text-center",children:b(y.googleROAS)}),e.jsx(S,{className:" w-[120px] text-center",children:j(y.totalSpend)}),e.jsx(S,{className:" w-[120px] text-center",children:b(y.grossROI)}),e.jsx(S,{className:" w-[120px] text-center",children:j(y.shopifySales)}),e.jsx(S,{className:" w-[120px] text-center",children:b(y.netROI)})]},m),d&&y.dailyMetrics.map(p=>e.jsxs(Z,{className:"bg-background",children:[e.jsx(S,{}),e.jsx(S,{className:" w-[120px] text-center",children:I(new Date(p.date),"dd/MM/yyyy")}),e.jsx(S,{className:" w-[120px] text-center",children:j(p.metaSpend)}),e.jsx(S,{className:" w-[120px] text-center",children:j(p.metaSales)}),e.jsx(S,{className:" w-[120px] text-center",children:b(p.metaROAS)}),e.jsx(S,{className:" w-[120px] text-center",children:j(p.googleSpend)}),e.jsx(S,{className:" w-[120px] text-center",children:j(p.googleSales)}),e.jsx(S,{className:" w-[120px] text-center",children:b(p.googleROAS)}),e.jsx(S,{className:" w-[120px] text-center",children:j(p.totalSpend)}),e.jsx(S,{className:" w-[120px] text-center",children:b(p.grossROI)}),e.jsx(S,{className:" w-[120px] text-center",children:j(p.shopifySales)}),e.jsx(S,{className:" w-[120px] text-center",children:b(p.netROI)})]},p._id))]})})})})})]})})]})]})},Pa=()=>{const[s,a]=l.useState(void 0),r=new Date,[n,o]=l.useState([]),[x,f]=l.useState(!1),[g,c]=l.useState(null),{brandId:L}=oe(),u=W(),k=s!=null&&s.from?I(s.from,"yyyy-MM-dd"):"",R=s!=null&&s.to?I(s.to,"yyyy-MM-dd"):"",[P,B]=l.useState(!1),[_,E]=l.useState(["City","Sessions","Add_To_Carts","Add_To_Cart_Rate","Checkouts","Checkout_Rate","Purchase_Rate"]),[j,b]=l.useState(1),v=10,y=()=>{b(1)},T=()=>{B(!P)},m=t=>{E(i=>{const h=i.includes(t)?i.filter(D=>D!==t):[...i,t];return w.filter(D=>h.includes(D))})},d=l.useCallback(async()=>{var t;f(!0);try{const h=await $.post(`https://parallels.messold.com/api/analytics/report/${L}`,{startDate:k,endDate:R},{withCredentials:!0});o(h.data[1].data||[]),c(new Date)}catch(i){console.error("Error fetching dashboard data:",i),$.isAxiosError(i)&&((t=i.response)==null?void 0:t.status)===401&&(alert("Your session has expired. Please log in again."),u("/"))}finally{f(!1)}},[u,k,R,L]);l.useEffect(()=>{d()},[d]),l.useEffect(()=>{d();const t=setInterval(d,5*60*1e3);return()=>clearInterval(t)},[d]);const p=()=>{d()},w=n.length>0?Object.keys(n[0]):[],M=w.filter(t=>_.includes(t)),A=Math.ceil(n.length/v),F=n.slice((j-1)*v,j*v),V=n.map(t=>({...t,Sessions:Number(t.Sessions)})),O=Math.max(...V.map(t=>t.Sessions)),X=(t,i)=>{const h=t/i;return`rgba(0, 0, 255, ${Math.max(.1,h)})`},te=(t,i)=>t/i>.7?"white":"black",G={Add_To_Cart_Rate:n.reduce((t,i)=>t+parseFloat(i.Add_To_Cart_Rate),0)/n.length,Checkout_Rate:n.reduce((t,i)=>t+parseFloat(i.Checkout_Rate),0)/n.length,Purchase_Rate:n.reduce((t,i)=>t+parseFloat(i.Purchase_Rate),0)/n.length},ee=(t,i)=>t<i?"red":t>i?"green":"#FFB200",ae=(t,i)=>t<i?e.jsx(De,{className:"ml-1 text-red-500 w-3 h-3"}):t>i?e.jsx(Te,{className:"ml-1 text-green-500 w-3 h-3"}):null,re=t=>parseFloat(t.replace("%","").trim());return e.jsxs("div",{className:"flex h-screen",children:[e.jsx(se,{}),e.jsxs("div",{className:"flex-1 h-screen overflow-auto",children:[e.jsx("header",{className:"bg-white border-b border-gray-200 px-4 py-4 md:px-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ie,{className:"h-6 w-6 text-gray-500"}),e.jsx("h1",{className:"text-2xl font-bold",children:"City Metrics Overview"})]}),e.jsxs("div",{className:"flex flex-row space-x-3 items-center",children:[e.jsx(xe,{brandId:L}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx(de,{date:s,setDate:a,defaultDate:{from:new Date(r.getFullYear(),r.getMonth(),1),to:r},resetToFirstPage:y})})]})]})}),e.jsxs("div",{className:"m-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"text-lg font-semibold",children:"Key performance indicators for your online store"}),e.jsxs("div",{className:"flex flex-row items-center space-x-2",children:[e.jsxs("div",{className:"md:flex items-center hidden",children:[g&&e.jsxs("span",{className:"text-sm text-gray-600 mr-4",children:["Last updated: ",g.toLocaleTimeString()]}),e.jsx(N,{onClick:p,disabled:x,className:"flex items-center",children:e.jsx(ce,{className:`h-4 w-4 ${x?"animate-spin":""}`})})]}),e.jsxs(N,{onClick:T,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(Me,{className:"h-4 w-4"}),e.jsx("span",{children:"Select Columns"})]})]})]}),P&&e.jsxs("div",{className:"mb-4 p-4 border rounded-md bg-background",children:[e.jsx("h2",{className:"text-sm font-semibold mb-2",children:"Select columns to display:"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 xl:grid-cols-6 gap-2",children:w.map(t=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(je,{id:`column-${t}`,checked:_.includes(t),onCheckedChange:()=>m(t)}),e.jsx("label",{htmlFor:`column-${t}`,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:t})]},t))})]}),e.jsx("div",{className:"border rounded-md",children:e.jsxs(le,{className:"text-center",children:[e.jsx(he,{className:"bg-gray-200",children:e.jsx(Z,{children:M.map(t=>e.jsx(S,{className:"font-bold px-4 text-black w-[150px]",children:t},t))})}),e.jsx(pe,{children:F.map((t,i)=>e.jsx(Z,{children:M.map(h=>{const D=h.includes("Rate")?re(t[h]):t[h],Y=["Add_To_Cart_Rate","Checkout_Rate","Purchase_Rate"].includes(h);return e.jsx(S,{className:"px-4 py-2 border-b w-[150px] font-medium",style:{width:"150px",backgroundColor:h==="Sessions"?X(Number(t.Sessions),O):"",color:h==="Sessions"?te(Number(t.Sessions),O):Y?ee(D,G[h]):"inherit"},children:e.jsxs("div",{className:"flex flex-row items-center justify-center gap-1",children:[t[h],Y&&ae(D,G[h])]})},h)})},i))})]})}),e.jsxs("div",{className:"flex items-center justify-center gap-10 mt-4",children:[e.jsx(N,{onClick:()=>b(t=>Math.max(t-1,1)),disabled:j===1,className:"flex items-center",children:e.jsx(ge,{className:"h-4 w-4 mr-2"})}),e.jsxs("span",{children:["Page ",j," of ",A]}),e.jsx(N,{onClick:()=>b(t=>Math.min(t+1,A)),disabled:j===A,className:"flex items-center",children:e.jsx(me,{className:"h-4 w-4 ml-2"})})]})]})]})]})},_a=()=>{const[s,a]=l.useState(void 0),r=new Date,[n,o]=l.useState([]),[x,f]=l.useState(!1),[g,c]=l.useState(null),{brandId:L}=oe(),u=W(),k=s!=null&&s.from?I(s.from,"yyyy-MM-dd"):"",R=s!=null&&s.to?I(s.to,"yyyy-MM-dd"):"",[P,B]=l.useState(!1),[_,E]=l.useState(["Channel","Sessions","Add_To_Carts","Add_To_Cart_Rate","Checkouts","Checkout_Rate","Purchase_Rate"]),[j,b]=l.useState(1),v=10,y=()=>{b(1)},T=()=>{B(!P)},m=t=>{E(i=>{const h=i.includes(t)?i.filter(D=>D!==t):[...i,t];return w.filter(D=>h.includes(D))})},d=l.useCallback(async()=>{var t;f(!0);try{const h=await $.post(`https://parallels.messold.com/api/analytics/report/${L}`,{startDate:k,endDate:R},{withCredentials:!0});o(h.data[2].data||[]),c(new Date)}catch(i){console.error("Error fetching dashboard data:",i),$.isAxiosError(i)&&((t=i.response)==null?void 0:t.status)===401&&(alert("Your session has expired. Please log in again."),u("/"))}finally{f(!1)}},[u,k,R,L]);l.useEffect(()=>{d()},[d]),l.useEffect(()=>{d();const t=setInterval(d,5*60*1e3);return()=>clearInterval(t)},[d]);const p=()=>{d()},w=n.length>0?Object.keys(n[0]):[],M=w.filter(t=>_.includes(t)),A=Math.ceil(n.length/v),F=n.slice((j-1)*v,j*v),V=n.map(t=>({...t,Sessions:Number(t.Sessions)})),O=Math.max(...V.map(t=>t.Sessions)),X=(t,i)=>{const h=t/i;return`rgba(0, 0, 255, ${Math.max(.1,h)})`},te=(t,i)=>t/i>.7?"white":"black",G={Add_To_Cart_Rate:n.reduce((t,i)=>t+parseFloat(i.Add_To_Cart_Rate),0)/n.length,Checkout_Rate:n.reduce((t,i)=>t+parseFloat(i.Checkout_Rate),0)/n.length,Purchase_Rate:n.reduce((t,i)=>t+parseFloat(i.Purchase_Rate),0)/n.length},ee=(t,i)=>t>i?"green":t<i?"red":"#FFB200",ae=(t,i)=>t<i?e.jsx(De,{className:"ml-1 text-red-500 w-3 h-3"}):t>i?e.jsx(Te,{className:"ml-1 text-green-500 w-3 h-3"}):null,re=t=>parseFloat(t.replace("%","").trim());return e.jsxs("div",{className:"flex h-screen",children:[e.jsx(se,{}),e.jsxs("div",{className:"flex-1 h-screen overflow-auto",children:[e.jsx("header",{className:"bg-white border-b border-gray-200 px-4 py-4 md:px-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ie,{className:"h-6 w-6 text-gray-500"}),e.jsx("h1",{className:"text-2xl font-bold",children:"Channel Metrics Overview"})]}),e.jsxs("div",{className:"flex flex-row space-x-3 items-center",children:[e.jsx(xe,{brandId:L}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx(de,{date:s,setDate:a,defaultDate:{from:new Date(r.getFullYear(),r.getMonth(),1),to:r},resetToFirstPage:y})})]})]})}),e.jsxs("div",{className:"m-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"text-lg font-semibold",children:"Key performance indicators for your online store"}),e.jsxs("div",{className:"flex flex-row items-center space-x-2",children:[e.jsxs("div",{className:"md:flex items-center hidden",children:[g&&e.jsxs("span",{className:"text-sm text-gray-600 mr-4",children:["Last updated: ",g.toLocaleTimeString()]}),e.jsx(N,{onClick:p,disabled:x,className:"flex items-center",children:e.jsx(ce,{className:`h-4 w-4 ${x?"animate-spin":""}`})})]}),e.jsxs(N,{onClick:T,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(Me,{className:"h-4 w-4"}),e.jsx("span",{children:"Select Columns"})]})]})]}),P&&e.jsxs("div",{className:"mb-4 p-4 border rounded-md bg-background",children:[e.jsx("h2",{className:"text-sm font-semibold mb-2",children:"Select columns to display:"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-2",children:w.map(t=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(je,{id:`column-${t}`,checked:_.includes(t),onCheckedChange:()=>m(t)}),e.jsx("label",{htmlFor:`column-${t}`,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:t})]},t))})]}),e.jsx("div",{className:"border rounded-md",children:e.jsxs(le,{className:"text-center",children:[e.jsx(he,{className:"bg-gray-200",children:e.jsx(Z,{children:M.map(t=>e.jsx(S,{className:"font-bold px-4 text-black w-[150px]",children:t},t))})}),e.jsx(pe,{children:F.map((t,i)=>e.jsx(Z,{children:M.map(h=>{const D=h.includes("Rate")?re(t[h]):t[h],Y=["Add_To_Cart_Rate","Checkout_Rate","Purchase_Rate"].includes(h);return e.jsx(S,{className:"px-4 py-2 border-b w-[150px] font-medium",style:{width:"150px",backgroundColor:h==="Sessions"?X(Number(t.Sessions),O):"",color:h==="Sessions"?te(Number(t.Sessions),O):Y?ee(D,G[h]):"inherit"},children:e.jsxs("div",{className:"flex flex-row items-center justify-center gap-1",children:[t[h],Y&&ae(D,G[h])]})},h)})},i))})]})}),e.jsxs("div",{className:"flex items-center justify-center gap-10 mt-4",children:[e.jsx(N,{onClick:()=>b(t=>Math.max(t-1,1)),disabled:j===1,className:"flex items-center",children:e.jsx(ge,{className:"h-4 w-4 mr-2"})}),e.jsxs("span",{children:["Page ",j," of ",A]}),e.jsx(N,{onClick:()=>b(t=>Math.min(t+1,A)),disabled:j===A,className:"flex items-center",children:e.jsx(me,{className:"h-4 w-4 ml-2"})})]})]})]})]})},Fa=()=>{const[s,a]=l.useState(void 0),r=new Date,[n,o]=l.useState([]),[x,f]=l.useState(!1),[g,c]=l.useState(null),{brandId:L}=oe(),u=W(),k=s!=null&&s.from?I(s.from,"yyyy-MM-dd"):"",R=s!=null&&s.to?I(s.to,"yyyy-MM-dd"):"",[P,B]=l.useState(!1),[_,E]=l.useState(["LandingPage","Sessions","Add_To_Carts","Add_To_Cart_Rate","Checkouts","Checkout_Rate","Purchase_Rate"]),[j,b]=l.useState(1),v=10,y=()=>{b(1)},T=()=>{B(!P)},m=t=>{E(i=>{const h=i.includes(t)?i.filter(D=>D!==t):[...i,t];return w.filter(D=>h.includes(D))})},d=l.useCallback(async()=>{var t;f(!0);try{const h=await $.post(`https://parallels.messold.com/api/analytics/report/${L}`,{startDate:k,endDate:R},{withCredentials:!0});o(h.data[0].data||[]),c(new Date)}catch(i){console.error("Error fetching dashboard data:",i),$.isAxiosError(i)&&((t=i.response)==null?void 0:t.status)===401&&(alert("Your session has expired. Please log in again."),u("/"))}finally{f(!1)}},[u,k,R,L]);l.useEffect(()=>{d()},[d]),l.useEffect(()=>{d();const t=setInterval(d,5*60*1e3);return()=>clearInterval(t)},[d]);const p=()=>{d()},w=n.length>0?Object.keys(n[0]):[],M=w.filter(t=>_.includes(t)),A=Math.ceil(n.length/v),F=n.slice((j-1)*v,j*v),V=n.map(t=>({...t,Sessions:Number(t.Sessions)})),O=Math.max(...V.map(t=>t.Sessions)),X=(t,i)=>{const h=t/i;return`rgba(0, 0, 255, ${Math.max(.1,h)})`},te=(t,i)=>t/i>.7?"white":"black",G={Add_To_Cart_Rate:n.reduce((t,i)=>t+parseFloat(i.Add_To_Cart_Rate),0)/n.length,Checkout_Rate:n.reduce((t,i)=>t+parseFloat(i.Checkout_Rate),0)/n.length,Purchase_Rate:n.reduce((t,i)=>t+parseFloat(i.Purchase_Rate),0)/n.length},ee=(t,i)=>t>i?"green":t<i?"red":"#FFB200",ae=(t,i)=>t<i?e.jsx(De,{className:"ml-1 text-red-500 w-3 h-3"}):t>i?e.jsx(Te,{className:"ml-1 text-green-500 w-3 h-3"}):null,re=t=>parseFloat(t.replace("%","").trim());return e.jsxs("div",{className:"flex h-screen",children:[e.jsx(se,{}),e.jsxs("div",{className:"flex-1 h-screen overflow-auto",children:[e.jsx("header",{className:"bg-white border-b border-gray-200 px-4 py-4 md:px-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ie,{className:"h-6 w-6 text-gray-500"}),e.jsx("h1",{className:"text-2xl font-bold",children:"Landing Page Metrics Overview"})]}),e.jsxs("div",{className:"flex flex-row space-x-3 items-center",children:[e.jsx(xe,{brandId:L}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx(de,{date:s,setDate:a,defaultDate:{from:new Date(r.getFullYear(),r.getMonth(),1),to:r},resetToFirstPage:y})})]})]})}),e.jsxs("div",{className:"m-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"text-lg font-semibold",children:"Key performance indicators for your online store"}),e.jsxs("div",{className:"flex flex-row items-center space-x-2",children:[e.jsxs("div",{className:"md:flex items-center hidden",children:[g&&e.jsxs("span",{className:"text-sm text-gray-600 mr-4",children:["Last updated: ",g.toLocaleTimeString()]}),e.jsx(N,{onClick:p,disabled:x,className:"flex items-center",children:e.jsx(ce,{className:`h-4 w-4 ${x?"animate-spin":""}`})})]}),e.jsxs(N,{onClick:T,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(Me,{className:"h-4 w-4"}),e.jsx("span",{children:"Select Columns"})]})]})]}),P&&e.jsxs("div",{className:"mb-4 p-4 border rounded-md bg-background",children:[e.jsx("h2",{className:"text-sm font-semibold mb-2",children:"Select columns to display:"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-2",children:w.map(t=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(je,{id:`column-${t}`,checked:_.includes(t),onCheckedChange:()=>m(t)}),e.jsx("label",{htmlFor:`column-${t}`,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:t})]},t))})]}),e.jsx("div",{className:"border rounded-md",children:e.jsxs(le,{className:"text-center",children:[e.jsx(he,{className:"bg-gray-200",children:e.jsx(Z,{children:M.map(t=>e.jsx(S,{className:"font-bold px-4 text-black w-[150px]",children:t},t))})}),e.jsx(pe,{children:F.map((t,i)=>e.jsx(Z,{children:M.map(h=>{const D=h.includes("Rate")?re(t[h]):t[h],Y=["Add_To_Cart_Rate","Checkout_Rate","Purchase_Rate"].includes(h);return e.jsx(S,{className:"px-4 py-2 border-b w-[150px] font-medium",style:{width:"150px",backgroundColor:h==="Sessions"?X(Number(t.Sessions),O):"",color:h==="Sessions"?te(Number(t.Sessions),O):Y?ee(D,G[h]):"inherit"},children:e.jsxs("div",{className:"flex flex-row items-center justify-center gap-1",children:[t[h],Y&&ae(D,G[h])]})},h)})},i))})]})}),e.jsxs("div",{className:"flex items-center justify-center gap-10 mt-4",children:[e.jsx(N,{onClick:()=>b(t=>Math.max(t-1,1)),disabled:j===1,className:"flex items-center",children:e.jsx(ge,{className:"h-4 w-4 mr-2"})}),e.jsxs("span",{children:["Page ",j," of ",A]}),e.jsx(N,{onClick:()=>b(t=>Math.min(t+1,A)),disabled:j===A,className:"flex items-center",children:e.jsx(me,{className:"h-4 w-4 ml-2"})})]})]})]})]})};function $a(){return e.jsx(Ut,{children:e.jsx(ea,{children:e.jsxs(Ys,{children:[e.jsx(Jt,{}),e.jsxs(gt,{children:[e.jsx(J,{path:"/",element:e.jsx(qt,{})}),e.jsx(J,{path:"/dashboard",element:e.jsx(ka,{})}),e.jsx(J,{path:"/business-dashboard/:brandId",element:e.jsx(va,{})}),e.jsx(J,{path:"/analytics-dashboard/:brandId",element:e.jsx(Ra,{})}),e.jsx(J,{path:"/ecommerce-metrics/:brandId",element:e.jsx(Da,{})}),e.jsx(J,{path:"/ad-metrics/:brandId",element:e.jsx(Ta,{})}),e.jsx(J,{path:"/city-metrics/:brandId",element:e.jsx(Pa,{})}),e.jsx(J,{path:"/channel-metrics/:brandId",element:e.jsx(_a,{})}),e.jsx(J,{path:"/page-metrics/:brandId",element:e.jsx(Fa,{})})]})]})})})}Zs(document.getElementById("root")).render(e.jsx(l.StrictMode,{children:e.jsx($a,{})}));
//# sourceMappingURL=index-CQ37O4Ct.js.map
